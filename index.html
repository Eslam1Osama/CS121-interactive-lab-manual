
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    
    <!-- Primary Meta Tags -->
    <title>CS121 Digital Logic Design - Interactive Lab Manual | MSA University</title>
    <meta name="title" content="CS121 Digital Logic Design - Interactive Lab Manual | MSA University">
    <meta name="description" content="Comprehensive interactive lab manual for CS121 Digital Logic Design course. Features 11 complete lab experiments with interactive simulators, K-Map tools, and real-time circuit simulation.">
    <meta name="keywords" content="digital logic design, CS121, interactive lab manual, boolean algebra, K-maps, circuit simulation, MSA University, electronics engineering">
    <meta name="author" content="MSA University">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="global">
    <meta name="rating" content="general">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://cs-121-interactive-lab-manual.vercel.app/">
    
    <!-- Favicon Configuration -->
    <link rel="icon" type="image/png" sizes="16x16" href="media/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="media/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="media/favicon-48x48.png">
    <link rel="apple-touch-icon" sizes="180x180" href="media/apple-touch-icon.png">
    <link rel="manifest" href="media/site.webmanifest" id="pwa-manifest">
    <meta name="theme-color" content="#3498db">
    <meta name="msapplication-TileColor" content="#3498db">
    <meta name="msapplication-config" content="media/browserconfig.xml">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cs-121-interactive-lab-manual.vercel.app/">
    <meta property="og:title" content="CS121 Digital Logic Design - Interactive Lab Manual">
    <meta property="og:description" content="Comprehensive interactive lab manual for CS121 Digital Logic Design course. Features 11 complete lab experiments with interactive simulators, K-Map tools, and real-time circuit simulation.">
    <meta property="og:image" content="https://cs-121-interactive-lab-manual.vercel.app/media/apple-touch-icon.png">
    <meta property="og:image:width" content="180">
    <meta property="og:image:height" content="180">
    <meta property="og:image:alt" content="CS121 Digital Logic Design Lab Manual">
    <meta property="og:site_name" content="MSA University">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://cs-121-interactive-lab-manual.vercel.app/">
    <meta property="twitter:title" content="CS121 Digital Logic Design - Interactive Lab Manual">
    <meta property="twitter:description" content="Comprehensive interactive lab manual for CS121 Digital Logic Design course. Features 11 complete lab experiments with interactive simulators, K-Map tools, and real-time circuit simulation.">
    <meta property="twitter:image" content="https://cs-121-interactive-lab-manual.vercel.app/media/apple-touch-icon.png">
    <meta property="twitter:image:alt" content="CS121 Digital Logic Design Lab Manual">
    
    <!-- Additional Meta Tags -->
    <meta name="application-name" content="CS121 Labs">
    <meta name="apple-mobile-web-app-title" content="CS121 Labs">
    <meta name="msapplication-TileImage" content="media/favicon-144x144.png">
    <meta name="msapplication-TileColor" content="#3498db">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="js/platformPreloader.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #1a2a3a;
            --success: #27ae60;
            --warning: #f39c12;
            --info: #17a2b8;
            --info-hover: #138496;
            --gray: #7f8c8d;
            --text: #ecf0f1;
            --card-bg: rgba(30, 40, 51, 0.9);
            --card-border: rgba(52, 152, 219, 0.3);
            --secondary-bg: rgba(40, 50, 60, 0.7);
            --border: rgba(52, 152, 219, 0.4);
            --input-bg: rgba(40, 50, 60, 0.8);
            --muted: rgba(236, 240, 241, 0.6);
            --transition: background 0.3s, color 0.3s, box-shadow 0.3s;
            --max-width: 1200px;
            --gap-xs: 0.5rem;
            --gap-sm: 1rem;
            --gap-md: 2rem;
            --gap-lg: 3rem;
            --gap-xl: 5rem;
            --bg-primary: rgba(30, 40, 51, 0.95);
            --bg-secondary: rgba(40, 50, 60, 0.8);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Screen reader only class */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Ensure all images are visible by default */
        img {
            opacity: 1 !important;
            display: block;
        }
        
        /* Responsive images should always be visible */
        img.responsive-image {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Image placeholder styles */
        .image-placeholder {
            margin: 1rem 0;
        }
        
        .image-placeholder-content {
            background: linear-gradient(135deg, var(--card-bg), var(--secondary-bg));
            border: 2px dashed var(--card-border);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            color: var(--text);
            opacity: 0.7;
            font-size: 0.9rem;
        }
        
        .image-placeholder-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
            color: var(--warning);
        }
        
        .image-placeholder-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .image-placeholder-description {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a 0%, #2c3e50 100%);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            transition: var(--transition);
        }
        
        /* Light mode variables */
        body.light-mode {
            --primary: #f5f7fa;
            --secondary: #1976d2;
            --accent: #d84315;
            --light: #222;
            --dark: #fff;
            --text: #222;
            --success: #388e3c;
            --warning: #ffa000;
            --info: #0d6efd;
            --info-hover: #0b5ed7;
            --gray: #b0bec5;
            --card-bg: #fff;
            --card-border: #e3eaf2;
            --secondary-bg: #f8fafc;
            --border: #bbdefb;
            --input-bg: #f8fafc;
            --muted: #b0bec5;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
        }
        body.light-mode {
            background: linear-gradient(135deg, #e3eaf2 0%, #f5f7fa 100%);
            color: var(--light);
        }
        body.light-mode header {
            background: linear-gradient(120deg, #f7fbff 0%, #e3eaf2 60%, #bbdefb 100%);
            border-bottom: 2px solid var(--secondary);
            box-shadow: 0 4px 16px rgba(25, 118, 210, 0.08);
        }
        body.light-mode .sidebar {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 24px rgba(25, 118, 210, 0.08);
        }
        body.light-mode .main-content {
            box-sizing: border-box;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            border-radius: 15px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 24px rgba(0,0,0,0.18);
            transition: background-color 0.3s, color 0.3s;
        }
        body.light-mode .lab-section {
            background: #f8fafc;
            border: 1px solid #e3eaf2;
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.06);
        }
        body.light-mode .lab-title, body.light-mode .toc-title {
            color: var(--secondary);
        }
        body.light-mode .subtitle {
            color: #607d8b;
        }
        body.light-mode .lab-link {
            background: #e3eaf2;
            color: #222;
        }
        body.light-mode .lab-link.active {
            background: #bbdefb;
            border-left: 4px solid var(--secondary);
        }
        body.light-mode .lab-link:hover {
            background: #e1f5fe;
            color: var(--secondary);
        }
        body.light-mode .btn-pdf {
            background: linear-gradient(135deg, #d84315, #ff7043);
            color: #fff;
        }
        body.light-mode .btn-png {
            background: linear-gradient(135deg, #1976d2, #64b5f6);
            color: #fff;
        }
        body.light-mode .btn {
            box-shadow: 0 2px 8px rgba(25, 118, 210, 0.08);
        }
        body.light-mode .btn:hover {
            background: #e3eaf2;
            color: var(--secondary);
        }
        body.light-mode .simulator-container, body.light-mode .simplification-box, body.light-mode .k-map {
            background: #ffffff;
            border: 1px solid #e3eaf2;
            box-shadow: 0 2px 8px rgba(25, 118, 210, 0.06);
        }
        body.light-mode .gate-display {
            background: #e3eaf2;
            color: #222;
        }
        body.light-mode .led-output {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: radial-gradient(circle at 60% 35%, #444 60%, #222 100%);
            margin: 10px auto 0;
            box-shadow: 0 2px 8px #000a, 0 0 0 2px #111a, inset 0 0 12px #000c;
            border: 2.5px solid #222;
            transition: background 0.35s, box-shadow 0.35s, border 0.25s, filter 0.3s;
            position: relative;
            outline: 2px solid transparent;
        }
        body.light-mode .led-output.active {
            background: radial-gradient(circle at 60% 35%, #fbc02d 60%, #e67e22 100%);
            box-shadow: 0 0 24px 8px #fbc02d88, 0 2px 8px #000a, 0 0 0 2px #e67e22, 0 0 40px 10px #fbc02d44, inset 0 0 18px #fff8;
            border: 2.5px solid #fbc02d;
            filter: brightness(1.15) saturate(1.2) drop-shadow(0 0 8px #fbc02d);
            outline: 2px solid #fbc02d88;
        }
        body.light-mode .led-output::after {
            content: '';
            display: block;
            position: absolute;
            left: 8px;
            top: 7px;
            width: 10px;
            height: 7px;
            border-radius: 50%;
            background: rgba(255,255,255,0.45);
            filter: blur(0.5px);
            opacity: 0.85;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        body.light-mode .led-output.active::after {
            opacity: 1;
            background: rgba(255,255,220,0.7);
        }
        body.light-mode .segment-display {
            color: #d84315;
            background: #fff3e0;
        }
        body.light-mode .truth-table th, body.light-mode .ic-table th {
            background: #bbdefb;
            color: #222;
        }
        body.light-mode .truth-table td, body.light-mode .ic-table td {
            background: #fff;
            color: #222;
        }
        body.light-mode .truth-table tr:nth-child(even), body.light-mode .ic-table tr:nth-child(even) {
            background: #f5f7fa;
        }
        body.light-mode .placeholder-img {
            background: #e3eaf2;
            border: 2px dashed #b0bec5;
        }
        body.light-mode .img-caption {
            color: #607d8b;
        }
        body.light-mode .footer {
            background: #e3eaf2;
            color: #607d8b;
        }
        body.light-mode .brand {
            color: #1976d2;
        }
        body.light-mode .developer {
            color: #2ecc71;
        }
        body.light-mode .gate-btn {
            background: #e3eaf2;
            color: #1976d2;
            border: 1px solid #bbdefb;
        }
        body.light-mode .gate-btn.active {
            background: #1976d2;
            color: #fff;
            border-color: #1976d2;
            box-shadow: 0 0 10px #bbdefb;
        }
        body.light-mode .gate-btn:hover {
            background: #bbdefb;
            color: #1976d2;
        }
        body.light-mode .input-label, body.light-mode .output-label {
            color: #607d8b;
        }
        body.light-mode .counter-display {
            background: #e3eaf2;
            color: #222;
        }
        body.light-mode .counter-btn {
            background: #1976d2;
            color: #fff;
        }
        body.light-mode .counter-btn:hover {
            background: #64b5f6;
            color: #1976d2;
        }
        body.light-mode .flip-flop {
            background: #e3eaf2;
            color: #222;
        }
        body.light-mode .ff-output {
            color: #1976d2;
        }
        
        /* Light mode text editor enhancements */
        body.light-mode .simple-editor {
            border-color: #bbdefb;
            background: #f8fafc;
            color: #222;
            box-shadow: 0 2px 8px rgba(25, 118, 210, 0.08);
        }
        
        body.light-mode .simple-editor:focus {
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2), 0 4px 12px rgba(25, 118, 210, 0.1);
            transform: translateY(-1px);
        }
        
        body.light-mode .simple-editor:hover {
            border-color: #64b5f6;
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.12);
        }
        
        header {
            background: linear-gradient(120deg, #2c3e50 0%, #3498db 60%, #2ecc71 100%);
            padding: 0.6rem 0.5rem 0.6rem 0.5rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            border-bottom: 2px solid var(--secondary);
        }
        
        .university {
            font-size: 0.95rem;
            margin-bottom: 2px;
        }
        
        h1 {
            font-size: 1.45rem;
            margin-bottom: 0.2rem;
        }
        
        .subtitle {
            font-size: 0.95rem;
            margin-bottom: 0.2rem;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            max-width: var(--max-width);
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            padding-inline: clamp(0.5rem, 4vw, 2rem);
            gap: var(--gap-lg);
            padding-top: 7rem;
            padding-bottom: 5.5rem;
            box-sizing: border-box;
        }
        
        .sidebar {
            width: 300px;
            flex-shrink: 0;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            height: fit-content;
            position: sticky;
            top: 20px;
            border: 1px solid var(--card-border);
            max-height: 90vh;
            overflow-y: auto;
            transition: var(--transition);
        }
        
        .main-content {
            box-sizing: border-box;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            border-radius: 15px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 24px rgba(0,0,0,0.18);
            transition: background-color 0.3s, color 0.3s;
        }
        
        .toc-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .lab-list {
            list-style: none;
        }
        
        .lab-item {
            margin-bottom: 12px;
            position: relative;
        }
        
        .lab-link {
            display: block;
            padding: 12px 15px;
            background: rgba(52, 152, 219, 0.15);
            border-radius: 8px;
            color: #ecf0f1;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        
        .lab-link:hover {
            background: rgba(52, 152, 219, 0.3);
            transform: translateX(5px);
        }
        
        .lab-link.active {
            background: rgba(52, 152, 219, 0.4);
            border-left: 4px solid var(--secondary);
            transform: translateX(5px);
            animation: pulse 0.7s;
        }
        
        .lab-link i {
            margin-right: 10px;
            color: #3498db;
        }
        
        .lab-section {
            margin-bottom: 3rem;
            background: rgba(25, 35, 45, 0.7);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }
        
        .lab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid rgba(52, 152, 219, 0.5);
            padding-bottom: 1rem;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .lab-title {
            font-size: 1.8rem;
            color: #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        

        
        .btn {
            padding: 8px 15px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        

        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .section-title {
            font-size: 1.4rem;
            margin: 1.5rem 0 1rem;
            color: #2ecc71;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .section-title i {
            color: #2ecc71;
        }
        
        /* Enhanced button styling for section titles with buttons */
        .section-title .btn-info {
            flex-shrink: 0;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.15);
        }
        
        .objectives-list, .steps-list {
            list-style-type: none;
            padding-left: 20px;
        }
        
        .objectives-list li, .steps-list li {
            margin-bottom: 10px;
            padding-left: 30px;
            position: relative;
        }
        
        .objectives-list li:before, .steps-list li:before {
            content: "•";
            position: absolute;
            left: 0;
            color: #3498db;
            font-size: 1.4rem;
        }
        
        .ic-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: rgba(40, 50, 60, 0.7);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .ic-table th {
            background: rgba(52, 152, 219, 0.7);
            padding: 12px 15px;
            text-align: left;
        }
        
        .ic-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ic-table tr:last-child td {
            border-bottom: none;
        }
        
        .ic-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .truth-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: rgba(40, 50, 60, 0.7);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .truth-table th {
            background: rgba(46, 204, 113, 0.7);
            padding: 12px 15px;
            text-align: center;
        }
        
        .truth-table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .truth-table tr:last-child td {
            border-bottom: none;
        }
        
        .truth-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .placeholder-img {
            width: 100%;
            height: 200px;
            background: rgba(40, 50, 60, 0.5);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1.5rem 0;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }
        
        .placeholder-img i {
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.2);
        }
        
        .img-caption {
            text-align: center;
            color: #bdc3c7;
            font-size: 0.9rem;
            margin-top: -10px;
            margin-bottom: 1.5rem;
        }
        .simulator-container {
            background: rgba(40, 50, 60, 0.7);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border: 1px solid rgba(52, 152, 219, 0.2);
            transition: var(--transition);
        }
        
        .gate-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .gate-btn {
            padding: 10px 20px;
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.5);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .gate-btn.active {
            background: rgba(52, 152, 219, 0.8);
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }
        
        .gate-btn:hover {
            background: rgba(52, 152, 219, 0.4);
        }
        
        .simulator {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            text-align: center;
        }
        
        .input-container, .output-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .input-switch {
            position: relative;
            width: 60px;
            height: 30px;
            margin: 0 auto;
            cursor: pointer;
        }
        
        .input-switch input {
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
            z-index: -1;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #e74c3c;
            border-radius: 30px;
            transition: .4s;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: white;
            border-radius: 50%;
            transition: .4s;
        }
        
        input:checked + .slider {
            background: #2ecc71;
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        .slider:hover {
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.6);
        }
        
        input:checked + .slider:hover {
            box-shadow: 0 0 8px rgba(46, 204, 113, 0.6);
        }
        
        .slider:focus {
            outline: 2px solid rgba(52, 152, 219, 0.8);
            outline-offset: 2px;
        }
        
        .slider[aria-pressed="true"] {
            background: #2ecc71;
        }
        
        .slider[aria-pressed="true"]:before {
            transform: translateX(30px);
        }
        
        .gate-display {
            background: rgba(25, 35, 45, 0.9);
            border-radius: 10px;
            padding: 30px 0;
            font-size: 1.5rem;
            font-weight: bold;
            min-height: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: var(--transition);
        }
        
        .led-output {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: radial-gradient(circle at 60% 35%, #444 60%, #222 100%);
            margin: 10px auto 0;
            box-shadow: 0 2px 8px #000a, 0 0 0 2px #111a, inset 0 0 12px #000c;
            border: 2.5px solid #222;
            transition: background 0.35s, box-shadow 0.35s, border 0.25s, filter 0.3s;
            position: relative;
            outline: 2px solid transparent;
        }
        .led-output.active {
            background: radial-gradient(circle at 60% 35%, #fbc02d 60%, #e67e22 100%);
            box-shadow: 0 0 24px 8px #fbc02d88, 0 2px 8px #000a, 0 0 0 2px #e67e22, 0 0 40px 10px #fbc02d44, inset 0 0 18px #fff8;
            border: 2.5px solid #fbc02d;
            filter: brightness(1.15) saturate(1.2) drop-shadow(0 0 8px #fbc02d);
            outline: 2px solid #fbc02d88;
        }
        .led-output::after {
            content: '';
            display: block;
            position: absolute;
            left: 8px;
            top: 7px;
            width: 10px;
            height: 7px;
            border-radius: 50%;
            background: rgba(255,255,255,0.45);
            filter: blur(0.5px);
            opacity: 0.85;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .led-output.active::after {
            opacity: 1;
            background: rgba(255,255,220,0.7);
        }
        .input-label, .output-label {
            margin-top: 5px;
            font-weight: 500;
            font-size: 0.9rem;
        }
        .segment-display {
            font-family: 'Courier New', monospace;
            font-size: 2.5rem;
            font-weight: bold;
            color: #e74c3c;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 5px;
            padding: 5px 15px;
            margin: 10px auto;
            min-width: 50px;
            text-align: center;
        }
        .footer {
            text-align: center;
            background: rgba(0,0,0,0.85);
            color: #bdc3c7;
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0.7rem 0.5rem 0.7rem 0.5rem;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.12);
            transition: var(--transition);
        }
        .container, .main-content {
            padding-bottom: 0.5rem;
        }
        @media (max-width: 600px) {
            .container, .main-content {
                padding-bottom: 1rem;
            }
        }
        .brand {
            color: #3498db;
            font-weight: bold;
        }
        .developer {
            color: #2ecc71;
        }
        
       .simplification-box {
            background: rgba(40, 50, 60, 0.7);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            line-height: 1.8;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        /* Interactive Question Box Styles */
        .simplification-question-box {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .question-header h4 {
            margin: 0;
            color: var(--text);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* Rich Editor Styles */
        .rich-editor-container {
            border: 2px solid var(--card-border);
            border-radius: 8px;
            overflow: hidden;
            background: var(--card-bg);
        }
        
        .editor-toolbar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--secondary-bg);
            border-bottom: 1px solid var(--card-border);
            flex-wrap: wrap;
        }
        
        .toolbar-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border: 1px solid var(--card-border);
            border-radius: 6px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            min-width: 36px;
        }
        
        .toolbar-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.15);
        }
        
        .toolbar-btn:active {
            transform: translateY(0);
        }
        
        .toolbar-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        .toolbar-btn.math-symbol {
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .toolbar-btn.clear-format {
            color: var(--accent);
        }
        
        .toolbar-btn.clear-format:hover {
            background: rgba(231, 76, 60, 0.1);
            border-color: var(--accent);
        }
        
        .toolbar-separator {
            width: 1px;
            height: 24px;
            background: var(--card-border);
            margin: 0 0.25rem;
        }
        
        .rich-editor {
            min-height: 200px;
            padding: 1rem;
            outline: none;
            color: var(--text);
            font-size: 1rem;
            line-height: 1.6;
            background: var(--input-bg);
            border: none;
            resize: vertical;
        }
        
        .rich-editor:empty:before {
            content: attr(placeholder);
            color: var(--light);
            font-style: italic;
        }
        
        .rich-editor:focus {
            background: var(--card-bg);
        }
        
        /* Modal Styles */
        .answer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .answer-modal[aria-hidden="false"] {
            display: flex;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
        }
        
        .modal-overlay.show {
            display: block;
        }
        
        /* Enhanced Chip Modal Overlay for Lab 7 */
        .chip-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 9999;
            display: none;
        }
        
        .chip-modal-overlay.show {
            display: block;
        }
        
        /* Enhanced Chip Modal Container for Lab 7 */
        .chip-modal-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 1200px;
            width: 95%;
            max-height: 95vh;
            overflow: hidden;
            z-index: 10000;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .modal-container {
            position: relative;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--card-border);
            background: var(--secondary-bg);
        }
        
        .modal-header h3 {
            margin: 0;
            color: var(--text);
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--light);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: var(--card-border);
            color: var(--text);
        }
        
        .modal-content {
            padding: 2rem;
            overflow-y: auto;
            flex: 1;
        }
        
        /* Lab 10 Modal Content Optimization for Larger Images */
        .chip-modal-container[id*="FlipFlopModalLab10"] .modal-content {
            padding: 1rem;
        }
        
        .answer-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .answer-section h4 {
            margin: 0 0 1rem 0;
            color: var(--text);
            font-size: 1.2rem;
            font-weight: 600;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--card-border);
        }
        
        .answer-display {
            background: var(--input-bg);
            border: 2px solid var(--card-border);
            border-radius: 8px;
            padding: 1rem;
            min-height: 200px;
            color: var(--text);
            line-height: 1.6;
        }
        
        .answer-display.compact {
            min-height: auto;
            padding: 0.75rem 1rem;
        }
        
        .answer-display.correct-answer {
            border-color: #27ae60;
            background: var(--card-bg);
            color: var(--text);
        }
        
        /* Light mode specific styling for correct answer */
        body.light-mode .answer-display.correct-answer {
            background: #f8fff9;
            color: #155724;
        }
        
        .math-solution ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }
        
        .math-solution li {
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .final-answer {
            background: var(--secondary);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
            margin-top: 1rem;
        }
        
        .math-equation {
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--secondary);
        }
        
        .math-equation p {
            margin: 0.5rem 0;
            line-height: 1.6;
            color: var(--text);
        }
        
        .math-equation h4 {
            margin: 1rem 0 0.8rem 0;
            color: var(--secondary);
            font-size: 1.1rem;
            font-weight: 600;
            border-bottom: 2px solid rgba(52, 152, 219, 0.3);
            padding-bottom: 0.3rem;
        }
        
        .math-equation ul {
            margin: 0.8rem 0;
            padding-left: 1.5rem;
        }
        
        .math-equation li {
            margin: 0.4rem 0;
            line-height: 1.5;
        }
        
        .math-equation strong {
            color: var(--accent);
            font-weight: 600;
        }
        
        /* Light mode specific styling for math equation */
        body.light-mode .math-equation {
            background: rgba(0, 0, 0, 0.03);
        }
        body.light-mode .math-equation p {
            color: var(--text);
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--card-border);
            background: var(--secondary-bg);
        }
        
        /* Chip Modal Styles for Lab 7 */
        .chip-navigation {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            justify-content: center;
        }
        
        .chip-nav-btn {
            padding: 0.8rem 1.5rem;
            border: 2px solid var(--secondary);
            background: var(--card-bg);
            color: var(--text);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            min-width: 100px;
        }
        
        .chip-nav-btn:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52,152,219,0.3);
        }
        
        .chip-nav-btn.active {
            background: var(--secondary);
            color: white;
            box-shadow: 0 2px 8px rgba(52,152,219,0.4);
        }
        
        /* Enhanced focus states for accessibility */
        .chip-nav-btn:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        .chip-modal-container .modal-close:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        /* Smooth transitions for modal interactions */
        .chip-modal-overlay {
            transition: opacity 0.3s ease-out;
        }
        
        .chip-modal-container {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        
        .chip-image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
            width: 100%;
        }
        
        .chip-image {
            max-width: 95%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            transition: transform 0.2s ease;
            display: block;
            margin: 0 auto;
        }
        
        .chip-image:hover {
            transform: scale(1.02);
        }
        
        /* Lab 10 Specific Modal Enhancements for Larger Images */
        .chip-modal-container[id*="FlipFlopModalLab10"] {
            max-width: 1800px;
            max-height: 98vh;
            width: 98%;
        }
        
        .chip-modal-container[id*="FlipFlopModalLab10"] .chip-image-container {
            margin: 1rem 0;
            padding: 0;
            width: 100%;
            height: auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .chip-modal-container[id*="FlipFlopModalLab10"] .chip-image {
            max-width: 100%;
            width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            object-fit: contain;
        }
        
        /* Enhanced centering for larger screens */
        @media (min-width: 1200px) {
            .chip-image-container {
                margin: 2.5rem 0;
            }
            
            .chip-image {
                max-width: 95%;
            }
            
            /* Lab 10 Modal Enhancements for Large Screens */
            .chip-modal-container[id*="FlipFlopModalLab10"] {
                max-width: 1800px;
                width: 98%;
            }
            
            .chip-modal-container[id*="FlipFlopModalLab10"] .chip-image {
                max-width: 100%;
                width: 100%;
            }
        }
        
        /* Extra Large Screen Optimization for Lab 10 Modals */
        @media (min-width: 1600px) {
            .chip-modal-container[id*="FlipFlopModalLab10"] {
                max-width: 2000px;
                width: 99%;
            }
            
            .chip-modal-container[id*="FlipFlopModalLab10"] .chip-image {
                max-width: 100%;
                width: 100%;
                height: auto;
            }
        }
        
        /* Comprehensive Responsive Design for Chip Modal */
        @media (max-width: 768px) {
            .chip-modal-container {
                width: 98%;
                max-height: 95vh;
                margin: 1rem;
                max-width: 95vw;
            }
            
            .chip-modal-container .modal-header {
                padding: 1rem 1.5rem;
            }
            
            .chip-modal-container .modal-header h3 {
                font-size: 1.2rem;
            }
            
            .chip-modal-container .modal-content {
                padding: 1.5rem;
            }
            
            .chip-navigation {
                gap: 0.5rem;
                margin-bottom: 1rem;
            }
            
            .chip-nav-btn {
                padding: 0.6rem 1rem;
                min-width: 80px;
                font-size: 0.9rem;
            }
            
            .chip-image-container {
                margin: 1.5rem 0;
            }
            
            .chip-description {
                padding: 1rem;
                margin-top: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .chip-modal-container {
                width: 100%;
                margin: 0.5rem;
                max-height: 98vh;
                max-width: 98vw;
            }
            
            .chip-modal-container .modal-header {
                padding: 0.8rem 1rem;
            }
            
            .chip-modal-container .modal-header h3 {
                font-size: 1.1rem;
            }
            
            .chip-modal-container .modal-content {
                padding: 1rem;
            }
            
            .chip-navigation {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .chip-nav-btn {
                width: 100%;
                min-width: auto;
            }
            
            .chip-image-container {
                margin: 0.8rem 0;
                min-height: 150px;
            }
            
            .chip-description {
                padding: 0.8rem;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 360px) {
            .chip-modal-container {
                width: 100%;
                margin: 0.25rem;
                max-height: 99vh;
            }
            
            .chip-modal-container .modal-header h3 {
                font-size: 1rem;
            }
            
            .chip-nav-btn {
                font-size: 0.8rem;
                padding: 0.5rem 0.8rem;
            }
            
            .chip-image-container {
                min-height: 120px;
            }
        }
        
        /* Landscape orientation support for mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .chip-modal-container {
                max-height: 98vh;
                top: 45%;
            }
            
            .chip-modal-container .modal-header {
                padding: 0.8rem 1.5rem;
            }
            
            .chip-modal-container .modal-content {
                padding: 1rem 1.5rem;
            }
            
            .chip-image-container {
                margin: 0.8rem 0;
                min-height: 120px;
            }
            
            .chip-description {
                padding: 1rem;
                margin-top: 0.8rem;
            }
        }
        
        /* BCD to Excess-3 Simulator Horizontal Layout Styles - Enhanced to match Lab 1 responsive pattern */
        /* Note: Outer simulator-container removed, inner bcd-excess3-sim-card expanded to full width */
        .bcd-excess3-sim-card {
            background: var(--card-bg);
            border: 1.5px solid var(--card-border);
            border-radius: 18px;
            box-shadow: 0 6px 32px rgba(52,152,219,0.13), 0 1.5px 8px rgba(46,204,113,0.10);
            max-width: 1200px;
            margin: 2.5rem auto 2.5rem auto;
            padding: 2.5rem 2rem 2.2rem 2rem;
            /* Smooth transitions for responsive changes */
            transition: all 0.3s ease-in-out, box-shadow 0.3s;
            /* Ensure proper scaling and positioning */
            box-sizing: border-box;
        }
        
        /* Hover effect matching Lab 1 style */
        .bcd-excess3-sim-card:hover {
            box-shadow: 0 8px 40px rgba(52,152,219,0.18), 0 2px 12px rgba(46,204,113,0.15);
        }
        
        /* Header styling to match Function H Simulator - left-aligned */
        .bcd-excess3-sim-card .section-title {
            text-align: left;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .bcd-input-section {
            width: 100%;
            margin-bottom: 1.5rem;
        }
        
        .bcd-switch-row {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2.2rem;
            margin-bottom: 1rem;
            width: 100%;
            /* Smooth transitions for responsive changes */
            transition: gap 0.3s ease-in-out;
        }
        
        .bcd-switch-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
            /* Smooth transitions for responsive changes */
            transition: all 0.3s ease-in-out;
        }
        
        .bcd-values-display {
            margin-top: 1rem;
            padding: 0.8rem;
            background: var(--input-bg);
            border-radius: 6px;
            border: 1px solid var(--border);
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .bcd-conversion-logic {
            width: 100%;
            margin-bottom: 1.5rem;
        }
        
        .bcd-seg-section {
            width: 100%;
        }
        
        .bcd-seg-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 3rem;
            margin-bottom: 1.5rem;
            width: 100%;
            /* Ensure horizontal layout is always maintained */
            flex-direction: row !important;
            flex-wrap: nowrap;
            /* Smooth transitions for responsive changes */
            transition: gap 0.3s ease-in-out;
        }
        
        .bcd-seg-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
            /* Prevent wrapping and maintain horizontal alignment */
            flex-shrink: 0;
            /* Smooth transitions for responsive changes */
            transition: all 0.3s ease-in-out;
        }
        
        .excess3-values-display-centered {
            margin-top: 1.5rem;
            padding: 1rem;
            background: var(--input-bg);
            border-radius: 8px;
            border: 1px solid var(--border);
            max-width: 350px;
            text-align: center;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* Excess-3 LED Section Styles - Optimized for horizontal layout and space efficiency */
        /* Note: LEDs always maintain horizontal alignment with optimized spacing and sizing */
        .bcd-excess3-led-section {
            width: 100%;
            margin-top: 1.5rem;
        }
        
        .bcd-excess3-led-row {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 2rem;
            margin: 0.8rem 0;
            width: 100%;
            /* Ensure horizontal layout is always maintained */
            flex-direction: row !important;
            flex-wrap: nowrap;
            /* Smooth transitions for responsive changes */
            transition: gap 0.3s ease-in-out;
        }
        
        .bcd-excess3-led-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 55px;
            /* Prevent wrapping and maintain horizontal alignment */
            flex-shrink: 0;
        }
        
        .led-label {
            margin-top: 0.4rem;
            font-size: 0.85rem;
            color: var(--light);
            font-weight: 500;
            /* Ensure text doesn't wrap and maintains horizontal layout */
            white-space: nowrap;
            text-align: center;
        }
        
        /* Lab 7 specific LED styles to prevent conflicts with Lab 1 */
        .lab7-led {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: radial-gradient(circle at 60% 35%, #444 60%, #222 100%);
            margin: 8px auto 0;
            box-shadow: 0 2px 8px #000a, 0 0 0 2px #111a, inset 0 0 12px #000c;
            border: 2.5px solid #222;
            transition: background 0.35s, box-shadow 0.35s, border 0.25s, filter 0.3s, width 0.3s ease-in-out, height 0.3s ease-in-out;
            position: relative;
            outline: 2px solid transparent;
        }
        
        .lab7-led.active {
            background: radial-gradient(circle at 60% 35%, #fbc02d 60%, #e67e22 100%);
            box-shadow: 0 0 24px 8px #fbc02d88, 0 2px 8px #000a, 0 0 0 2px #e67e22, 0 0 40px 10px #fbc02d44, inset 0 0 18px #fff8;
            border: 2.5px solid #fbc02d;
            filter: brightness(1.15) saturate(1.2) drop-shadow(0 0 8px #fbc02d);
            outline: 2px solid #fbc02d88;
        }
        
        .lab7-led::after {
            content: '';
            display: block;
            position: absolute;
            left: 8px;
            top: 7px;
            width: 10px;
            height: 7px;
            border-radius: 50%;
            background: rgba(255,255,255,0.45);
            filter: blur(0.5px);
            opacity: 0.85;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .lab7-led.active::after {
            opacity: 1;
            background: rgba(255,255,220,0.7);
        }
        
        /* Ensure smooth scaling of SVG elements */
        .segment-display svg {
            transition: width 0.3s ease-in-out, height 0.3s ease-in-out;
        }
        
        /* Enhanced responsive design for BCD to Excess-3 simulator - Following Lab 1 pattern */
        @media (max-width: 700px) {
            .bcd-excess3-sim-card {
                padding: 1.2rem 0.5rem 1.2rem 0.5rem;
                max-width: 99vw;
                margin: 1.5rem auto 1.5rem auto;
            }
            
            /* Ensure header remains left-aligned on mobile */
            .bcd-excess3-sim-card .section-title {
                text-align: left;
                margin-bottom: 1.2rem;
                font-size: 1.3rem;
            }
            
            .bcd-switch-row {
                gap: 1.1rem;
            }
            
            .bcd-excess3-led-row {
                gap: 1.8rem;
                margin: 0.8rem 0;
            }
            
            .bcd-excess3-led-block {
                min-width: 50px;
            }
            
            .bcd-seg-container {
                gap: 1.5rem;
            }
            
            .segment-display svg {
                width: 70px;
                height: 120px;
            }
            
            .lab7-led {
                width: 32px;
                height: 32px;
                margin: 8px auto 0;
            }
            
            .led-label {
                font-size: 0.8rem;
                margin-top: 0.4rem;
            }
            
            .bcd-values-display,
            .excess3-values-display-centered {
                max-width: 280px;
                padding: 0.8rem;
            }
        }
        
        /* Additional mobile breakpoint for smaller screens */
        @media (max-width: 480px) {
            .bcd-excess3-sim-card {
                padding: 1rem 0.4rem;
                max-width: 100vw;
            }
            
            /* Ensure header remains left-aligned on small mobile */
            .bcd-excess3-sim-card .section-title {
                text-align: left;
                margin-bottom: 1rem;
                font-size: 1.2rem;
            }
            
            .bcd-switch-row {
                gap: 0.8rem;
            }
            
            .bcd-excess3-led-row {
                gap: 0.6rem;
                margin: 0.6rem 0;
            }
            
            .bcd-excess3-led-block {
                min-width: 45px;
            }
            
            .bcd-seg-container {
                gap: 1.2rem;
            }
            
            .input-switch {
                width: 48px;
                height: 24px;
            }
            
            .input-switch .slider:before {
                height: 18px;
                width: 18px;
            }
            
            input:checked + .slider:before {
                transform: translateX(24px);
            }
            
            .segment-display svg {
                width: 60px;
                height: 100px;
            }
            
            .lab7-led {
                width: 28px;
                height: 28px;
                margin: 6px auto 0;
            }
            
            .led-label {
                font-size: 0.75rem;
                margin-top: 0.3rem;
            }
            
            .bcd-values-display,
            .excess3-values-display-centered {
                max-width: 260px;
                padding: 0.7rem;
            }
        }
        
        /* Extra small mobile breakpoint for ultra-compact layout */
        @media (max-width: 360px) {
            .bcd-excess3-sim-card {
                padding: 0.8rem 0.3rem;
                max-width: 100vw;
            }
            
            /* Ensure header remains left-aligned on extra small mobile */
            .bcd-excess3-sim-card .section-title {
                text-align: left;
                margin-bottom: 0.8rem;
                font-size: 1.1rem;
            }
            
            .bcd-switch-row {
                gap: 0.6rem;
            }
            
            .bcd-excess3-led-row {
                gap: 0.5rem;
                margin: 0.5rem 0;
            }
            
            .bcd-excess3-led-block {
                min-width: 40px;
            }
            
            .lab7-led {
                width: 26px;
                height: 26px;
                margin: 5px auto 0;
            }
            
            .led-label {
                font-size: 0.7rem;
                margin-top: 0.25rem;
            }
        }
        
        .chip-description {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: var(--secondary-bg);
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .chip-description h4 {
            color: var(--secondary);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .chip-features {
            margin-top: 1rem;
        }
        
        .chip-features h5 {
            color: var(--accent);
            margin-bottom: 0.8rem;
            font-size: 1rem;
        }
        
        .chip-features ul {
            margin-left: 1.5rem;
            color: var(--light);
            line-height: 1.6;
        }
        
        /* Button Info Style */
        .btn-info {
            background: var(--info);
            color: white;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-info:hover {
            background: var(--info-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(52,152,219,0.3);
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(243,156,18,0.3);
        }
        
        /* Control Button Styles for Clear and Preset - Enhanced Industrial Design */
        .control-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
            padding: 0.8rem 0.6rem;
            border: none;
            border-radius: 8px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            color: #495057;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 70px;
            min-height: 70px;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .control-btn:hover,
        .control-btn:focus {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            outline: none;
            filter: brightness(1.05);
        }
        
        .control-btn:active,
        .control-btn.active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            background: linear-gradient(145deg, #e9ecef, #dee2e6);
        }
        
        /* Enhanced pressed state for Clear button */
        .control-btn-clear:active,
        .control-btn-clear.active,
        .control-btn-clear[aria-pressed="true"] {
            background: linear-gradient(145deg, #ee5a52, #d63031);
            transform: translateY(1px);
            box-shadow: 0 1px 3px rgba(238, 90, 82, 0.4);
            filter: brightness(0.95);
        }
        
        /* Enhanced pressed state for Preset button */
        .control-btn-preset:active,
        .control-btn-preset.active,
        .control-btn-preset[aria-pressed="true"] {
            background: linear-gradient(145deg, #00a085, #008f7a);
            transform: translateY(1px);
            box-shadow: 0 1px 3px rgba(0, 184, 148, 0.4);
            filter: brightness(0.95);
        }
        
        /* Active state indicator - clean and simple */
        .control-btn[aria-pressed="true"] {
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            filter: brightness(1.05);
        }
        
        .control-btn span {
            font-size: 0.7rem;
            text-align: center;
            line-height: 1.2;
            font-weight: 600;
            text-shadow: none;
            margin-top: 0.1rem;
        }
        
        .control-btn-clear {
            background: linear-gradient(145deg, #ff6b6b, #ee5a52);
            color: white;
            box-shadow: 0 2px 4px rgba(238, 90, 82, 0.3);
        }
        
        .control-btn-clear:hover {
            background: linear-gradient(145deg, #ff7b7b, #ff6b6b);
            box-shadow: 0 4px 8px rgba(238, 90, 82, 0.4);
        }
        
        .control-btn-clear:active,
        .control-btn-clear[aria-pressed="true"] {
            background: linear-gradient(145deg, #ee5a52, #d63031);
            transform: translateY(2px) scale(0.98);
            box-shadow: 
                2px 2px 5px rgba(238, 90, 82, 0.5),
                -2px -2px 5px rgba(255, 255, 255, 0.5),
                inset 3px 3px 8px rgba(0, 0, 0, 0.3);
        }
        
        .control-btn-preset {
            background: linear-gradient(145deg, #00b894, #00a085);
            color: white;
            box-shadow: 0 2px 4px rgba(0, 184, 148, 0.3);
        }
        
        .control-btn-preset:hover {
            background: linear-gradient(145deg, #00d4aa, #00b894);
            box-shadow: 0 4px 8px rgba(0, 184, 148, 0.4);
        }
        
        .control-btn-preset:active,
        .control-btn-preset[aria-pressed="true"] {
            background: linear-gradient(145deg, #00a085, #008f7a);
            transform: translateY(2px) scale(0.98);
            box-shadow: 
                2px 2px 5px rgba(0, 184, 148, 0.5),
                -2px -2px 5px rgba(255, 255, 255, 0.5),
                inset 3px 3px 8px rgba(0, 0, 0, 0.3);
        }
        
        /* Responsive design for control buttons */
        @media (max-width: 768px) {
            .control-btn {
                min-width: 65px;
                min-height: 65px;
                padding: 0.7rem 0.5rem;
                border-radius: 8px;
            }
            
            .control-btn span {
                font-size: 0.65rem;
                letter-spacing: 0.2px;
            }
        }
        
        @media (max-width: 480px) {
            .control-btn {
                min-width: 60px;
                min-height: 60px;
                padding: 0.6rem 0.4rem;
                border-radius: 6px;
            }
            
            .control-btn span {
                font-size: 0.6rem;
                letter-spacing: 0.1px;
            }
        }
        
        /* Responsive Design for Modal */
        @media (max-width: 768px) {
            .answer-comparison {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .question-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .question-header h4 {
                text-align: center;
            }
            
            .modal-container {
                margin: 1rem;
                max-height: calc(100vh - 2rem);
            }
            
            .modal-content {
                padding: 1.5rem;
            }
            
            .modal-header,
            .modal-footer {
                padding: 1rem 1.5rem;
            }
            
            /* Enhanced chip image centering for mobile */
            .chip-image-container {
                margin: 1rem 0;
                padding: 0 0.5rem;
            }
            
            .chip-image {
                max-width: 95%;
                border-radius: 6px;
            }
            
            /* Responsive section title with button for mobile */
            .section-title {
                flex-direction: row;
                align-items: center;
                gap: 0.5rem;
            }
            
            .section-title .btn-info {
                min-width: 100px;
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
        }
        
        /* Tablet-specific responsive design */
        @media (min-width: 769px) and (max-width: 1024px) {
            .chip-modal-container {
                width: 92%;
                max-width: 800px;
            }
            
            .chip-modal-container .modal-header h3 {
                font-size: 1.3rem;
            }
            
            .chip-navigation {
                gap: 1.2rem;
            }
            
            .chip-nav-btn {
                padding: 0.9rem 1.3rem;
                min-width: 110px;
            }
        }
        
        .k-map {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            margin: 1.5rem auto;
            max-width: 500px;
        }
        
        .k-map-cell {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .k-map-header {
            background: rgba(52, 152, 219, 0.7);
            font-weight: bold;
        }
        
        /* Enhanced K-Map Styles */
        .k-map-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        
        .k-map-container {
            margin-bottom: 2rem;
            display: flex;
            flex-direction: column;
        }
        
        .k-map-container h4 {
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 1.1rem;
            align-self: flex-start;
            width: 100%;
        }
        
        .k-map-input {
            width: 100%;
            height: 100%;
            border: none;
            background: var(--input-bg);
            color: var(--text);
            text-align: center;
            font-size: 1rem;
            font-weight: bold;
            padding: 8px;
            border-radius: 4px;
            transition: all 0.3s ease, background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
        }
        
        .k-map-input:focus {
            outline: none;
            background: var(--accent);
            color: white;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
        }
        
        .k-map-input:valid {
            background: rgba(39, 174, 96, 0.2);
            border: 1px solid #27ae60;
        }
        
        .k-map-input.invalid {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #e74c3c;
            animation: shake 0.5s ease-in-out;
        }
        
        .k-map-input.correct {
            background: rgba(39, 174, 96, 0.15);
            border: 2px solid var(--success);
            color: var(--success);
        }
        
        .k-map-input.incorrect {
            background: rgba(231, 76, 60, 0.15);
            border: 2px solid var(--accent);
            color: var(--accent);
        }
        
        .k-map-input.empty {
            background: rgba(52, 152, 219, 0.15);
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }
        
        /* Enhanced dark mode support for visual feedback */
        body.dark-mode .k-map-input.correct {
            background: rgba(39, 174, 96, 0.25);
            border: 2px solid var(--success);
            color: #4ade80;
            text-shadow: 0 0 8px rgba(39, 174, 96, 0.3);
        }
        
        body.dark-mode .k-map-input.incorrect {
            background: rgba(231, 76, 60, 0.25);
            border: 2px solid var(--accent);
            color: #f87171;
            text-shadow: 0 0 8px rgba(231, 76, 60, 0.3);
        }
        
        body.dark-mode .k-map-input.empty {
            background: rgba(52, 152, 219, 0.25);
            border: 2px solid var(--secondary);
            color: #60a5fa;
            text-shadow: 0 0 8px rgba(52, 152, 219, 0.3);
        }
        
        /* Light mode enhancements for visual feedback */
        body.light-mode .k-map-input.correct {
            background: rgba(39, 174, 96, 0.2);
            border: 2px solid var(--success);
            color: #166534;
            text-shadow: none;
        }
        
        body.light-mode .k-map-input.incorrect {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid var(--accent);
            color: #991b1b;
            text-shadow: none;
        }
        
        body.light-mode .k-map-input.empty {
            background: rgba(52, 152, 219, 0.2);
            border: 2px solid var(--secondary);
            color: #1e40af;
            text-shadow: none;
        }
        

        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .k-map-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }
        
        .k-map-simplification {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }
        
        .k-map-simplification h4 {
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 1.1rem;
        }
        
        .simple-editor-container {
            margin-bottom: 1.5rem;
        }
        
        .simple-editor-toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .simple-editor {
            min-height: 80px;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--input-bg);
            color: var(--text);
            font-size: 1rem;
            line-height: 1.5;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .simple-editor:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2), 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        
        /* Dark mode text editor enhancements */
        .simple-editor {
            border-color: rgba(52, 152, 219, 0.6);
            background: rgba(40, 50, 60, 0.9);
        }
        
        .simple-editor:hover {
            border-color: rgba(52, 152, 219, 0.8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .simple-editor[placeholder]:empty:before {
            content: attr(placeholder);
            color: var(--muted);
            pointer-events: none;
            font-style: italic;
            opacity: 0.7;
        }
        
        .k-map-actions {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            width: 100%;
        }
        
        /* K-Map Modal Layout Styles */
        .kmap-modal-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .kmap-left-panel,
        .kmap-right-panel {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .kmap-explanation {
            border-top: 2px solid var(--border);
            padding-top: 2rem;
            margin-top: 2rem;
        }
        
        .kmap-explanation h4 {
            margin-bottom: 1.5rem;
            color: var(--text);
            font-size: 1.2rem;
        }
        
        .kmap-grid-display {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 4px;
            max-width: 400px;
            margin: 0 auto;
            align-items: center;
            justify-items: center;
        }
        
        .kmap-row {
            display: contents;
        }
        
        .kmap-header-cell {
            background: var(--accent);
            color: white;
            padding: 8px 4px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 36px;
            min-width: 60px;
        }
        
        .kmap-cell {
            background: var(--input-bg);
            color: var(--text);
            padding: 8px 4px;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 36px;
            min-width: 60px;
        }
        
        .kmap-cell.dont-care-one {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .kmap-cell.dont-care-zero {
            background: #f39c12;
            color: white;
            border-color: #e67e22;
        }
        
        .kmap-cell.dont-care-chosen {
            background: #f39c12;
            color: white;
            border-color: #e67e22;
            font-weight: bold;
        }
        
        .kmap-cell.empty-display {
            color: var(--muted);
            font-weight: normal;
            opacity: 0.8;
            background: var(--input-bg);
            border-style: dashed;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 36px;
        }
        

        
        @media (max-width: 768px) {
            .kmap-modal-layout {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .kmap-grid-display {
                max-width: 100%;
                gap: 2px;
            }
            
            .kmap-cell,
            .kmap-header-cell {
                min-width: 40px;
                min-height: 32px;
                font-size: 0.9rem;
                padding: 6px 3px;
            }
            
            .answer-display.compact {
                padding: 0.5rem 0.75rem;
            }
            
            .k-map-container {
                align-items: stretch;
            }
            
            .k-map-container h4 {
                align-self: flex-start;
                width: 100%;
            }
            
            .k-map {
                max-width: 100%;
                grid-template-columns: repeat(5, 1fr);
            }
        }
        
        .counter-display {
            font-size: 2rem;
            font-weight: bold;
            background: rgba(25, 35, 45, 0.9);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }
        
        .counter-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .counter-btn {
            padding: 10px 20px;
            background: rgba(52, 152, 219, 0.7);
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .counter-btn:hover {
            background: rgba(52, 152, 219, 0.9);
        }
        
        .flip-flop {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(25, 35, 45, 0.9);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .ff-inputs {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }
        
        .ff-output {
            margin-top: 20px;
            font-weight: bold;
        }
        
        @media (max-width: 900px) {
            .container {
                flex-direction: column;
                padding-left: 0;
            }
            
            .sidebar {
                display: none;
                position: fixed;
                left: 0;
                top: 0;
                width: 80vw;
                max-width: 350px;
                height: 100vh;
                z-index: 100;
                box-shadow: 2px 0 16px rgba(0,0,0,0.2);
                background: var(--card-bg);
                overflow-y: auto;
                transition: transform 0.3s;
            }
            .sidebar.open {
                display: block;
                transform: translateX(0);
            }
            .sidebar-hamburger {
                display: block;
            }
            
            .main-content {
                max-height: none;
            }
            
            .lab-title {
                font-size: 1.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .simulator {
                grid-template-columns: 1fr;
            }
            
            .truth-table, .ic-table {
                font-size: 0.9rem;
                overflow-x: auto;
                display: block;
            }
        }
        
        @media (max-width: 600px) {
            .main-content, .sidebar {
                padding: 1rem;
            }
            .lab-title, h1 {
                font-size: 1.2rem;
            }
            .simulator {
                grid-template-columns: 1fr;
            }
            .truth-table, .ic-table {
                font-size: 0.9rem;
                overflow-x: auto;
                display: block;
            }
            header {
                padding: 0.4rem 0.2rem 0.4rem 0.2rem;
            }
            .container {
                padding-top: 4.2rem;
            }
            h1 {
                font-size: 1.05rem;
            }
            .subtitle, .university {
                font-size: 0.8rem;
            }
            
            /* Enhanced button responsiveness for very small screens */
            .section-title .btn-info {
                min-width: 90px;
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }
        }
        
        /* --- Header Buttons Modern UI/UX (Position Preserved) --- */
        .theme-toggle-btn,
        .help-toggle-btn {
            position: absolute;
            top: 1.5rem;
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20;
            transition: background-color 0.3s cubic-bezier(.4,0,.2,1),
                        transform 0.3s cubic-bezier(.4,0,.2,1),
                        color 0.3s cubic-bezier(.4,0,.2,1),
                        box-shadow 0.3s cubic-bezier(.4,0,.2,1);
        }
        
        /* Theme toggle button specific styling */
        .theme-toggle-btn {
            border-radius: 50%;
        }
        
        .theme-toggle-btn {
            right: 2rem;
        }
        
        .help-toggle-btn {
            right: 5rem;
        }
        
        /* Responsive header button positioning */
        @media (max-width: 768px) {
            .help-toggle-btn {
                right: 4.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .help-toggle-btn {
                right: 4rem;
            }
        }
        
        @media (max-width: 360px) {
            .help-toggle-btn {
                right: 3.5rem;
            }
        }
        
        .theme-toggle-btn:hover, .theme-toggle-btn:focus {
            background-color: rgba(0,0,0,0.07);
            box-shadow: 0 4px 18px rgba(52,152,219,0.13);
            outline: none;
        }
        
        .help-toggle-btn:hover, .help-toggle-btn:focus {
            outline: none;
        }
        .theme-toggle-icon,
        .help-toggle-icon {
            font-size: 1.35rem;
            display: block;
            transition: transform 0.44s cubic-bezier(.4,0,.2,1), opacity 0.3s cubic-bezier(.4,0,.2,1), color 0.3s cubic-bezier(.4,0,.2,1);
        }
        
        .theme-toggle-icon.toggled {
            transform: rotate(180deg) scale(1.15);
            opacity: 0.85;
        }
        
        .help-toggle-icon {
            color: var(--success);
            /* White frame for dark mode visibility */
            text-shadow: 
                0 0 2px rgba(255, 255, 255, 0.8),
                0 0 4px rgba(255, 255, 255, 0.6),
                0 0 6px rgba(255, 255, 255, 0.4);
        }
        
        .help-toggle-btn:hover .help-toggle-icon,
        .help-toggle-btn:focus .help-toggle-icon {
            color: var(--accent);
            /* Enhanced white frame on hover for better visibility */
            text-shadow: 
                0 0 3px rgba(255, 255, 255, 0.9),
                0 0 6px rgba(255, 255, 255, 0.7),
                0 0 9px rgba(255, 255, 255, 0.5);
        }
        
        /* Light mode adjustments for help toggle icon */
        body.light-mode .help-toggle-icon {
            text-shadow: 
                0 0 2px rgba(0, 0, 0, 0.3),
                0 0 4px rgba(0, 0, 0, 0.2);
        }
        
        body.light-mode .help-toggle-btn:hover .help-toggle-icon,
        body.light-mode .help-toggle-btn:focus .help-toggle-icon {
            text-shadow: 
                0 0 3px rgba(0, 0, 0, 0.4),
                0 0 6px rgba(0, 0, 0, 0.3);
        }
        
        @media (prefers-reduced-motion: reduce) {
            .theme-toggle-btn, .theme-toggle-btn,
            .help-toggle-btn, .help-toggle-icon {
                transition: none !important;
            }
        }
        #themeToggle {
            outline: none;
            background: #fff;
            color: #fbc02d;
            box-shadow: 0 2px 8px rgba(25,118,210,0.10);
            border: 1px solid #e3eaf2;
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
        }
        body.light-mode #themeToggle {
            background: #fff;
            color: #fbc02d;
            border: 1px solid #e3eaf2;
        }
        body:not(.light-mode) #themeToggle {
            background: #23272f;
            color: #6366f1;
            border: 1px solid #374151;
        }
        #themeToggle:hover, #themeToggle:focus {
            background: rgba(99,102,241,0.12);
            box-shadow: 0 6px 24px rgba(99,102,241,0.18);
        }
        #themeToggle svg {
            width: 28px;
            height: 28px;
            display: block;
            transition: transform 0.4s cubic-bezier(.4,2,.6,1), fill 0.3s, color 0.3s, filter 0.3s;
        }
        #themeToggle.sun svg {
            color: #fbc02d;
            fill: #fbc02d;
            filter: none;
            transform: rotate(0deg) scale(1.1);
        }
        #themeToggle.moon svg {
            color: #fff;
            fill: none;
            stroke: #fff;
            stroke-width: 1.5;
            filter: drop-shadow(0 0 6px #6366f1);
            transform: rotate(-20deg) scale(1.1);
        }
        /* Ensure moon icon is visible on dark backgrounds */
        body:not(.light-mode) #themeToggle.moon svg {
            color: #fff;
            fill: #fff;
        }
        @keyframes dropdownFromLeft {
          from { opacity: 0; transform: translate(-30px, -20px) scale(0.96); }
          to { opacity: 1; transform: translate(0, 0) scale(1); }
        }
        .toc-dropdown {
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.3s cubic-bezier(.4,2,.6,1), transform 0.3s cubic-bezier(.4,2,.6,1);
          left: 2rem;
          top: 4.5rem;
          right: auto;
          margin: 0;
          /* Remove inline animation, use .open for animation */
        }
        .toc-dropdown.open {
          opacity: 1;
          pointer-events: auto;
          transform: translate(0, 0) scale(1);
          animation: dropdownFromLeft 0.4s cubic-bezier(.4,2,.6,1);
        }
        @media (max-width: 600px) {
          .toc-dropdown {
            max-width: 98vw;
            padding: 1.2rem 0.5rem 1rem 0.5rem;
            left: 1vw;
            top: 4.5rem;
          }
          
          .help-toggle-btn {
            right: 4.5rem;
          }
          
          .help-dropdown {
            right: 1rem;
            top: 4.5rem;
            min-width: 180px;
            max-width: calc(100vw - 2rem);
          }
        }
        html.no-scroll, body.no-scroll {
          overflow: hidden !important;
          position: relative;
          height: 100%;
        }
        html {
            background: linear-gradient(135deg, #1a2a3a 0%, #2c3e50 100%);
        }
        body.light-mode html {
            background: linear-gradient(135deg, #e3eaf2 0%, #f5f7fa 100%);
        }
        .sidebar-hamburger {
            transition: background 0.3s, box-shadow 0.3s, transform 0.2s;
        }
        .sidebar-hamburger:hover, .sidebar-hamburger:focus {
            background: rgba(52,152,219,0.28);
            box-shadow: 0 4px 18px rgba(52,152,219,0.18), 0 1.5px 8px rgba(46,204,113,0.10);
            transform: scale(1.12) rotate(-6deg);
            outline: none;
        }
        img, svg, video {
            max-width: 100%;
            height: auto;
            display: block;
        }
        @media (max-width: 1600px) {
            :root { --max-width: 1200px; }
        }
        @media (max-width: 1280px) {
            :root { --max-width: 1000px; }
        }
        @media (max-width: 1024px) {
            :root { --max-width: 800px; }
            .main-content { padding: var(--gap-md); }
        }
        @media (max-width: 768px) {
            :root { --max-width: 98vw; }
            .container { padding-inline: clamp(0.5rem, 3vw, 1.5rem); }
            .main-content { padding: var(--gap-sm); }
        }
        @media (max-width: 480px) {
            .container { padding-inline: clamp(0.25rem, 2vw, 0.75rem); }
            .main-content { padding: var(--gap-xs); }
        }
        @media (max-width: 360px) {
            html { font-size: 13px; }
            .container { padding-inline: 0.1rem; }
        }
        a:focus, button:focus, input:focus {
            outline: 2px solid var(--secondary);
            outline-offset: 2px;
        }
        .image-frame {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            box-sizing: border-box;
            aspect-ratio: 16/9;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(25, 35, 45, 0.7); /* Match .lab-section background in dark mode */
            border-radius: 8px;
            height: auto;
            min-height: 0;
            padding: 0;
        }
        body.light-mode .image-frame {
            background: #f8fafc; /* Match .lab-section background in light mode */
        }
        .responsive-img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            box-sizing: border-box;
            max-width: 120%;
            max-height: 120%;
            transform: scale(1.15);
            margin: 0 auto;
            transition: transform 0.3s;
        }
        @media (max-width: 900px) {
            .responsive-img {
                transform: scale(1.08);
                max-width: 110%;
                max-height: 110%;
            }
        }
        @media (max-width: 600px) {
            .responsive-img {
                transform: scale(1.03);
                max-width: 105%;
                max-height: 105%;
            }
        }
        @media (max-width: 400px) {
            .image-frame {
                aspect-ratio: 4/3;
            }
        }
        /* --- Accessibility and animation for Lab 1 LED & 7-Segment Simulator --- */
        /* 1. Add animation for 7-segment display */
        .segment-display {
            transition: background 0.3s, color 0.3s, box-shadow 0.3s, transform 0.2s;
            will-change: background, color, box-shadow, transform;
        }
        .segment-display.animated {
            background: #222 !important;
            color: #fbc02d !important;
            box-shadow: 0 0 16px #fbc02d, 0 0 2px #fff;
            transform: scale(1.08) rotate(-2deg);
        }
        /* 2. LED output smooth transition */
        .led-output {
            transition: background 0.3s, box-shadow 0.3s, outline 0.2s;
            outline: 2px solid transparent;
        }
        .led-output.active {
            background: #3498db !important;
            box-shadow: 0 0 24px #3498db, 0 0 2px #fff;
            outline: 2px solid #2ecc71;
        }
        /* 3. Responsive stacking for simulator */
        @media (max-width: 700px) {
            .simulator {
                grid-template-columns: 1fr !important;
                gap: 1.5rem !important;
            }
            .input-container, .output-container {
                flex-direction: row !important;
                gap: 1.5rem !important;
                justify-content: center;
            }
        }
        /* 4. Focus style for toggles */
        .input-switch input:focus + .slider {
            box-shadow: 0 0 0 3px #3498db55;
            outline: 2px solid #3498db;
        }
        /* 5. Tooltip style */
        .sim-tooltip {
            position: absolute;
            left: 50%;
            top: -2.2rem;
            transform: translateX(-50%);
            background: #222b;
            color: #fff;
            font-size: 0.85rem;
            padding: 0.3rem 0.7rem;
            border-radius: 6px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
        }
        .input-switch:hover .sim-tooltip,
        .input-switch:focus-within .sim-tooltip {
            opacity: 1;
        }
        /* 6. Visually hidden for screen readers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            border: 0;
        }
        .led-state-label {
            font-size: 0.95em;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-left: 2px;
            transition: color 0.3s;
        }
        .led-state-label.high {
            color: #2ecc71;
        }
        .led-state-label.low {
            color: #e74c3c;
        }
        @media (max-width: 700px) {
            .input-row {
                flex-direction: column !important;
                gap: 1.5rem !important;
            }
            .output-container {
                margin-top: 1.5rem !important;
            }
        }
        .lab1-sim-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 0.3rem;
            text-align: center;
            letter-spacing: 0.5px;
        }
        .lab1-sim-desc {
            font-size: 1.02rem;
            color: var(--gray);
            margin-bottom: 1.2rem;
            text-align: center;
            max-width: 480px;
            margin-left: auto;
            margin-right: auto;
        }
        .lab1-sim-card {
            background: var(--card-bg);
            border-radius: 18px;
            box-shadow: 0 6px 32px rgba(52,152,219,0.13), 0 1.5px 8px rgba(46,204,113,0.10);
            padding: 2.5rem 2rem 2.2rem 2rem;
            max-width: 480px;
            margin: 2.5rem auto 2.5rem auto; /* Add margin-top for space above */
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1.5px solid var(--card-border);
            transition: box-shadow 0.3s;
        }
        @media (max-width: 700px) {
            .lab1-sim-card {
                padding: 1.2rem 0.5rem 1.2rem 0.5rem;
                max-width: 99vw;
                margin: 1.5rem auto 1.5rem auto;
            }
        }
        .lab1-switch-row {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2.2rem;
            margin-bottom: 2.2rem;
            width: 100%;
        }
        .lab1-switch-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        .lab1-led-row {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 2.2rem;
            margin-top: 0.5rem;
            margin-bottom: 2.2rem;
            width: 100%;
        }
        .lab1-led-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        .lab1-seg-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            width: 100%;
        }
        .lab1-seg-labels {
            display: flex;
            gap: 2.5rem;
            margin-top: 0.7rem;
            justify-content: center;
            width: 100%;
        }
        .lab1-note {
            font-size: 0.93rem;
            color: var(--gray);
            margin-top: 0.7rem;
            text-align: center;
            font-style: italic;
        }
        .input-switch input:focus + .slider, .input-switch input:hover + .slider {
            box-shadow: 0 0 0 3px #3498db55;
            outline: 2px solid #3498db;
        }
        .input-switch .slider {
            transition: box-shadow 0.3s, background 0.3s;
        }
        .input-switch .sim-tooltip {
            font-size: 0.88em;
            background: #232b;
            color: #fff;
            padding: 0.18em 0.7em;
            border-radius: 6px;
            position: absolute;
            left: 50%;
            top: -2.1rem;
            transform: translateX(-50%);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 10;
            white-space: nowrap;
        }
        .input-switch:hover .sim-tooltip,
        .input-switch:focus-within .sim-tooltip {
            opacity: 1;
        }
        @media (max-width: 700px) {
            .lab1-sim-card {
                padding: 1.2rem 0.5rem 1.2rem 0.5rem;
                max-width: 99vw;
            }
            .lab1-switch-row, .lab1-led-row {
                gap: 1.1rem;
            }
            .lab1-seg-labels {
                gap: 1.1rem;
            }
        }
        .lab1-sim-divider {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0.5rem 0 1.2rem 0;
        }
        .lab1-sim-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary);
            font-size: 2.1rem;
            opacity: 0.7;
            margin: 0 0.2rem;
            user-select: none;
        }
        .lab1-sim-divider-line {
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, var(--card-border) 40%, var(--card-border) 60%, transparent 100%);
            border-radius: 2px;
            margin: 0 0.5rem;
            opacity: 0.5;
        }
        .lab1-sim-intro {
            background: var(--card-bg);
            border: 1.5px solid var(--card-border);
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(52,152,219,0.07);
            max-width: 540px;
            margin: 0 auto 2.2rem auto;
            padding: 1.5rem 2rem 1.2rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .lab1-sim-intro-title {
            font-size: 1.45rem;
            font-weight: 800;
            color: var(--secondary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            justify-content: center;
            letter-spacing: 0.5px;
        }
        .lab1-sim-intro-title i {
            font-size: 1.3em;
            color: var(--accent);
            vertical-align: middle;
        }
        .lab1-sim-intro-desc {
            font-size: 1.08rem;
            color: var(--gray);
            margin-bottom: 0.1rem;
            line-height: 1.7;
            font-weight: 500;
            max-width: 480px;
        }
        .lab1-sim-intro-divider {
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, var(--card-border) 40%, var(--card-border) 60%, transparent 100%);
            border-radius: 2px;
            margin: 1.2rem 0 0.5rem 0;
            opacity: 0.6;
        }
        @media (max-width: 700px) {
            .lab1-sim-intro {
                padding: 1.1rem 0.7rem 1rem 0.7rem;
                max-width: 99vw;
            }
            .lab1-sim-intro-title {
                font-size: 1.08rem;
            }
            .lab1-sim-intro-desc {
                font-size: 0.98rem;
            }
        }
        .section-desc {
            font-size: 1.05rem;
            color: var(--gray);
            margin-bottom: 1.2rem;
            margin-top: -0.5rem;
            line-height: 1.7;
            font-weight: 500;
            width: 100%;
            max-width: none;
            display: block;
            text-align: left;
        }
        @media (max-width: 700px) {
            .section-desc {
                font-size: 0.98rem;
                max-width: none;
            }
        }
        .segment-display svg {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
            filter: drop-shadow(0 2px 12px #0008);
        }
        /* Add to CSS */
        .lab-section.hidden {
          display: none !important;
        }
        /* --- Enhanced Hamburger Button for Modern UI/UX --- */
        .hamburger-button {
            cursor: pointer;
            transition: transform 0.28s cubic-bezier(.4,0,.2,1), background 0.28s cubic-bezier(.4,0,.2,1), color 0.28s cubic-bezier(.4,0,.2,1), box-shadow 0.28s cubic-bezier(.4,0,.2,1);
            will-change: transform;
            background: rgba(52,152,219,0.15);
            box-shadow: 0 2px 8px rgba(52,152,219,0.10);
        }
        .hamburger-button:hover, .hamburger-button:focus {
            transform: scale(1.07);
            background: #e0f7ff;
            color: #1976d2;
            box-shadow: 0 4px 18px rgba(52,152,219,0.18), 0 1.5px 8px rgba(46,204,113,0.10);
            outline: none;
        }
        @media (prefers-reduced-motion: reduce) {
            .hamburger-button {
                transition: none !important;
            }
        }
        /* Add custom number styling for ordered steps-list in Lab 2 */
        #lab2 .steps-list {
            list-style-type: decimal;
            counter-reset: step;
            margin-left: 2.2rem !important;
            padding-left: 0;
        }
        #lab2 .steps-list > li {
            position: relative;
            margin-bottom: 1.1rem;
            padding-left: 0.5rem;
            font-size: 1.08rem;
        }
        #lab2 .steps-list > li::marker {
            color: var(--secondary);
            font-weight: bold;
            font-size: 1.15em;
        }
        /* Responsive and accessible truth table styles */
        #interactive-truth-table {
          min-width: 600px;
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
        }
        #interactive-truth-table th, #interactive-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
        }
        #interactive-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #interactive-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #interactive-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #interactive-truth-table input.output-field {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #interactive-truth-table input.output-field:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #interactive-truth-table input.output-field.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #interactive-truth-table input.output-field.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #interactive-truth-table input.output-field.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        @media (max-width: 700px) {
          .responsive-table {
            display: block;
            overflow-x: auto;
            width: 100%;
            max-width: 100vw;
            margin-left: auto;
            margin-right: auto;
            padding-bottom: 0;
          }
          #interactive-truth-table {
            font-size: 0.95rem;
            min-width: 480px;
          }
        }
        .table-buttons {
          margin-top: 0.5rem;
          margin-bottom: 1.5rem;
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          justify-content: flex-start;
        }
        .table-buttons .btn {
          font-size: 1rem;
          font-weight: 600;
          border-radius: 8px;
          min-width: 120px;
          box-shadow: 0 2px 8px rgba(52,152,219,0.08);
        }
        .logic-drawing-section {
          margin-bottom: 1.5rem;
        }
        .toolbar {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 0.7rem;
          flex-wrap: wrap;
        }
        .toolbar label {
          display: flex;
          align-items: center;
          gap: 0.3rem;
          font-size: 0.98em;
        }
        .toolbar input[type="color"] {
          width: 28px;
          height: 28px;
          border: none;
          background: none;
        }
        .toolbar input[type="range"] {
          width: 70px;
        }
        .toolbar button {
          min-width: 40px;
        }
        #drawingContainer {
          width: 100%;
          max-width: 800px;
          margin: 0 auto;
          position: relative;
          background: #fff;
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
        }
        #drawingCanvas {
          width: 100%;
          height: auto;
          max-width: 100%;
          border-radius: 10px;
          display: block;
          background: #fff;
          touch-action: none;
        }
        .tool-toggle {
          background-color: #f0f0f0;
          border: none;
          border-radius: 999px;
          padding: 0.5rem 1rem;
          cursor: pointer;
          position: relative;
          transition: background-color 0.3s ease, box-shadow 0.3s ease;
          box-shadow: 0 0 0 transparent;
          outline: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .tool-toggle:focus,
        .tool-toggle:hover {
          box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
          background-color: #e3eaf2;
        }
        .tool-toggle .icon {
          display: inline-block;
          font-size: 1.25rem;
          transition: transform 0.4s cubic-bezier(.4,0,.2,1), opacity 0.3s cubic-bezier(.4,0,.2,1);
        }
        .tool-toggle.eraser .icon {
          transform: rotateY(180deg) scale(1.2);
        }
        .tool-toggle.pen .icon {
          transform: rotateY(0deg) scale(1);
        }
        .tool-toggle.eraser {
          background-color: #fffbe7;
          box-shadow: 0 0 8px #ffe08288;
        }
        .drawing-wrapper {
          overflow: auto;
          max-width: 100%;
          border: 1px solid #ccc;
          padding: 1rem;
          text-align: center;
          background: #fff;
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
        }
        .canvas-controls {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 0.7rem;
          flex-wrap: wrap;
        }
        .canvas-controls button {
          background: var(--secondary);
          color: #fff;
          border: none;
          border-radius: 6px;
          font-size: 1.2rem;
          padding: 0.3rem 0.8rem;
          cursor: pointer;
          transition: background 0.2s, box-shadow 0.2s;
        }
        .canvas-controls button:focus,
        .canvas-controls button:hover {
          background: #1976d2;
          box-shadow: 0 0 8px #1976d2aa;
        }
        .canvas-controls label {
          font-size: 1rem;
          color: var(--secondary);
        }
        .canvas-controls select {
          font-size: 1rem;
          border-radius: 6px;
          padding: 0.2rem 0.7rem;
          border: 1.5px solid var(--card-border);
        }
        .zoom-level {
          font-size: 0.98rem;
          color: var(--gray);
          min-width: 70px;
        }
        .drawing-wrapper canvas {
          transition: transform 0.3s cubic-bezier(.4,0,.2,1);
          transform-origin: top left;
          background: #fff;
          border-radius: 10px;
          display: block;
          margin: 0 auto;
        }
        .toolbar .zoom-btn {
          background: linear-gradient(135deg, var(--secondary) 60%, #64b5f6 100%);
          color: var(--light);
          border: none;
          border-radius: 50%;
          width: 38px;
          height: 38px;
          font-size: 1.35rem;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 8px rgba(52,152,219,0.10);
          cursor: pointer;
          transition: background 0.22s, box-shadow 0.22s, transform 0.18s;
          outline: none;
          margin: 0 2px;
        }
        .toolbar .zoom-btn:focus {
          outline: 2.5px solid var(--accent);
          outline-offset: 2px;
          box-shadow: 0 0 0 4px #e74c3c33;
        }
        .toolbar .zoom-btn:hover {
          background: linear-gradient(135deg, #64b5f6 60%, var(--secondary) 100%);
          color: var(--light);
          box-shadow: 0 4px 18px #1976d2aa, 0 2px 8px #3498db44;
          transform: scale(1.13);
        }
        .toolbar .zoom-slider {
          width: 140px;
          margin: 0 12px;
          accent-color: var(--secondary);
          background: transparent;
          height: 6px;
          border-radius: 8px;
          outline: none;
          position: relative;
          transition: box-shadow 0.2s;
          --slider-bg: linear-gradient(90deg, #3498db 0%, #64b5f6 100%);
          --slider-bg-light: linear-gradient(90deg, #1976d2 0%, #bbdefb 100%);
        }
        .toolbar .zoom-slider:focus {
          box-shadow: 0 0 0 4px #3498db33;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-webkit-slider-thumb,
        .toolbar .zoom-slider:hover::-webkit-slider-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider::-webkit-slider-runnable-track {
          height: 6px;
          border-radius: 8px;
          background: var(--slider-bg);
          box-shadow: 0 1px 4px #3498db22, 0 1px 8px #fff inset;
        }
        .toolbar .zoom-slider::-ms-fill-lower {
          background: #3498db;
        }
        .toolbar .zoom-slider::-ms-fill-upper {
          background: #64b5f6;
        }
        .toolbar .zoom-slider::-moz-range-thumb {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-moz-range-thumb,
        .toolbar .zoom-slider:hover::-moz-range-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider::-moz-range-track {
          height: 6px;
          border-radius: 8px;
          background: var(--slider-bg);
          box-shadow: 0 1px 4px #3498db22, 0 1px 8px #fff inset;
        }
        .toolbar .zoom-slider::-ms-thumb {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-ms-thumb,
        .toolbar .zoom-slider:hover::-ms-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider:focus::-webkit-slider-thumb {
          outline: 2px solid #3498db;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb:focus {
          outline: 2px solid #3498db;
        }
        .toolbar .zoom-slider::-moz-focus-outer {
          border: 0;
        }
        .toolbar .zoom-slider::-ms-tooltip {
          display: none;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb::after {
          display: none;
        }
        .toolbar .zoom-slider::-webkit-slider-container {
          background: transparent;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb {
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
        }
        body.light-mode .toolbar .zoom-slider::-webkit-slider-runnable-track,
        body.light-mode .toolbar .zoom-slider::-moz-range-track {
          background: var(--slider-bg-light);
        }
        @media (max-width: 700px) {
          .toolbar .zoom-slider {
            width: 90px;
          }
        }
        .toolbar-scroll-x {
          width: 100%;
          overflow-x: auto;
          overflow-y: visible;
          padding-bottom: 0;
          margin-bottom: 0.2rem;
          /* Show scrollbar above the toolbar */
          box-sizing: border-box;
          position: relative;
          /* Place a fake scrollbar above */
          /* Use a negative margin to pull up the scrollbar visually */
          margin-top: 0;
          scrollbar-width: thin;
          scrollbar-color: var(--secondary) #e3eaf2;
        }
        .toolbar-scroll-x::-webkit-scrollbar {
          height: 10px;
        }
        .toolbar-scroll-x::-webkit-scrollbar-thumb {
          background: var(--secondary);
          border-radius: 6px;
        }
        .toolbar-scroll-x::-webkit-scrollbar-track {
          background: #e3eaf2;
          border-radius: 6px;
        }
        @media (max-width: 900px) {
          .toolbar-scroll-x {
            margin-bottom: 0.2rem;
          }
        }
        .lab1-bcd-desc {
          color: #fff;
        }
        body.light-mode .lab1-bcd-desc {
          color: #111;
        }
        .lab1-bcd-desc, .lab1-bcd-desc .lab1-bcd-span {
          font-weight: 400 !important;
        }
        .equation-box {
          background:rgba(52,152,219,0.08);
          border-left:4px solid var(--secondary);
          padding:0.9rem 1.2rem;
          margin:1.1rem 0 0.7rem 0;
          border-radius:8px;
          font-size:1.18rem;
          font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
          box-shadow:0 2px 8px rgba(52,152,219,0.07);
          color:#6ec6ff;
          overflow-x:auto;
        }
        body.light-mode .equation-box {
          color: var(--secondary);
        }
        /* Responsive and accessible truth table styles for Lab 3 */
        #lab3-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab3-truth-table th, #lab3-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab3-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab3-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab3-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #lab3-truth-table input.output-field-lab3 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #lab3-truth-table input.output-field-lab3:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab3-truth-table input.output-field-lab3.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab3-truth-table input.output-field-lab3.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab3-truth-table input.output-field-lab3.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        /* Responsive and accessible truth table styles for Lab 4 */
        #lab4-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab4-truth-table th, #lab4-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab4-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab4-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab4-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #lab4-truth-table input.output-field-lab4 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #lab4-truth-table input.output-field-lab4:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab4-truth-table input.output-field-lab4.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab4-truth-table input.output-field-lab4.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab4-truth-table input.output-field-lab4.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        
        /* Lab 8 Truth Table Styles */
        #lab8-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab8-truth-table th, #lab8-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab8-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab8-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab8-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #lab8-truth-table input.output-field-lab8-f1,
        #lab8-truth-table input.output-field-lab8-f2,
        #lab8-truth-table input.output-field-lab8-f3 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #lab8-truth-table input.output-field-lab8-f1:focus,
        #lab8-truth-table input.output-field-lab8-f2:focus,
        #lab8-truth-table input.output-field-lab8-f3:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab8-truth-table input.output-field-lab8-f1.correct,
        #lab8-truth-table input.output-field-lab8-f2.correct,
        #lab8-truth-table input.output-field-lab8-f3.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab8-truth-table input.output-field-lab8-f1.incorrect,
        #lab8-truth-table input.output-field-lab8-f2.incorrect,
        #lab8-truth-table input.output-field-lab8-f3.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab8-truth-table input.output-field-lab8-f1.empty,
        #lab8-truth-table input.output-field-lab8-f2.empty,
        #lab8-truth-table input.output-field-lab8-f3.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        
        /* Lab 9 Truth Table Styles */
        #lab9-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab9-truth-table th, #lab9-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab9-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab9-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab9-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #lab9-truth-table input.output-field-lab9 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #lab9-truth-table input.output-field-lab9:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab9-truth-table input.output-field-lab9.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab9-truth-table input.output-field-lab9.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab9-truth-table input.output-field-lab9.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        
        /* MUX Input Field Styles */
        #lab9-truth-table input.mux-input-field-lab9 {
          width: 3em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        
        /* MUX Input Column Cell Separation */
        #lab9-truth-table td:last-child {
          border-left: 1px solid var(--card-border);
          background: transparent;
        }
        
        #lab9-truth-table td:last-child input {
          border: 1.5px solid var(--card-border);
          background: #fff;
        }
        
        /* MUX Input Column Header - Same as other columns */
        #lab9-truth-table th:last-child {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        
        /* MUX Input Column Row Separation - Same as other columns */
        #lab9-truth-table tr:nth-child(even) td:last-child {
          background: rgba(255,255,255,0.03);
        }
        
        #lab9-truth-table tr:nth-child(odd) td:last-child {
          background: rgba(52,152,219,0.04);
        }
        #lab9-truth-table input.mux-input-field-lab9:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab9-truth-table input.mux-input-field-lab9.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab9-truth-table input.mux-input-field-lab9.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab9-truth-table input.mux-input-field-lab9.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        
        /* Lab 5 Truth Table Styles */
        #lab5-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        
        #lab5-truth-table th, #lab5-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        
        #lab5-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        
        #lab5-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab5-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        
        #lab5-truth-table input.output-field-lab5 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        
        #lab5-truth-table input.output-field-lab5:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        
        #lab5-truth-table input.output-field-lab5.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        
        #lab5-truth-table input.output-field-lab5.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        
        #lab5-truth-table input.output-field-lab5.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        
        /* Full Adder Diagram Styles */
        .full-adder-diagram {
          display: flex;
          flex-direction: column;
          gap: 2rem;
          margin: 1.5rem 0;
        }
        
        .diagram-section {
          background: var(--card-bg);
          border: 1px solid var(--card-border);
          border-radius: 12px;
          padding: 1.5rem;
          box-shadow: 0 2px 8px rgba(52,152,219,0.08);
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        
        .diagram-section h5 {
          text-align: center;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
          font-weight: 600;
        }
        
        .image-container {
          text-align: center;
          margin: 1rem 0;
          display: flex;
          justify-content: center;
          align-items: center;
          width: 100%;
        }
        
        .responsive-image {
          max-width: 100%;
          height: auto;
          border-radius: 8px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.15);
          transition: transform 0.2s ease, box-shadow 0.2s ease;
          display: block;
          margin: 0 auto;
          opacity: 1 !important; /* Ensure visibility */
        }
        
        .responsive-image:hover {
          transform: scale(1.02);
          box-shadow: 0 4px 20px rgba(52,152,219,0.25);
        }
        
        .logic-explanation {
          margin-top: 1.5rem;
          padding: 1rem;
          background: var(--secondary-bg);
          border-radius: 8px;
          border: 1px solid var(--border);
          width: 100%;
          text-align: left;
        }
        
        /* 4-bit Parallel Adder Styles */
        .parallel-adder-diagram {
          margin-top: 1.5rem;
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        
        .parallel-adder-summary {
          margin-top: 2rem;
          padding: 1.5rem;
          background: var(--secondary-bg);
          border: 1px solid var(--border);
          border-radius: 10px;
          width: 100%;
          text-align: left;
        }
        

        
        /* Responsive Design for Full Adder Diagrams */
        @media (max-width: 900px) {
          .diagram-section {
            padding: 1rem;
          }
          
          .responsive-image {
            max-width: 95%;
          }
        }
        
        @media (max-width: 600px) {
          .diagram-section {
            padding: 0.8rem;
          }
          
          .responsive-image {
            max-width: 100%;
          }
          
          .logic-explanation {
            padding: 0.8rem;
          }
        }
        
        /* Responsive and accessible truth table styles for Lab 7 */
        #lab7-bcd-truth-table, #lab7-full-adder-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab7-bcd-truth-table th, #lab7-bcd-truth-table td,
        #lab7-full-adder-truth-table th, #lab7-full-adder-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab7-bcd-truth-table th, #lab7-full-adder-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab7-bcd-truth-table tr:nth-child(even), #lab7-full-adder-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab7-bcd-truth-table tr:nth-child(odd), #lab7-full-adder-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        @media (max-width: 700px) {
          .responsive-table {
            display: block;
            overflow-x: auto;
            width: 100%;
            max-width: 100vw;
            margin-left: auto;
            margin-right: auto;
            padding-bottom: 0;
          }
          #lab3-truth-table {
            font-size: 0.95rem;
            min-width: 480px;
          }
          #lab4-truth-table {
            font-size: 0.95rem;
            min-width: 480px;
          }
          #lab5-truth-table {
            font-size: 0.95rem;
            min-width: 480px;
          }
        }
        .table-buttons {
          margin-top: 0.5rem;
          margin-bottom: 1.5rem;
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          justify-content: flex-start;
        }
        .table-buttons .btn {
          font-size: 1rem;
          font-weight: 600;
          border-radius: 8px;
          min-width: 120px;
          box-shadow: 0 2px 8px rgba(52,152,219,0.08);
        }
        .logic-drawing-section {
          margin-bottom: 1.5rem;
        }
        .toolbar {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 0.7rem;
          flex-wrap: wrap;
        }
        .toolbar label {
          display: flex;
          align-items: center;
          gap: 0.3rem;
          font-size: 0.98em;
        }
        .toolbar input[type="color"] {
          width: 28px;
          height: 28px;
          border: none;
          background: none;
        }
        .toolbar input[type="range"] {
          width: 70px;
        }
        .toolbar button {
          min-width: 40px;
        }
        #drawingContainer {
          width: 100%;
          max-width: 800px;
          margin: 0 auto;
          position: relative;
          background: #fff;
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
        }
        #drawingCanvas {
          width: 100%;
          height: auto;
          max-width: 100%;
          border-radius: 10px;
          display: block;
          background: #fff;
          touch-action: none;
        }
        .tool-toggle {
          background-color: #f0f0f0;
          border: none;
          border-radius: 999px;
          padding: 0.5rem 1rem;
          cursor: pointer;
          position: relative;
          transition: background-color 0.3s ease, box-shadow 0.3s ease;
          box-shadow: 0 0 0 transparent;
          outline: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .tool-toggle:focus,
        .tool-toggle:hover {
          box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
          background-color: #e3eaf2;
        }
        .tool-toggle .icon {
          display: inline-block;
          font-size: 1.25rem;
          transition: transform 0.4s cubic-bezier(.4,0,.2,1), opacity 0.3s cubic-bezier(.4,0,.2,1);
        }
        .tool-toggle.eraser .icon {
          transform: rotateY(180deg) scale(1.2);
        }
        .tool-toggle.pen .icon {
          transform: rotateY(0deg) scale(1);
        }
        .tool-toggle.eraser {
          background-color: #fffbe7;
          box-shadow: 0 0 8px #ffe08288;
        }
        .drawing-wrapper {
          overflow: auto;
          max-width: 100%;
          border: 1px solid #ccc;
          padding: 1rem;
          text-align: center;
          background: #fff;
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
        }
        .canvas-controls {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 0.7rem;
          flex-wrap: wrap;
        }
        .canvas-controls button {
          background: var(--secondary);
          color: #fff;
          border: none;
          border-radius: 6px;
          font-size: 1.2rem;
          padding: 0.3rem 0.8rem;
          cursor: pointer;
          transition: background 0.2s, box-shadow 0.2s;
        }
        .canvas-controls button:focus,
        .canvas-controls button:hover {
          background: #1976d2;
          box-shadow: 0 0 8px #1976d2aa;
        }
        .canvas-controls label {
          font-size: 1rem;
          color: var(--secondary);
        }
        .canvas-controls select {
          font-size: 1rem;
          border-radius: 6px;
          padding: 0.2rem 0.7rem;
          border: 1.5px solid var(--card-border);
        }
        .zoom-level {
          font-size: 0.98rem;
          color: var(--gray);
          min-width: 70px;
        }
        .drawing-wrapper canvas {
          transition: transform 0.3s cubic-bezier(.4,0,.2,1);
          transform-origin: top left;
          background: #fff;
          border-radius: 10px;
          display: block;
          margin: 0 auto;
        }
        .toolbar .zoom-btn {
          background: linear-gradient(135deg, var(--secondary) 60%, #64b5f6 100%);
          color: var(--light);
          border: none;
          border-radius: 50%;
          width: 38px;
          height: 38px;
          font-size: 1.35rem;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 8px rgba(52,152,219,0.10);
          cursor: pointer;
          transition: background 0.22s, box-shadow 0.22s, transform 0.18s;
          outline: none;
          margin: 0 2px;
        }
        .toolbar .zoom-btn:focus {
          outline: 2.5px solid var(--accent);
          outline-offset: 2px;
          box-shadow: 0 0 0 4px #e74c3c33;
        }
        .toolbar .zoom-btn:hover {
          background: linear-gradient(135deg, #64b5f6 60%, var(--secondary) 100%);
          color: var(--light);
          box-shadow: 0 4px 18px #1976d2aa, 0 2px 8px #3498db44;
          transform: scale(1.13);
        }
        .toolbar .zoom-slider {
          width: 140px;
          margin: 0 12px;
          accent-color: var(--secondary);
          background: transparent;
          height: 6px;
          border-radius: 8px;
          outline: none;
          position: relative;
          transition: box-shadow 0.2s;
          --slider-bg: linear-gradient(90deg, #3498db 0%, #64b5f6 100%);
          --slider-bg-light: linear-gradient(90deg, #1976d2 0%, #bbdefb 100%);
        }
        .toolbar .zoom-slider:focus {
          box-shadow: 0 0 0 4px #3498db33;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-webkit-slider-thumb,
        .toolbar .zoom-slider:hover::-webkit-slider-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider::-webkit-slider-runnable-track {
          height: 6px;
          border-radius: 8px;
          background: var(--slider-bg);
          box-shadow: 0 1px 4px #3498db22, 0 1px 8px #fff inset;
        }
        .toolbar .zoom-slider::-ms-fill-lower {
          background: #3498db;
        }
        .toolbar .zoom-slider::-ms-fill-upper {
          background: #64b5f6;
        }
        .toolbar .zoom-slider::-moz-range-thumb {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-moz-range-thumb,
        .toolbar .zoom-slider:hover::-moz-range-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider::-moz-range-track {
          height: 6px;
          border-radius: 8px;
          background: var(--slider-bg);
          box-shadow: 0 1px 4px #3498db22, 0 1px 8px #fff inset;
        }
        .toolbar .zoom-slider::-ms-thumb {
          width: 24px;
          height: 24px;
          border-radius: 50%;
          background: linear-gradient(145deg, #fff 60%, #e3eaf2 100%);
          border: 2.5px solid var(--secondary);
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
          cursor: pointer;
          transition: border 0.2s, box-shadow 0.2s, background 0.2s;
          position: relative;
          z-index: 2;
        }
        .toolbar .zoom-slider:active::-ms-thumb,
        .toolbar .zoom-slider:hover::-ms-thumb {
          border: 2.5px solid #1976d2;
          background: linear-gradient(145deg, #e3eaf2 60%, #fff 100%);
        }
        .toolbar .zoom-slider:focus::-webkit-slider-thumb {
          outline: 2px solid #3498db;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb:focus {
          outline: 2px solid #3498db;
        }
        .toolbar .zoom-slider::-moz-focus-outer {
          border: 0;
        }
        .toolbar .zoom-slider::-ms-tooltip {
          display: none;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb::after {
          display: none;
        }
        .toolbar .zoom-slider::-webkit-slider-container {
          background: transparent;
        }
        .toolbar .zoom-slider::-webkit-slider-thumb {
          box-shadow: 0 4px 16px #3498db33, 0 1.5px 8px #64b5f655, 0 0 0 2px #fff inset;
        }
        body.light-mode .toolbar .zoom-slider::-webkit-slider-runnable-track,
        body.light-mode .toolbar .zoom-slider::-moz-range-track {
          background: var(--slider-bg-light);
        }
        @media (max-width: 700px) {
          .toolbar .zoom-slider {
            width: 90px;
          }
        }
        .toolbar-scroll-x {
          width: 100%;
          overflow-x: auto;
          overflow-y: visible;
          padding-bottom: 0;
          margin-bottom: 0.2rem;
          /* Show scrollbar above the toolbar */
          box-sizing: border-box;
          position: relative;
          /* Place a fake scrollbar above */
          /* Use a negative margin to pull up the scrollbar visually */
          margin-top: 0;
          scrollbar-width: thin;
          scrollbar-color: var(--secondary) #e3eaf2;
        }
        .toolbar-scroll-x::-webkit-scrollbar {
          height: 10px;
        }
        .toolbar-scroll-x::-webkit-scrollbar-thumb {
          background: var(--secondary);
          border-radius: 6px;
        }
        .toolbar-scroll-x::-webkit-scrollbar-track {
          background: #e3eaf2;
          border-radius: 6px;
        }
        @media (max-width: 900px) {
          .toolbar-scroll-x {
            margin-bottom: 0.2rem;
          }
        }
        .lab1-bcd-desc {
          color: #fff;
        }
        body.light-mode .lab1-bcd-desc {
          color: #111;
        }
        .lab1-bcd-desc, .lab1-bcd-desc .lab1-bcd-span {
          font-weight: 400 !important;
        }
        .equation-box {
          background:rgba(52,152,219,0.08);
          border-left:4px solid var(--secondary);
          padding:0.9rem 1.2rem;
          margin:1.1rem 0 0.7rem 0;
          border-radius:8px;
          font-size:1.18rem;
          font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
          box-shadow:0 2px 8px rgba(52,152,219,0.07);
          color:#6ec6ff;
          overflow-x:auto;
        }
        body.light-mode .equation-box {
          color: var(--secondary);
        }
        /* Responsive and accessible truth table styles for Lab 3 */
        #lab3-truth-table {
          border-collapse: separate;
          border-spacing: 0;
          background: var(--card-bg);
          border-radius: 10px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin-bottom: 0.5rem;
          width: 100%;
          table-layout: fixed;
          display: table;
        }
        #lab3-truth-table th, #lab3-truth-table td {
          text-align: center;
          padding: 0.6rem 0.7rem;
          font-size: 1.05rem;
          word-break: break-word;
          overflow: hidden;
        }
        #lab3-truth-table th {
          background: var(--secondary);
          color: #fff;
          font-weight: 700;
          border-bottom: 2px solid var(--card-border);
        }
        #lab3-truth-table tr:nth-child(even) {
          background: rgba(255,255,255,0.03);
        }
        #lab3-truth-table tr:nth-child(odd) {
          background: rgba(52,152,219,0.04);
        }
        #lab3-truth-table input.output-field-lab3 {
          width: 2.5em;
          text-align: center;
          border-radius: 6px;
          border: 1.5px solid var(--card-border);
          background: #fff;
          color: #222;
          font-size: 1.08rem;
          font-weight: 600;
          transition: background 0.2s, color 0.2s, border 0.2s;
          outline: none;
          box-shadow: 0 1px 4px rgba(52,152,219,0.07);
        }
        #lab3-truth-table input.output-field-lab3:focus {
          border: 2px solid var(--secondary);
          background: #e3eaf2;
          color: #1976d2;
        }
        #lab3-truth-table input.output-field-lab3.correct {
          border: 2px solid #27ae60;
          background: #d4edda;
          color: #155724;
        }
        #lab3-truth-table input.output-field-lab3.incorrect {
          border: 2px solid #e74c3c;
          background: #f8d7da;
          color: #721c24;
        }
        #lab3-truth-table input.output-field-lab3.empty {
          border: 2px solid #3498db;
          background: #cce5ff;
          color: #222;
        }
        .responsive-table {
          width: 100%;
          max-width: 100vw;
          overflow-x: auto;
          margin-left: auto;
          margin-right: auto;
          padding-bottom: 0;
          box-sizing: border-box;
          display: block;
        }
        @media (max-width: 700px) {
          #lab3-truth-table {
            font-size: 0.95rem;
            min-width: 340px;
          }
        }
        .circuit-border {
          border: 3px solid var(--secondary);
          border-radius: 8px;
          box-shadow: 0 0 0 3px #fff2 inset, 0 2px 12px rgba(52,152,219,0.10);
          background: linear-gradient(90deg, rgba(52,152,219,0.10) 0%, rgba(52,152,219,0.04) 100%);
          position: relative;
        }
        body.light-mode .circuit-border {
          border: 3px solid var(--secondary);
          box-shadow: 0 0 0 3px #e3eaf2 inset, 0 2px 12px #bbdefb44;
          background: linear-gradient(90deg, #e3eaf2 0%, #f5f7fa 100%);
        }
        .input-container > .input-switch + .input-label {
          margin-top: 0.25rem;
        }
        .boolean-sim-module {
          background: var(--card-bg);
          border-radius: 10px;
          padding: 1rem;
          margin: 1rem 0;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          border: 1px solid var(--card-border);
        }
        .boolean-sim-desc {
          font-size: 1.05rem;
          color: var(--text);
          margin-bottom: 1rem;
        }
        
        /* Light mode specific styling for boolean simulator */
        body.light-mode .boolean-sim-module {
          background: #ffffff;
          border: 1px solid var(--card-border);
        }
        body.light-mode .boolean-sim-desc {
          color: #333;
        }
        .boolean-sim-flex {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 1.2rem;
          justify-content: center;
        }
        .boolean-sim-equation {
          width: 100%;
          display: flex;
          justify-content: center;
          margin-bottom: 0.5rem;
        }

        .boolean-sim-inputs .input-switch-block {
          margin-bottom: 0;
        }
        
        /* Optimized spacing for control button labels */
        .input-switch-block .input-label {
          margin-top: 0.4rem;
          font-size: 0.8rem;
          color: var(--light);
          text-align: center;
          line-height: 1.2;
        }
        
        /* Enhanced Row-Based Layout for Simulator Inputs */
        .boolean-sim-inputs {
          display: flex;
          flex-direction: column !important;
          gap: 1.5rem;
          justify-content: center;
          align-items: center;
          width: 100%;
          padding: 1rem;
          background: rgba(255, 255, 255, 0.02);
          border-radius: 12px;
          border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Clock Row Styling */
        .clock-row {
          margin-bottom: 1rem;
          width: 100%;
          display: flex;
          justify-content: center;
        }
        
        .clock-row .clock-indicator {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          transition: all 0.3s ease;
          background: linear-gradient(145deg, var(--bg-secondary), var(--bg-primary));
          border: 1px solid var(--border);
          position: relative;
          overflow: hidden;
        }
        
        .clock-row .clock-indicator::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
          transition: left 0.5s ease;
        }
        
        .clock-row .clock-indicator:hover::before {
          left: 100%;
        }
        
        .clock-row .clock-indicator:hover {
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          transform: translateY(-1px);
        }
        
        /* Control Buttons Row Styling */
        .control-row {
          margin-bottom: 1rem;
          width: 100%;
          display: flex;
          justify-content: center;
        }
        
        .control-buttons-container {
          display: flex;
          gap: 2rem;
          justify-content: center;
          align-items: center;
          flex-wrap: wrap;
          padding: 0.5rem;
        }
        
        /* Input Row Styling */
        .input-row {
          margin-bottom: 0;
          width: 100%;
          display: flex;
          justify-content: center;
        }
        
        /* Single input button styling for D Flip Flop */
        .input-row .input-buttons-group {
          margin: 0;
          min-width: 100px;
        }
        
        .input-buttons-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
          margin: 0 1rem;
          min-width: 80px;
        }
        
        /* Horizontal LED Output Layout */
        .led-outputs-container {
          display: flex;
          flex-direction: row;
          gap: 2rem;
          justify-content: center;
          align-items: center;
          flex-wrap: wrap;
          width: 100%;
        }
        
        .led-output-group {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
          min-width: 100px;
        }
        
        .led-output-group .led-output {
          margin: 0;
        }
        
        .led-output-group .input-label {
          margin-top: 0.3rem;
          text-align: center;
          font-size: 0.8rem;
          color: var(--light);
          transition: color 0.2s ease;
        }
        
        .led-output-group:hover .input-label {
          color: var(--text);
        }
        
        /* Enhanced LED output styling */
        .led-output-group .led-output {
          transition: all 0.2s ease;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .led-output-group .led-output:hover {
          transform: scale(1.05);
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        /* Responsive adjustments for row-based layout */
        @media (max-width: 768px) {
          .boolean-sim-inputs {
            gap: 1.2rem;
          }
          
          .control-buttons-container {
            gap: 1.2rem;
          }
          
          .input-buttons-group {
            margin: 0 0.3rem;
          }
        }
        
        @media (max-width: 480px) {
          .boolean-sim-inputs {
            gap: 1rem;
          }
          
          .control-buttons-container {
            gap: 1rem;
          }
          
          .input-buttons-group {
            margin: 0 0.2rem;
          }
          
          .led-outputs-container {
            gap: 1.5rem;
          }
          
          .led-output-group {
            min-width: 80px;
          }
          
          /* Mobile select element optimization */
          select {
            font-size: 0.85rem;
            padding: 0.4rem;
            min-width: 100px;
          }
          
          .clock-control-panel select {
            min-width: 100px;
          }
        }
        .boolean-sim-output {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 0.5rem;
          width: 100%;
        }
        
        /* Enhanced Select Element Styling for Dark/Light Mode Compatibility */
        select {
          background: var(--bg-primary) !important;
          color: var(--text) !important;
          border: 1px solid var(--border) !important;
          border-radius: 5px;
          padding: 0.5rem;
          font-size: 0.9rem;
          transition: all 0.2s ease;
          cursor: pointer;
        }
        
        select:hover {
          border-color: var(--secondary);
          box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        select:focus {
          outline: none;
          border-color: var(--secondary);
          box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }
        
        /* Dropdown option styling for better visibility */
        select option {
          background: var(--bg-primary);
          color: var(--text);
          padding: 0.5rem;
          border: none;
        }
        
        select option:hover {
          background: var(--secondary);
          color: white;
        }
        
        /* Enhanced clock control panel styling */
        .clock-control-panel select {
          min-width: 120px;
          font-weight: 500;
        }
        
        /* Boolean Expression Simulator Input Layout - Horizontal for Labs 3, 4, 5, 6 */
        .boolean-expr-sim .boolean-sim-inputs {
          display: flex !important;
          flex-direction: row !important;
          gap: 2rem !important;
          align-items: center !important;
          justify-content: center !important;
          width: 100% !important;
          flex-wrap: wrap !important;
          padding: 1rem !important;
        }
        
        /* Individual input switch blocks in Boolean Expression Simulators */
        .boolean-expr-sim .boolean-sim-inputs .input-switch-block {
          margin: 0 !important;
          min-width: 80px !important;
          display: flex !important;
          flex-direction: column !important;
          align-items: center !important;
          gap: 0.5rem !important;
        }
        
        /* Responsive adjustments for Boolean Expression Simulators */
        @media (max-width: 900px) {
          .boolean-expr-sim .boolean-sim-inputs {
            gap: 1.5rem !important;
          }
        }
        
        @media (max-width: 700px) {
          .boolean-expr-sim .boolean-sim-inputs {
            gap: 1rem !important;
            flex-wrap: wrap !important;
          }
          
          .boolean-expr-sim .boolean-sim-inputs .input-switch-block {
            min-width: 70px !important;
          }
        }
        
        @media (max-width: 480px) {
          .boolean-expr-sim .boolean-sim-inputs {
            gap: 0.8rem !important;
          }
          
          .boolean-expr-sim .boolean-sim-inputs .input-switch-block {
            min-width: 60px !important;
          }
        }
        
        /* Additional select enhancements for better accessibility */
        .clock-control-panel select:focus-visible {
          outline: 2px solid var(--secondary);
          outline-offset: 2px;
        }
        
        /* Ensure dropdown arrow is visible */
        .clock-control-panel select {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
          background-position: right 0.5rem center;
          background-repeat: no-repeat;
          background-size: 1.5em 1.5em;
          padding-right: 2.5rem;
        }
        
        /* Dark mode dropdown arrow */
        body:not(.light-mode) .clock-control-panel select {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23ecf0f1' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        }
        @media (max-width: 900px) {
          .boolean-sim-flex {
            flex-direction: column;
            gap: 1.2rem;
            align-items: stretch;
          }
          .boolean-sim-module {
            padding: 0.7rem 0.3rem;
          }
        }
        @media (max-width: 700px) {
          .boolean-sim-flex {
            flex-direction: column;
            gap: 1.2rem;
            align-items: stretch;
          }
          .boolean-sim-inputs {
            flex-direction: column !important;
            gap: 1rem;
            justify-content: center;
            align-items: center;
          }
          .boolean-sim-inputs .input-switch-block {
            margin-bottom: 0;
          }
          .boolean-sim-module {
            padding: 0.5rem 0.1rem;
          }
          .boolean-sim-output {
            margin-top: 0.5rem;
          }
        }
        @media (max-width: 480px) {
          .boolean-sim-flex {
            gap: 0.7rem;
          }
          .boolean-sim-desc {
            font-size: 0.98rem;
          }
          .equation-inline {
            font-size: 1em;
            padding: 0.08em 0.3em;
          }
          .boolean-sim-inputs {
            gap: 0.6rem;
          }
        }
        .ic-table-grid {
          display: grid;
          grid-template-columns: 1fr 2.5fr 0.8fr;
          width: 100%;
          max-width: 100%;
          background: rgba(40, 50, 60, 0.7);
          border-radius: 8px;
          box-shadow: 0 2px 12px rgba(52,152,219,0.10);
          margin: 1.5rem 0;
          overflow: hidden;
          border: 1px solid rgba(52, 152, 219, 0.2);
        }
        .ic-table-row {
          display: contents;
        }
        .ic-table-header .ic-table-cell {
          background: rgba(52, 152, 219, 0.7);
          color: #fff;
          font-weight: 700;
          padding: 12px 15px;
          text-align: left;
          font-size: 1.08rem;
          border-bottom: 2px solid rgba(52, 152, 219, 0.3);
        }
        .ic-table-cell {
          padding: 12px 15px;
          font-size: 1.05rem;
          color: #ecf0f1;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
          background: none;
          text-align: left;
          word-break: break-word;
        }
        .ic-table-row:last-of-type .ic-table-cell {
          border-bottom: none;
        }
        @media (max-width: 900px) {
          .ic-table-grid {
            grid-template-columns: 1fr 2fr 0.8fr;
            font-size: 0.98rem;
          }
        }
        @media (max-width: 600px) {
          .ic-table-grid {
            grid-template-columns: 1fr 1.5fr 0.7fr;
            font-size: 0.95rem;
          }
          .ic-table-header .ic-table-cell {
            font-size: 1rem;
            padding: 10px 8px;
          }
          .ic-table-cell {
            font-size: 0.95rem;
            padding: 10px 8px;
          }
        }
        /* === Custom spacing for Pre-lab questions and toolbar (Lab 2 & 3) === */
        /* Add margin between pre-lab questions */
        #lab2 #question2-text,
        #lab2 #question3-text,
        #lab3 #question4-text {
            margin-top: 2.2rem;
            margin-bottom: 1.2rem;
            display: block;
        }
        /* Add extra space above and below the toolbar for drawing canvas */
        #lab2 .toolbar,
        #lab3 .toolbar {
            margin-top: 0.7rem !important;
            margin-bottom: 1.2rem !important;
        }
        /* Optional: Add a little more space to the toolbar container for hover effect */
        #lab2 .toolbar-scroll-x,
        #lab3 .toolbar-scroll-x {
            padding-top: 0.4rem;
            padding-bottom: 0.4rem;
        }
        /* Responsive, always-rounded Lab 3 Pre-lab activity truth table */
        .responsive-table {
            width: 100%;
            max-width: 100vw;
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(52,152,219,0.10);
            background: transparent;
            margin-bottom: 1.2rem;
            /* Hide scrollbars on desktop, show on mobile */
            scrollbar-width: thin;
            scrollbar-color: var(--secondary) #e3eaf2;
        }
        .responsive-table::-webkit-scrollbar {
            height: 10px;
        }
        .responsive-table::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 6px;
        }
        .responsive-table::-webkit-scrollbar-track {
            background: #e3eaf2;
            border-radius: 6px;
        }
        #lab3-truth-table {
            border-radius: 12px;
            overflow: hidden;
            min-width: 480px;
            background: var(--card-bg);
            box-shadow: none;
            margin-bottom: 0;
        }
        #lab3-truth-table th:first-child {
            border-top-left-radius: 12px;
        }
        #lab3-truth-table th:last-child {
            border-top-right-radius: 12px;
        }
        #lab3-truth-table tr:last-child td:first-child {
            border-bottom-left-radius: 12px;
        }
        #lab3-truth-table tr:last-child td:last-child {
            border-bottom-right-radius: 12px;
        }
        @media (max-width: 700px) {
            .responsive-table {
                border-radius: 12px;
                overflow-x: auto;
                box-shadow: 0 2px 12px rgba(52,152,219,0.10);
            }
            #lab3-truth-table {
                min-width: 480px;
                border-radius: 12px;
            }
        }
        /* Responsive, always-rounded Lab 2 Pre-lab activity truth table */
        #interactive-truth-table {
            border-radius: 12px;
            overflow: hidden;
            min-width: 480px;
            background: var(--card-bg);
            box-shadow: none;
            margin-bottom: 0;
        }
        #interactive-truth-table th:first-child {
            border-top-left-radius: 12px;
        }
        #interactive-truth-table th:last-child {
            border-top-right-radius: 12px;
        }
        #interactive-truth-table tr:last-child td:first-child {
            border-bottom-left-radius: 12px;
        }
        #interactive-truth-table tr:last-child td:last-child {
            border-bottom-right-radius: 12px;
        }
        .responsive-table {
            width: 100%;
            max-width: 100vw;
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(52,152,219,0.10);
            background: transparent;
            margin-bottom: 1.2rem;
            scrollbar-width: thin;
            scrollbar-color: var(--secondary) #e3eaf2;
        }
        .responsive-table::-webkit-scrollbar {
            height: 10px;
        }
        .responsive-table::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 6px;
        }
        .responsive-table::-webkit-scrollbar-track {
            background: #e3eaf2;
            border-radius: 6px;
        }
        @media (max-width: 700px) {
            .responsive-table {
                border-radius: 12px;
                overflow-x: auto;
                box-shadow: 0 2px 12px rgba(52,152,219,0.10);
            }
            #interactive-truth-table {
                min-width: 480px;
                border-radius: 12px;
            }
        }        
        
        /* K-Map Navigation Visual Feedback for Lab 6 Function H */
        #k-map-lab6-function-h .k-map-input.navigating {
            background-color: var(--accent) !important;
            color: white !important;
            transform: scale(1.05);
            transition: all 0.15s ease;
        }
        
        #k-map-lab6-function-h .k-map-input.navigated-to {
            background-color: var(--accent) !important;
            color: white !important;
            box-shadow: 0 0 10px var(--accent);
            transform: scale(1.02);
            transition: all 0.3s ease;
        }
        
        #k-map-lab6-function-h .k-map-input:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        #k-map-lab6-function-h .k-map-input {
            transition: all 0.2s ease;
        }
        
        /* Lab 11 Counter Simulator Styles */
        .counter-display {
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 16px rgba(52, 152, 219, 0.1);
        }
        
        .counter-display span {
            font-size: 3rem;
            font-weight: bold;
            color: var(--accent-color);
            display: block;
            margin-top: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .counter-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .counter-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
        }
        
        .counter-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(52, 152, 219, 0.3);
        }
        
        .counter-btn:active,
        .counter-btn.btn-pressed {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(52, 152, 219, 0.2);
        }
        
        .counter-btn:focus {
            outline: 2px solid var(--accent-color);
            outline-offset: 2px;
        }
        
        .counter-update {
            animation: counterPulse 0.3s ease-in-out;
        }
        
        @keyframes counterPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .input-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-style: italic;
        }
        
        /* Image Optimization and Lazy Loading */
        .optimized-image {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            width: 100%;
            height: auto;
            max-width: 100%;
        }
        
        .optimized-image.loaded {
            opacity: 1;
        }
        
        .image-placeholder {
            background: linear-gradient(90deg, var(--bg-secondary) 25%, var(--border) 50%, var(--bg-secondary) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Responsive image sizes */
        @media (max-width: 768px) {
            .responsive-image {
                max-width: 100%;
                height: auto;
            }
        }
        
        @media (max-width: 480px) {
            .responsive-image {
                max-width: 100%;
                height: auto;
            }
        }
        
        /* Enhanced Tooltip Styles for Flip Flop Simulators */
        .tooltip-trigger {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 50%;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            min-height: 24px;
        }
        
        .tooltip-trigger:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: scale(1.1);
        }
        
        .tooltip-trigger:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
        
        .enhanced-tooltip {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-primary);
            border: 2px solid var(--accent);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.25);
            max-width: 480px;
            width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 1000;
            animation: tooltipFadeIn 0.3s ease-out;
        }
        
        @keyframes tooltipFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .tooltip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem 0.5rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }
        
        .tooltip-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.2rem;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .tooltip-close:hover {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            transform: scale(1.1);
        }
        
        .tooltip-close:focus {
            outline: 2px solid #e74c3c;
            outline-offset: 2px;
        }
        
        .tooltip-content {
            padding: 1rem 1.5rem 1.5rem 1.5rem;
            line-height: 1.6;
        }
        
        .tooltip-content h6 {
            margin: 0 0 0.5rem 0;
            font-weight: 600;
        }
        
        .tooltip-content ul {
            margin: 0.5rem 0;
        }
        
        .tooltip-content li {
            margin-bottom: 0.3rem;
        }
        
        .tooltip-content p {
            margin: 0 0 0.8rem 0;
        }
        
        /* Responsive Design for Tooltips */
        @media (max-width: 700px) {
            .enhanced-tooltip {
                width: 95vw;
                max-height: 85vh;
            }
            
            .tooltip-header,
            .tooltip-content {
                padding: 0.8rem 1rem;
            }
            
            .tooltip-content h6 {
                font-size: 0.9rem;
            }
            
            .tooltip-content ul {
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 480px) {
            .enhanced-tooltip {
                width: 98vw;
                max-height: 90vh;
            }
            
            .tooltip-header,
            .tooltip-content {
                padding: 0.6rem 0.8rem;
            }
            
            .tooltip-content h6 {
                font-size: 0.85rem;
            }
            
            .tooltip-content ul {
                font-size: 0.8rem;
            }
        }
        
        /* Dark/Light Mode Adaptations */
        body.light-mode .enhanced-tooltip {
            background: var(--bg-primary);
            border-color: var(--accent);
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.15);
        }
        
        body.light-mode .tooltip-close:hover {
            background: rgba(231, 76, 60, 0.08);
        }
        
        /* Enhanced Truth Table Styles */
        .enhanced-truth-table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
            text-align: center;
            background: var(--bg-primary);
            border-radius: 6px;
            overflow: hidden;
        }
        
        /* Responsive Counter Simulator Styles */
        @media (max-width: 768px) {
            .counter-switch-row {
                gap: 1rem !important;
            }
            
            .counter-switch-block {
                min-width: 70px !important;
            }
            
            .counter-led-container {
                gap: 1rem !important;
            }
            
            .counter-led-display {
                min-width: 80px !important;
            }
            
            .jk-debug-row {
                flex-direction: column;
                gap: 1rem;
            }
            
            .jk-debug-block {
                min-width: 100%;
            }
            
            .counter-seg-container svg {
                width: 70px;
                height: 120px;
            }
        }
        
        @media (max-width: 480px) {
            .counter-switch-row {
                gap: 0.5rem !important;
            }
            
            .counter-switch-block {
                min-width: 60px !important;
            }
            
            .counter-led-container {
                gap: 0.5rem !important;
            }
            
            .counter-led-display {
                min-width: 70px !important;
            }
            
            .counter-seg-container svg {
                width: 60px;
                height: 100px;
            }
        }
        
        .enhanced-truth-table thead {
            background: var(--accent);
            color: white;
        }
        
        .enhanced-truth-table th {
            padding: 0.6rem 0.4rem;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.8rem;
        }
        
        .enhanced-truth-table td {
            padding: 0.5rem 0.4rem;
            border: 1px solid var(--border);
            background: var(--bg-primary);
            color: var(--text);
            font-weight: 500;
        }
        
        .enhanced-truth-table tbody tr:nth-child(even) {
            background: var(--bg-secondary);
        }
        
        .enhanced-truth-table tbody tr:hover {
            background: rgba(52, 152, 219, 0.1);
            transition: background 0.2s ease;
        }
        
        .truth-table-container {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
        }
        
        /* Responsive Truth Table Design */
        @media (max-width: 700px) {
            .enhanced-truth-table {
                font-size: 0.75rem;
            }
            
            .enhanced-truth-table th,
            .enhanced-truth-table td {
                padding: 0.4rem 0.3rem;
            }
            
            .truth-table-container {
                padding: 0.6rem;
            }
        }
        
        @media (max-width: 480px) {
            .enhanced-truth-table {
                font-size: 0.7rem;
            }
            
            .enhanced-truth-table th,
            .enhanced-truth-table td {
                padding: 0.3rem 0.2rem;
            }
            
            .truth-table-container {
                padding: 0.5rem;
            }
        }
        
        /* Dark/Light Mode Adaptations for Truth Tables */
        body.light-mode .enhanced-truth-table thead {
            background: var(--accent);
            color: white;
        }
        
        body.light-mode .enhanced-truth-table td {
            background: var(--bg-primary);
            border-color: var(--border);
            color: var(--text);
        }
        
        body.light-mode .enhanced-truth-table tbody tr:nth-child(even) {
            background: var(--bg-secondary);
        }
        
        body.light-mode .truth-table-container {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-color: var(--border);
        }
        
        /* Control Row Toggle Switch Styling */
        .control-row .control-buttons-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            min-width: 80px;
        }
        
        .control-row .input-switch {
            margin-bottom: 0.3rem;
        }
        
        .control-row .input-label {
            font-size: 0.8rem;
            text-align: center;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        /* Responsive adjustments for control row */
        @media (max-width: 700px) {
            .control-row .control-buttons-container {
                min-width: 70px;
            }
            
            .control-row .input-label {
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 480px) {
            .control-row .control-buttons-container {
                min-width: 65px;
            }
            
            .control-row .input-label {
                font-size: 0.7rem;
            }
        }
        
        /* Simulator Navigation Styles */
        .simulator-navigation {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .simulator-nav-btn {
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .simulator-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        .simulator-nav-btn.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .simulator-nav-btn i {
            margin-right: 0.5rem;
        }
        
        /* Responsive Navigation */
        @media (max-width: 700px) {
            .nav-buttons-container {
                gap: 0.8rem !important;
            }
            
            .simulator-nav-btn {
                padding: 0.7rem 1.2rem !important;
                min-width: 140px !important;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .nav-buttons-container {
                gap: 0.6rem !important;
                flex-direction: column;
                align-items: center;
            }
            
            .simulator-nav-btn {
                padding: 0.6rem 1rem !important;
                min-width: 200px !important;
                font-size: 0.85rem;
            }
        }
        
        /* Dark/Light Mode Adaptations for Navigation */
        body.light-mode .simulator-navigation {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        body.light-mode .simulator-nav-btn.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.15);
        }
        
        /* Flip Flop Simulator Horizontal Layout */
        .boolean-sim-module .simulator {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            align-items: center;
            text-align: center;
        }
        
        /* Lab 11 Counter Truth Table Styles */
        #lab11-counter-truth-table {
            border-collapse: separate;
            border-spacing: 0;
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(52,152,219,0.10);
            margin-bottom: 0.5rem;
            width: 100%;
            table-layout: fixed;
            display: table;
            overflow: hidden; /* Ensure rounded corners work properly */
        }
        
        #lab11-counter-truth-table th, #lab11-counter-truth-table td {
            text-align: center;
            padding: 0.6rem 0.7rem;
            font-size: 1.05rem;
            word-break: break-word;
            overflow: hidden;
            white-space: nowrap; /* Prevent text wrapping in cells */
        }
        
        #lab11-counter-truth-table th {
            background: var(--secondary);
            color: #fff;
            font-weight: 700;
            border-bottom: 2px solid var(--card-border);
        }
        
        #lab11-counter-truth-table tr:nth-child(even) {
            background: rgba(255,255,255,0.03);
        }
        
        #lab11-counter-truth-table tr:nth-child(odd) {
            background: rgba(52,152,219,0.04);
        }
        
        #lab11-counter-truth-table .output-field-lab11 {
            width: 2.5em;
            text-align: center;
            border-radius: 6px;
            border: 1.5px solid var(--card-border);
            background: #fff;
            color: #222;
            font-size: 1.08rem;
            font-weight: 600;
            transition: background 0.2s, color 0.2s, border 0.2s, transform 0.2s;
            outline: none;
            box-shadow: 0 1px 4px rgba(52,152,219,0.07);
            min-width: 2.5em; /* Ensure minimum width for readability */
            max-width: 3em; /* Prevent excessive width on large screens */
            cursor: text; /* Ensure proper cursor on all devices */
        }
        
        #lab11-counter-truth-table .output-field-lab11:focus {
            border: 2px solid var(--secondary);
            background: #e3eaf2;
            color: #1976d2;
            transform: scale(1.02); /* Subtle focus enhancement */
            transition: all 0.2s ease;
        }
        
        #lab11-counter-truth-table .output-field-lab11.correct {
            border: 2px solid #27ae60;
            background: #d4edda;
            color: #155724;
        }
        
        #lab11-counter-truth-table .output-field-lab11.incorrect {
            border: 2px solid #e74c3c;
            background: #f8d7da;
            color: #721c24;
        }
        
        #lab11-counter-truth-table .output-field-lab11.empty {
            border: 2px solid #3498db;
            background: #cce5ff;
            color: #222;
        }
        
        .boolean-sim-module .input-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }
        
        .boolean-sim-module .output-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }
        
        /* Responsive Flip Flop Layout */
        @media (max-width: 900px) {
            .boolean-sim-module .simulator {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .boolean-sim-module .input-container,
            .boolean-sim-module .output-container {
                gap: 1rem;
            }
        }
        
        @media (max-width: 600px) {
            .boolean-sim-module .simulator {
                gap: 1rem;
            }
            
            .boolean-sim-module .input-container,
            .boolean-sim-module .output-container {
                gap: 0.8rem;
            }
        }
        
        /* Lab 11 Truth Table Responsive Styles */
        @media (max-width: 900px) {
            #lab11-counter-truth-table {
                font-size: 0.9rem;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.5rem 0.6rem;
                font-size: 0.9rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 2.2em;
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 700px) {
            #lab11-counter-truth-table {
                font-size: 0.85rem;
                overflow-x: auto;
                display: block;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.4rem 0.5rem;
                font-size: 0.85rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 2em;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 600px) {
            #lab11-counter-truth-table {
                font-size: 0.8rem;
                border-radius: 8px;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.3rem 0.4rem;
                font-size: 0.8rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1.8em;
                font-size: 0.85rem;
                border-radius: 4px;
            }
        }
        
        @media (max-width: 480px) {
            #lab11-counter-truth-table {
                font-size: 0.75rem;
                margin-bottom: 0.3rem;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.25rem 0.3rem;
                font-size: 0.75rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1.6em;
                font-size: 0.8rem;
                border-radius: 3px;
            }
        }
        
        @media (max-width: 400px) {
            #lab11-counter-truth-table {
                font-size: 0.7rem;
                border-radius: 6px;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.2rem 0.25rem;
                font-size: 0.7rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1.4em;
                font-size: 0.75rem;
                border-radius: 2px;
                border-width: 1px;
            }
        }
        
        @media (max-width: 360px) {
            #lab11-counter-truth-table {
                font-size: 0.65rem;
                border-radius: 4px;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.15rem 0.2rem;
                font-size: 0.65rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1.2em;
                font-size: 0.7rem;
                border-radius: 2px;
                border-width: 1px;
            }
        }
        
        /* Enhanced responsive behavior for very small screens */
        @media (max-width: 320px) {
            #lab11-counter-truth-table {
                font-size: 0.6rem;
                border-radius: 3px;
                min-width: 280px; /* Ensure minimum readable width */
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.1rem 0.15rem;
                font-size: 0.6rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1em;
                font-size: 0.65rem;
                border-radius: 2px;
                border-width: 1px;
            }
        }
        
        /* Ensure table remains readable on all devices */
        @media (max-width: 480px) {
            .responsive-table {
                border-radius: 8px;
                box-shadow: 0 1px 6px rgba(52,152,219,0.08);
            }
            
            /* Optimize table for very small screens */
            #lab11-counter-truth-table {
                min-width: 320px; /* Ensure minimum readable width */
            }
        }
        
        @media (max-width: 360px) {
            .responsive-table {
                border-radius: 6px;
                box-shadow: 0 1px 4px rgba(52,152,219,0.06);
            }
            
            /* Further optimize for extremely small screens */
            #lab11-counter-truth-table {
                min-width: 300px;
            }
        }
        
        /* Landscape orientation optimization for mobile */
        @media (max-width: 700px) and (orientation: landscape) {
            #lab11-counter-truth-table {
                font-size: 0.8rem;
            }
            
            #lab11-counter-truth-table th, 
            #lab11-counter-truth-table td {
                padding: 0.3rem 0.4rem;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                width: 1.8em;
                font-size: 0.8rem;
            }
        }
        
        /* High DPI display optimization */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            #lab11-counter-truth-table {
                border-width: 0.5px;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                border-width: 0.5px;
            }
        }
        
        /* Print optimization */
        @media print {
            #lab11-counter-truth-table {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            #lab11-counter-truth-table .output-field-lab11 {
                border: 1px solid #ccc;
                background: #fff !important;
                color: #000 !important;
            }
        }
        
        /* Lab 11 K-Map Specific Styles */
        #k-map-lab11-ja, #k-map-lab11-ka, #k-map-lab11-jb, 
        #k-map-lab11-kb, #k-map-lab11-jc, #k-map-lab11-kc {
            display: grid;
            grid-template-columns: auto 1fr 1fr 1fr 1fr;
            grid-template-rows: auto 1fr 1fr;
            gap: 2px;
            width: fit-content;
            margin: 1rem auto;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(52,152,219,0.1);
            border: 1px solid var(--border);
        }
        
        /* Enhanced Lab 11 Text Editor Styles */
        #kmap-simplification-editor-lab11-ja:focus,
        #kmap-simplification-editor-lab11-ka:focus,
        #kmap-simplification-editor-lab11-jb:focus,
        #kmap-simplification-editor-lab11-kb:focus,
        #kmap-simplification-editor-lab11-jc:focus,
        #kmap-simplification-editor-lab11-kc:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2), 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        
        /* Enhanced Lab 11 Text Editor Hover Effects */
        #kmap-simplification-editor-lab11-ja:hover,
        #kmap-simplification-editor-lab11-ka:hover,
        #kmap-simplification-editor-lab11-jb:hover,
        #kmap-simplification-editor-lab11-kb:hover,
        #kmap-simplification-editor-lab11-jc:hover,
        #kmap-simplification-editor-lab11-kc:hover {
            border-color: rgba(52, 152, 219, 0.8);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced Lab 11 Toolbar Button Styles */
        #lab11-ja-editor-toolbar .toolbar-btn,
        #lab11-ka-editor-toolbar .toolbar-btn,
        #lab11-jb-editor-toolbar .toolbar-btn,
        #lab11-kb-editor-toolbar .toolbar-btn,
        #lab11-jc-editor-toolbar .toolbar-btn,
        #lab11-kc-editor-toolbar .toolbar-btn {
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
        }
        
        /* Responsive Lab 11 Text Editor Styles */
        @media (max-width: 600px) {
            #kmap-simplification-editor-lab11-ja,
            #kmap-simplification-editor-lab11-ka,
            #kmap-simplification-editor-lab11-jb,
            #kmap-simplification-editor-lab11-kb,
            #kmap-simplification-editor-lab11-jc,
            #kmap-simplification-editor-lab11-kc {
                min-height: 60px;
                padding: 0.8rem;
                font-size: 0.9rem;
            }
            
            #lab11-ja-editor-toolbar,
            #lab11-ka-editor-toolbar,
            #lab11-jb-editor-toolbar,
            #lab11-kb-editor-toolbar,
            #lab11-jc-editor-toolbar,
            #lab11-kc-editor-toolbar {
                gap: 0.4rem;
            }
            
            #lab11-ja-editor-toolbar .toolbar-btn,
            #lab11-ka-editor-toolbar .toolbar-btn,
            #lab11-jb-editor-toolbar .toolbar-btn,
            #lab11-kb-editor-toolbar .toolbar-btn,
            #lab11-jc-editor-toolbar .toolbar-btn,
            #lab11-kc-editor-toolbar .toolbar-btn {
                width: 32px;
                height: 32px;
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 480px) {
            #kmap-simplification-editor-lab11-ja,
            #kmap-simplification-editor-lab11-ka,
            #kmap-simplification-editor-lab11-jb,
            #kmap-simplification-editor-lab11-kb,
            #kmap-simplification-editor-lab11-jc,
            #kmap-simplification-editor-lab11-kc {
                min-height: 50px;
                padding: 0.6rem;
                font-size: 0.8rem;
            }
            
            #lab11-ja-editor-toolbar .toolbar-btn,
            #lab11-ka-editor-toolbar .toolbar-btn,
            #lab11-jb-editor-toolbar .toolbar-btn,
            #lab11-kb-editor-toolbar .toolbar-btn,
            #lab11-jc-editor-toolbar .toolbar-btn,
            #lab11-kc-editor-toolbar .toolbar-btn {
                width: 28px;
                height: 28px;
                font-size: 0.7rem;
            }
        }
        
        #lab11-ja-editor-toolbar .toolbar-btn:hover,
        #lab11-ka-editor-toolbar .toolbar-btn:hover,
        #lab11-jb-editor-toolbar .toolbar-btn:hover,
        #lab11-kb-editor-toolbar .toolbar-btn:hover,
        #lab11-jc-editor-toolbar .toolbar-btn:hover,
        #lab11-kc-editor-toolbar .toolbar-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.15);
        }
        
        #lab11-ja-editor-toolbar .toolbar-btn.active,
        #lab11-ka-editor-toolbar .toolbar-btn.active,
        #lab11-jb-editor-toolbar .toolbar-btn.active,
        #lab11-kb-editor-toolbar .toolbar-btn.active,
        #lab11-jc-editor-toolbar .toolbar-btn.active,
        #lab11-kc-editor-toolbar .toolbar-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
            transform: translateY(-1px);
            transition: all 0.2s ease;
        }
        
        #lab11-ja-editor-toolbar .toolbar-btn.active:hover,
        #lab11-ka-editor-toolbar .toolbar-btn.active:hover,
        #lab11-jb-editor-toolbar .toolbar-btn.active:hover,
        #lab11-kb-editor-toolbar .toolbar-btn.active:hover,
        #lab11-jc-editor-toolbar .toolbar-btn.active:hover,
        #lab11-kc-editor-toolbar .toolbar-btn.active:hover {
            background: var(--secondary-hover, #2980b9);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
            transition: all 0.2s ease;
        }
        
        #k-map-lab11-ja .k-map-cell, #k-map-lab11-ka .k-map-cell, 
        #k-map-lab11-jb .k-map-cell, #k-map-lab11-kb .k-map-cell, 
        #k-map-lab11-jc .k-map-cell, #k-map-lab11-kc .k-map-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 60px;
            min-height: 50px;
            padding: 0.5rem;
            font-weight: 600;
            border-radius: 4px;
        }
        
        #k-map-lab11-ja .k-map-header, #k-map-lab11-ka .k-map-header, 
        #k-map-lab11-jb .k-map-header, #k-map-lab11-kb .k-map-header, 
        #k-map-lab11-jc .k-map-header, #k-map-lab11-kc .k-map-header {
            background: rgba(52, 152, 219, 0.7);
            color: var(--text);
            font-size: 0.9rem;
        }
        

        

        

        

        

        

        
        /* Responsive K-Map Styles */
        @media (max-width: 600px) {
            #k-map-lab11-ja, #k-map-lab11-ka, #k-map-lab11-jb, 
            #k-map-lab11-kb, #k-map-lab11-jc, #k-map-lab11-kc {
                grid-template-columns: auto 1fr 1fr 1fr 1fr;
                gap: 1px;
                padding: 0.5rem;
            }
            
            #k-map-lab11-ja .k-map-cell, #k-map-lab11-ka .k-map-cell, 
            #k-map-lab11-jb .k-map-cell, #k-map-lab11-kb .k-map-cell, 
            #k-map-lab11-jc .k-map-cell, #k-map-lab11-kc .k-map-cell {
                min-width: 50px;
                min-height: 40px;
                padding: 0.3rem;
                font-size: 0.9rem;
            }
            
            #k-map-lab11-ja .k-map-input, #k-map-lab11-ka .k-map-input, 
            #k-map-lab11-jb .k-map-input, #k-map-lab11-kb .k-map-input, 
            #k-map-lab11-jc .k-map-input, #k-map-lab11-kc .k-map-input {
                font-size: 0.9rem;
            }
            

        }
        
        @media (max-width: 480px) {
            #k-map-lab11-ja, #k-map-lab11-ka, #k-map-lab11-jb, 
            #k-map-lab11-kb, #k-map-lab11-jc, #k-map-lab11-kc {
                grid-template-columns: auto 1fr 1fr 1fr 1fr;
                gap: 1px;
                padding: 0.3rem;
            }
            
            #k-map-lab11-ja .k-map-cell, #k-map-lab11-ka .k-map-cell, 
            #k-map-lab11-jb .k-map-cell, #k-map-lab11-kb .k-map-cell, 
            #k-map-lab11-jc .k-map-cell, #k-map-lab11-kc .k-map-cell {
                min-width: 40px;
                min-height: 35px;
                padding: 0.2rem;
                font-size: 0.8rem;
            }
            
            #k-map-lab11-ja .k-map-input, #k-map-lab11-ka .k-map-input, 
            #k-map-lab11-jb .k-map-input, #k-map-lab11-kb .k-map-input, 
            #k-map-lab11-jc .k-map-input, #k-map-lab11-kc .k-map-input {
                font-size: 0.8rem;
            }
            

            

        }
        
        /* Shake animation for invalid inputs */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Additional Lab 11 K-Map Enhancements */
        .k-map-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 12px rgba(52,152,219,0.08);
        }
        
        .k-map-section h4 {
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 1.1rem;
            font-weight: 600;
            text-align: left;
        }
        
        .k-map-controls {
            margin-top: 1rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .k-map-simplification {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }
        
        .k-map-simplification h4 {
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 1rem;
            font-weight: 600;
            text-align: left;
        }
        
        .k-map-actions {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
        }
        
        /* Responsive K-Map Section Styles */
        @media (max-width: 768px) {
            .k-map-section {
                margin: 1.5rem 0;
                padding: 1rem;
            }
            
            .k-map-section h4 {
                font-size: 1rem;
            }
            
            .k-map-controls {
                gap: 0.8rem;
            }
            
            .k-map-controls .btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 600px) {
            .k-map-section {
                margin: 1rem 0;
                padding: 0.8rem;
            }
            
            .k-map-section h4 {
                font-size: 0.95rem;
            }
            
            .k-map-controls {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }
            
            .k-map-controls .btn {
                width: 100%;
                max-width: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .k-map-section {
                margin: 0.8rem 0;
                padding: 0.6rem;
            }
            
            .k-map-section h4 {
                font-size: 0.9rem;
            }
            
            .k-map-simplification {
                margin-top: 1.5rem;
                padding-top: 1rem;
            }
        }
        
        /* Responsive K-Map Section Styles */
        @media (max-width: 768px) {
            .k-map-section {
                margin: 1.5rem 0;
                padding: 1rem;
            }
            
            .k-map-section h4 {
                font-size: 1rem;
            }
            
            .k-map-controls {
                gap: 0.8rem;
            }
            
            .k-map-controls .btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 600px) {
            .k-map-section {
                margin: 1rem 0;
                padding: 0.8rem;
            }
            
            .k-map-section h4 {
                font-size: 0.95rem;
            }
            
            .k-map-controls {
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
            }
            
            .k-map-controls .btn {
                width: 100%;
                max-width: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .k-map-section {
                margin: 0.8rem 0;
                padding: 0.6rem;
            }
            
            .k-map-section h4 {
                font-size: 0.9rem;
            }
            
            .k-map-simplification {
                margin-top: 1.5rem;
                padding-top: 1rem;
            }
        }
        

        
        /* K-Map Section Spacing */
        .k-map-section + .k-map-section {
            margin-top: 3rem;
        }
        
        /* K-Map Container Enhancement */
        .k-map-container {
            margin-bottom: 1.5rem;
        }
        
        /* K-Map Header Enhancement */
        .k-map-section h4:first-child {
            color: var(--secondary);
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            text-align: left;
        }
        

        

        

        

        

        
        /* K-Map Grid Enhancement */
        #k-map-lab11-ja, #k-map-lab11-ka, #k-map-lab11-jb, 
        #k-map-lab11-kb, #k-map-lab11-jc, #k-map-lab11-kc {
            border: 1px solid var(--border);
            background: var(--card-bg);
        }
        
        /* MOD-7 Counter Simulator Responsive Design - Enterprise Grade */
        
        /* Large Desktop (1400px+) - Optimal spacing and layout */
        @media (min-width: 1400px) {
            .simulator-container .simulator-header {
                flex-direction: row;
                gap: 2rem;
            }
            
            .simulator-container .simulator-header .section-title {
                margin-right: 0;
            }
            
            .simulator-container .simulator-header .logicDesignBtnLab11 {
                flex-shrink: 0;
            }
            .simulator-container .grid-layout {
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
                margin-bottom: 2rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 1.5rem;
            }
            
            .simulator-container .section-title {
                font-size: 1.5rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 1rem !important;
                padding: 10px 20px !important;
            }
            
            .simulator-container .counter-switch-row {
                gap: 2rem;
                flex-direction: row;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 80px;
                margin-bottom: 0;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.5rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 1.5rem;
            }
        }
        
        /* Standard Desktop (1200px - 1399px) - Balanced layout */
        @media (max-width: 1399px) and (min-width: 1200px) {
            .simulator-container .grid-layout {
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 1.2rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 1.5rem;
                flex-direction: row;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 70px;
                margin-bottom: 0;
            }
        }
        
        /* Small Desktop (1000px - 1199px) - Compact layout */
        @media (max-width: 1199px) and (min-width: 1000px) {
            .simulator-container .grid-layout {
                grid-template-columns: 1fr 1fr;
                gap: 1.2rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 1rem;
            }
            
            .simulator-container .section-title {
                font-size: 1.3rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.85rem !important;
                padding: 7px 14px !important;
            }
            
            .simulator-container .counter-switch-row {
                gap: 1.5rem;
                flex-direction: row;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 70px;
                margin-bottom: 0;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 1rem;
            }
        }
        
        /* Tablet Landscape (768px - 999px) - Adaptive layout */
        @media (max-width: 999px) and (min-width: 768px) {
            .simulator-container .grid-layout {
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.9rem;
            }
            
            .simulator-container .section-title {
                font-size: 1.2rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.8rem !important;
                padding: 6px 12px !important;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                font-size: 0.95rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 1.2rem;
                flex-direction: row;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 65px;
                margin-bottom: 0;
            }
            
            .simulator-container .counter-led-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.9rem;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 1rem;
            }
        }
        
        /* Tablet Portrait (600px - 767px) - Single column layout */
        @media (max-width: 767px) and (min-width: 600px) {
            .simulator-container .simulator-header {
                flex-direction: column;
                gap: 0.8rem;
                text-align: center;
            }
            
            .simulator-container .simulator-header .section-title {
                margin-bottom: 0.6rem;
            }
            .simulator-container .grid-layout {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.8rem;
            }
            
            .simulator-container .section-title {
                font-size: 1.1rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.75rem !important;
                padding: 5px 10px !important;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                font-size: 0.9rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 1rem;
                flex-direction: column;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 60px;
                margin-bottom: 0.6rem;
            }
            
            .simulator-container .counter-led-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.8rem;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.8rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 0.8rem;
            }
            
            /* Optimize button grid for tablet */
            .simulator-container .clock-control-panel .clock-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.6rem;
            }
        }
        
        /* Large Mobile (480px - 599px) - Mobile-optimized layout */
        @media (max-width: 599px) and (min-width: 480px) {
            .simulator-container .simulator-header {
                flex-direction: column;
                gap: 0.6rem;
                text-align: center;
            }
            
            .simulator-container .simulator-header .section-title {
                margin-bottom: 0.4rem;
            }
            .simulator-container .grid-layout {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.7rem;
            }
            
            .simulator-container .section-title {
                font-size: 1rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.7rem !important;
                padding: 4px 8px !important;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                font-size: 0.85rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 0.8rem;
                flex-direction: column;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 55px;
                margin-bottom: 0.5rem;
            }
            
            .simulator-container .counter-led-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.7rem;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: 1fr;
                gap: 0.7rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 0.7rem;
            }
            
            /* Optimize button grid for mobile */
            .simulator-container .clock-control-panel .clock-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            
            /* Ensure touch-friendly button sizes */
            .simulator-container .btn {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        /* Small Mobile (320px - 479px) - Ultra-compact layout */
        @media (max-width: 479px) {
            .simulator-container .simulator-header {
                flex-direction: column;
                gap: 0.8rem;
                text-align: center;
            }
            
            .simulator-container .simulator-header .section-title {
                margin-bottom: 0.5rem;
            }
            
            .simulator-container .clock-controls-row {
                grid-template-columns: 1fr;
                gap: 0.5rem;
                text-align: center;
            }
            
            .simulator-container .clock-controls-row label {
                justify-self: center;
            }
            .simulator-container .grid-layout {
                grid-template-columns: 1fr;
                gap: 0.6rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.6rem;
            }
            
            .simulator-container .section-title {
                font-size: 0.95rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.65rem !important;
                padding: 3px 6px !important;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                font-size: 0.8rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 0.6rem;
                flex-direction: column;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 50px;
                margin-bottom: 0.4rem;
            }
            
            .simulator-container .counter-led-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.6rem;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: 1fr;
                gap: 0.6rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 0.6rem;
            }
            
            /* Ultra-compact button grid */
            .simulator-container .clock-control-panel .clock-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.4rem;
            }
            
            /* Ensure touch-friendly button sizes */
            .simulator-container .btn {
                min-height: 40px;
                min-width: 40px;
            }
            
            /* Optimize SVG for small screens */
            .simulator-container #counterSevenSegmentSVG {
                width: 70px !important;
                height: 110px !important;
            }
        }
        
        /* Ultra-small Mobile (≤319px) - Emergency fallback */
        @media (max-width: 319px) {
            .simulator-container .simulator-header {
                flex-direction: column;
                gap: 0.5rem;
                text-align: center;
            }
            
            .simulator-container .simulator-header .section-title {
                margin-bottom: 0.3rem;
            }
            
            .simulator-container .clock-controls-row {
                grid-template-columns: 1fr;
                gap: 0.4rem;
                text-align: center;
            }
            
            .simulator-container .clock-controls-row label {
                justify-self: center;
            }
            .simulator-container .grid-layout {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.5rem;
            }
            
            .simulator-container .section-title {
                font-size: 0.9rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                font-size: 0.6rem !important;
                padding: 2px 4px !important;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                font-size: 0.75rem;
            }
            
            .simulator-container .counter-switch-row {
                gap: 0.5rem;
                flex-direction: column;
                align-items: center;
            }
            
            .simulator-container .counter-switch-block {
                min-width: 45px;
                margin-bottom: 0.3rem;
            }
            
            .simulator-container .counter-led-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 0.5rem;
            }
            
            .simulator-container .jk-debug-row {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .simulator-container .jk-debug-block {
                padding: 0.5rem;
            }
            
            /* Emergency button grid */
            .simulator-container .clock-control-panel .clock-buttons-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.3rem;
            }
            
            /* Emergency touch-friendly sizes */
            .simulator-container .btn {
                min-height: 36px;
                min-width: 36px;
            }
            
            /* Emergency SVG sizing */
            .simulator-container #counterSevenSegmentSVG {
                width: 60px !important;
                height: 90px !important;
            }
        }
        
        /* Landscape Mobile Optimization */
        @media (max-height: 500px) and (orientation: landscape) {
            .simulator-container .grid-layout {
                gap: 0.8rem;
                margin-bottom: 1rem;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                padding: 0.6rem;
            }
            
            .simulator-container .clock-control-panel h4,
            .simulator-container .counter-input-section h4,
            .simulator-container .counter-seg-section h4,
            .simulator-container .counter-led-section h4 {
                margin-bottom: 0.5rem;
            }
            
            .simulator-container .counter-switch-row {
                margin-bottom: 0.6rem;
            }
        }
        
        /* High DPI Display Optimization */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .simulator-container .btn {
                border-width: 0.5px;
            }
            
            .simulator-container .clock-control-panel,
            .simulator-container .counter-input-section,
            .simulator-container .counter-seg-section,
            .simulator-container .counter-led-section {
                border-width: 0.5px;
            }
        }
        
        /* Print Media Optimization */
        @media print {
            .simulator-container .grid-layout {
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
            }
            
            .simulator-container .logicDesignBtnLab11 {
                display: none;
            }
        }
        
        /* Lab 11 K-Map Navigation Responsive Design */
        
        /* Unified color scheme for all K-Map navigation buttons - Matching Lab 10 Style */
        .kmap-navigation .kmap-nav-btn {
            background: var(--bg-primary) !important;
            color: var(--text) !important;
            border: 2px solid transparent !important;
            transition: all 0.3s ease !important;
            position: relative;
            overflow: hidden;
        }
        
        .kmap-navigation .kmap-nav-btn:hover {
            background: var(--bg-secondary) !important;
            color: var(--text) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        
        /* Active state styling for navigation buttons - Matching Lab 10 */
        .kmap-navigation .kmap-nav-btn.active {
            background: var(--bg-primary) !important;
            color: var(--text) !important;
            border-color: var(--accent) !important;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        /* Focus state for accessibility - Matching Lab 10 */
        .kmap-navigation .kmap-nav-btn:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
        }
        
        /* Large Desktop (1400px+) - Optimal spacing */
        @media (min-width: 1400px) {
            .kmap-navigation .nav-buttons-container {
                gap: 1rem;
            }
            
            .kmap-navigation .kmap-nav-btn {
                padding: 0.8rem 1.5rem !important;
                min-width: 140px !important;
                font-size: 1rem !important;
            }
        }
        
        /* Standard Desktop (1200px - 1399px) - Balanced layout */
        @media (max-width: 1399px) and (min-width: 1200px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.9rem;
            }
            
            .kmap-navigation .kmap-nav-btn {
                padding: 0.75rem 1.3rem !important;
                min-width: 130px !important;
                font-size: 0.95rem !important;
            }
        }
        
        /* Small Desktop (1000px - 1199px) - Compact layout */
        @media (max-width: 1199px) and (min-width: 1000px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.8rem;
            }
            
            .kmap-nav-btn {
                padding: 0.7rem 1.2rem !important;
                min-width: 120px !important;
                font-size: 0.9rem !important;
            }
        }
        
        /* Tablet Landscape (768px - 999px) - Adaptive layout */
        @media (max-width: 999px) and (min-width: 768px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.7rem;
            }
            
            .kmap-nav-btn {
                padding: 0.65rem 1.1rem !important;
                min-width: 110px !important;
                font-size: 0.85rem !important;
            }
        }
        
        /* Tablet Portrait (600px - 767px) - Single column layout */
        @media (max-width: 767px) and (min-width: 600px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.6rem;
                flex-direction: column;
                align-items: center;
            }
            
            .kmap-nav-btn {
                padding: 0.6rem 1rem !important;
                min-width: 200px !important;
                font-size: 0.8rem !important;
            }
        }
        
        /* Large Mobile (480px - 599px) - Mobile-optimized layout */
        @media (max-width: 599px) and (min-width: 480px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.5rem;
                flex-direction: column;
                align-items: center;
            }
            
            .kmap-nav-btn {
                padding: 0.55rem 0.9rem !important;
                min-width: 180px !important;
                font-size: 0.75rem !important;
            }
        }
        
        /* Small Mobile (320px - 479px) - Ultra-compact layout */
        @media (max-width: 479px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.4rem;
                flex-direction: column;
                align-items: center;
            }
            
            .kmap-nav-btn {
                padding: 0.5rem 0.8rem !important;
                min-width: 160px !important;
                font-size: 0.7rem !important;
            }
        }
        
        /* Ultra-small Mobile (≤319px) - Emergency fallback */
        @media (max-width: 319px) {
            .kmap-navigation .nav-buttons-container {
                gap: 0.3rem;
                flex-direction: column;
                align-items: center;
            }
            
            .kmap-nav-btn {
                padding: 0.45rem 0.7rem !important;
                min-width: 140px !important;
                font-size: 0.65rem !important;
            }
        }
        
        /* Landscape Mobile Optimization */
        @media (max-height: 500px) and (orientation: landscape) {
            .kmap-navigation .nav-buttons-container {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .kmap-nav-btn {
                min-width: 100px !important;
                padding: 0.5rem 0.8rem !important;
            }
        }
        
        /* Dark/Light Mode Adaptations for K-Map Navigation - Matching Lab 10 */
        body.light-mode .kmap-navigation {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        
        body.light-mode .kmap-navigation .kmap-nav-btn.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.15);
        }
        
        /* ======================== */
        /* CONTEXTUAL HELP SYSTEM  */
        /* ======================== */
        
        /* Help System CSS Variables - Enhanced Color Palette */
        :root {
            --help-card-bg: var(--card-bg);
            --help-card-fg: var(--text);
            --help-card-border: var(--card-border);
            --help-card-shadow: 0 4px 24px 0 rgba(52, 152, 219, 0.15);
            --help-nav-hover: var(--secondary);
            --help-nav-disabled: var(--muted);
            --help-card-accent: var(--secondary);
            --help-card-accent-light: rgba(52, 152, 219, 0.1);
            --help-card-gradient: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);
            --help-header-bg: var(--secondary-bg);
            --help-title-color: var(--text);
            --help-close-color: var(--muted);
            --help-close-hover-bg: rgba(231, 76, 60, 0.1);
            --help-close-hover-color: var(--accent);
            --dropdown-text: var(--text);
            --dropdown-hover-bg: var(--help-card-accent-light);
            --dropdown-hover-text: var(--help-card-accent);
        }
        

        
        /* Help Dropdown Menu */
        .help-dropdown {
            position: absolute;
            top: 4.5rem;
            right: 2rem;
            background: var(--help-card-bg);
            border: 1px solid var(--help-card-border);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 9998;
            min-width: 200px;
            max-width: calc(100vw - 2rem);
            overflow: hidden;
        }
        
        .help-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            padding: 1rem 1.25rem;
            background: none;
            border: none;
            color: var(--dropdown-text);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            border-bottom: 1px solid var(--help-card-border);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .dropdown-item:hover {
            background: var(--dropdown-hover-bg);
            color: var(--dropdown-hover-text);
        }
        
        .dropdown-item:focus {
            outline: none;
            background: var(--dropdown-hover-bg);
            color: var(--dropdown-hover-text);
        }
        
        .dropdown-item i {
            font-size: 1.1rem;
            width: 1.25rem;
            text-align: center;
            flex-shrink: 0;
        }
        
        .dropdown-item span {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Help Popup Modal */
        .help-popup {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 420px;
            max-width: 95vw;
            background: var(--help-card-bg);
            border: 1px solid var(--help-card-border);
            border-radius: 18px;
            box-shadow: var(--help-card-shadow);
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transform: translateY(60px) scale(0.98);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            max-height: 90vh;
        }
        
        .help-popup.active {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0) scale(1);
        }
        
        /* Help Popup Header */
        .help-popup-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 1.5rem 0.25rem 1.5rem;
            border-bottom: 1px solid var(--help-card-border);
            background: var(--help-header-bg);
            position: relative;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .help-popup-title {
            margin: 0;
            color: var(--help-title-color);
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .help-popup-close {
            background: none;
            border: none;
            color: var(--help-close-color);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            outline: none;
            box-shadow: none;
        }
        
        .help-popup-close:hover {
            color: var(--help-close-hover-color);
            background: var(--help-close-hover-bg);
        }
        
        .help-popup-close:focus {
            outline: none;
            box-shadow: none;
        }
        
        /* Help Cards Container - OPTIMIZED SPACING */
        .help-cards-container {
            padding: 1.5rem;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding-top: 0.5rem;
            margin-top: 0.0625rem;
            transition: padding-top 0.3s ease;
            position: relative;
            background: var(--help-card-bg);
            border-top: 1px solid var(--help-card-border);
        }
        
        /* Help Card - ENHANCED DESIGN */
        .help-card {
            background: var(--help-card-bg);
            color: var(--help-card-fg);
            border-radius: 16px;
            padding: 1.75rem;
            margin: 0;
            margin-top: 1rem;
            border: 1px solid var(--help-card-border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .help-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.18);
            border-color: var(--help-card-accent);
        }
        
        .help-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--help-card-gradient);
            border-radius: 16px 16px 0 0;
        }
        
        .help-card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--help-card-fg);
            margin: 0;
            line-height: 1.3;
            padding-top: 0.5rem;
            position: relative;
            letter-spacing: -0.02em;
        }
        
        .help-card-title::after {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            left: 0;
            width: 3rem;
            height: 2px;
            background: var(--help-card-accent);
            border-radius: 1px;
        }
        
        .help-card-description {
            color: var(--help-card-fg);
            line-height: 1.8;
            margin: 0;
            font-size: 1.05rem;
            opacity: 0.95;
            white-space: pre-line;
            font-weight: 400;
        }
        
        /* Help Navigation */
        .help-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem 1.5rem 1.5rem;
            border-top: 1px solid var(--help-card-border);
            background: var(--help-header-bg);
        }
        
        .help-nav-btn {
            background: none;
            border: none;
            color: var(--muted);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
        }
        
        .help-nav-btn:hover:not(:disabled) {
            color: var(--help-nav-hover);
            background: rgba(52, 152, 219, 0.1);
        }
        
        .help-nav-btn:disabled {
            color: var(--help-nav-disabled);
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        /* Help Indicators */
        .help-indicators {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .help-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--muted);
            transition: background 0.2s ease;
        }
        
        .help-indicator.active {
            background: var(--secondary);
        }
        
        /* Responsive Design for Help System */
        @media (max-width: 768px) {
            .help-popup,
            .contact-modal {
                right: 1rem;
                left: 1rem;
                bottom: 1rem;
                width: auto;
                max-width: none;
            }
            
            .help-cards-container {
                padding-top: 1.25rem;
                margin-top: 0.5rem;
            }
            
            .help-fab {
                bottom: 1rem;
                right: 1rem;
                width: 3.5rem;
                height: 3.5rem;
                font-size: 1.25rem;
            }
            
            .help-dropdown {
                right: 1rem;
                top: 4.5rem;
                min-width: 180px;
                max-width: calc(100vw - 2rem);
            }
        }
        
        /* Tablet and Small Desktop Responsive */
        @media (max-width: 768px) {
            .help-dropdown {
                right: 1.5rem;
                min-width: 190px;
                max-width: calc(100vw - 3rem);
            }
        }
        
        @media (max-width: 480px) {
            .help-popup-header,
            .help-cards-container,
            .help-navigation,
            .contact-modal-header,
            .contact-form-container {
                padding: 1rem;
            }
            
            .help-cards-container {
                padding-top: 1rem;
                margin-top: 0.25rem;
            }
            
            .help-popup-title,
            .contact-modal-title {
                font-size: 1.1rem;
            }
            
            .help-card {
                padding: 1rem;
                margin-top: 0.75rem;
            }
            
            .help-dropdown {
                right: 1rem;
                min-width: 160px;
                max-width: calc(100vw - 2rem);
            }
            
            .dropdown-item {
                padding: 0.75rem 1rem;
                font-size: 0.95rem;
            }
        }
        
        /* Extra Small Screens */
        @media (max-width: 360px) {
            .help-dropdown {
                right: 0.5rem;
                min-width: 140px;
                max-width: calc(100vw - 1rem);
            }
            
            .dropdown-item {
                padding: 0.5rem 0.75rem;
                font-size: 0.9rem;
            }
            
            .dropdown-item i {
                font-size: 1rem;
                width: 1rem;
            }
        }
        
        /* Additional Touch Screen Optimizations */
        @media (pointer: coarse) {
            .help-popup {
                /* Better touch scrolling */
                -webkit-overflow-scrolling: touch;
                overscroll-behavior: contain;
            }
        }
        
        /* Light Mode Adaptations */
        body.light-mode .help-popup {
            box-shadow: 0 4px 24px 0 rgba(0, 0, 0, 0.1);
        }
        
        body.light-mode .help-card {
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
            background: #ffffff;
            border-color: #e3eaf2;
            color: #222;
        }
        
        body.light-mode .help-card-title {
            color: #222;
        }
        
        body.light-mode .help-card-description {
            color: #607d8b;
        }
        
        body.light-mode .help-popup-header {
            background: #f8fafc;
            border-bottom-color: #e3eaf2;
        }
        
        body.light-mode .help-navigation {
            background: #f8fafc;
            border-top-color: #e3eaf2;
        }
        
        body.light-mode .help-popup-title {
            color: #1976d2;
        }
        
        body.light-mode .help-popup-close {
            color: #b0bec5;
        }
        
        body.light-mode .help-popup-close:hover {
            color: #d84315;
            background: rgba(216, 67, 21, 0.1);
        }
        
        body.light-mode .help-nav-btn {
            color: #b0bec5;
        }
        
        body.light-mode .help-nav-btn:hover:not(:disabled) {
            color: #1976d2;
            background: rgba(25, 118, 210, 0.1);
        }
        
        body.light-mode .help-indicator {
            background: #b0bec5;
        }
        
        body.light-mode .help-indicator.active {
            background: #1976d2;
        }
        
        
        
        body.light-mode .help-cards-container {
            background: #ffffff;
            border-top-color: #e3eaf2;
        }
        
        body.light-mode .help-popup {
            background: #ffffff;
            border-color: #e3eaf2;
        }
        
        /* Light Mode Adaptations for Dropdown and Contact Form */
        body.light-mode .help-dropdown {
            background: #ffffff;
            border-color: #e3eaf2;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        body.light-mode .dropdown-item {
            color: #222;
            border-bottom-color: #e3eaf2;
        }
        
        body.light-mode .dropdown-item:hover,
        body.light-mode .dropdown-item:focus {
            background: rgba(25, 118, 210, 0.1);
            color: #1976d2;
        }
        
        body.light-mode .contact-modal {
            background: #ffffff;
            border-color: #e3eaf2;
            box-shadow: 0 4px 24px 0 rgba(0, 0, 0, 0.1);
        }
        
        body.light-mode .contact-modal-header {
            background: #f8fafc;
            border-bottom-color: #e3eaf2;
        }
        
        body.light-mode .contact-modal-title {
            color: #1976d2;
        }
        
        body.light-mode .contact-modal-close {
            color: #b0bec5;
        }
        
        body.light-mode .contact-modal-close:hover {
            color: #d84315;
            background: rgba(216, 67, 21, 0.1);
        }
        
        body.light-mode .contact-modal-close:focus {
            outline: none;
            box-shadow: none;
        }
        
        body.light-mode .contact-input {
            background: #ffffff;
            border-color: #e3eaf2;
            color: #222;
        }
        
        body.light-mode .contact-input:focus {
            border-color: #1976d2;
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.12);
        }
        
        body.light-mode .contact-help {
            color: #607d8b;
        }
        
        body.light-mode .contact-input:focus + .contact-help {
            color: #1976d2;
        }
        
        body.light-mode .contact-submit-btn {
            background: linear-gradient(90deg, #1976d2, #42a5f5);
        }
        
        body.light-mode .contact-submit-btn:disabled {
            background: linear-gradient(90deg, #bdbdbd 60%, #e0e0e0 100%) !important;
            color: #757575 !important;
        }
        
        body.light-mode #contact-form-message.success {
            background-color: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
        }
        
        body.light-mode #contact-form-message.error {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }
        
        /* Contact Modal Styles */
        .contact-modal {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 420px;
            max-width: 95vw;
            background: var(--help-card-bg);
            border: 1px solid var(--help-card-border);
            border-radius: 18px;
            box-shadow: var(--help-card-shadow);
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transform: translateY(60px) scale(0.98);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            max-height: 90vh;
        }
        
        .contact-modal.active {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0) scale(1);
        }
        
        .contact-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 1.5rem 0.25rem 1.5rem;
            border-bottom: 1px solid var(--help-card-border);
            background: var(--help-header-bg);
            position: relative;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .contact-modal-title {
            margin: 0;
            color: var(--help-title-color);
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .contact-modal-close {
            background: none;
            border: none;
            color: var(--help-close-color);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            box-shadow: none;
        }
        
        .contact-modal-close:hover {
            background: var(--help-close-hover-bg);
            color: var(--help-close-hover-color);
            outline: none;
            box-shadow: none;
        }
        
        .contact-modal-close:focus {
            outline: none;
            box-shadow: none;
        }
        
        .contact-form-container {
            padding: 1.5rem;
            max-height: calc(90vh - 4rem);
            overflow-y: auto;
        }
        
        .contact-form .form-group {
            margin-bottom: 1.5rem;
        }
        
        .contact-input {
            width: 100%;
            padding: 14px;
            border-radius: 8px;
            border: 1.5px solid var(--help-card-border);
            background: var(--help-card-bg);
            font-family: inherit;
            font-size: 1rem;
            color: var(--help-card-fg);
            transition: border-color 0.3s, box-shadow 0.3s;
            box-sizing: border-box;
            font-weight: 400;
        }
        
        .contact-input:focus {
            border-color: var(--help-card-accent);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.12);
            outline: none;
        }
        
        .contact-help {
            color: var(--muted);
            font-size: 0.98em;
            margin-top: 0.15rem;
            margin-bottom: 0.25rem;
            padding: 0 0.5rem;
            display: none;
            transition: color 0.2s;
        }
        
        .contact-input:focus + .contact-help {
            display: block;
            color: var(--help-card-accent);
        }
        
        .contact-error {
            color: #c0392b;
            background: linear-gradient(90deg, #fff0f0 60%, #ffe5e5 100%);
            border-radius: 0.75rem;
            font-size: 1.05em;
            margin-top: 0.25rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem 1rem;
            font-family: inherit;
            box-shadow: 0 2px 8px 0 rgba(192,57,43,0.07);
            border: 1px solid #f8d7da;
            display: none;
            font-weight: 600;
            letter-spacing: 0.01em;
            transition: opacity 0.3s, transform 0.3s;
            opacity: 0;
            transform: translateY(8px);
        }
        
        .contact-error.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .contact-submit-btn {
            display: inline-block;
            width: 100%;
            background: linear-gradient(90deg, var(--help-card-accent), var(--secondary));
            color: #fff;
            padding: 14px 0;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.2);
            border: none;
            transition: transform 0.3s, box-shadow 0.3s, opacity 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .contact-submit-btn:disabled {
            pointer-events: none;
            opacity: 0.6;
            filter: grayscale(0.2);
            box-shadow: none !important;
            transform: none !important;
            background: linear-gradient(90deg, #bbb 60%, #eee 100%) !important;
            color: #fff !important;
            cursor: not-allowed !important;
        }
        
        .contact-submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }
        
        #contact-form-message {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
            text-align: center;
            border: 1px solid transparent;
            font-weight: 500;
        }
        
        #contact-form-message.success {
            background-color: #e0f7fa;
            color: #007c91;
            display: block;
            border: 1px solid #b2ebf2;
        }
        
        #contact-form-message.error {
            background-color: #ffe5e5;
            color: #c0392b;
            display: block;
            border: 1px solid #f8d7da;
        }
        

            
    </style>
</head>
<body>
    <header>
        <button type="button" class="sidebar-hamburger hamburger-button" aria-label="Open Table of Contents" id="sidebarHamburger" style="position:absolute;top:1.5rem;left:2rem;z-index:21;width:44px;height:44px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;background:rgba(52,152,219,0.15);box-shadow:0 2px 8px rgba(52,152,219,0.10);transition:background 0.3s,box-shadow 0.3s,transform 0.2s;outline:none;"><span id="hamburgerIcon"><i class="fas fa-bars" style="font-size:1.5rem;color:#3498db;"></i></span></button>
        <div class="university">MSA University</div>
        <h1>CS121 Digital Logic Design</h1>
        <div class="subtitle">Interactive Lab Manual</div>
        <button id="themeToggle" class="theme-toggle-btn" aria-label="Toggle dark/light mode">
            <span id="themeIcon" class="theme-toggle-icon"></span>
        </button>
        <button id="helpToggle" class="help-toggle-btn" aria-label="Help Options" aria-expanded="false">
            <span id="helpIcon" class="help-toggle-icon">
                <i class="fas fa-question-circle"></i>
            </span>
        </button>
        <div id="tocDropdown" class="toc-dropdown" style="display:none;position:absolute;top:4.5rem;left:2rem;max-width:340px;width:90vw;background:var(--card-bg);border-radius:18px;box-shadow:0 8px 32px rgba(52,152,219,0.18);border:1px solid var(--card-border);z-index:100;padding:2rem 1.5rem 1.5rem 1.5rem;">
            <button type="button" id="tocClose" aria-label="Close Table of Contents" style="position:absolute;top:1.2rem;right:1.2rem;width:38px;height:38px;border-radius:50%;border:none;background:rgba(231,76,60,0.12);color:#e74c3c;display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:0 2px 8px rgba(231,76,60,0.10);transition:background 0.3s,box-shadow 0.3s,transform 0.2s;"><i class="fas fa-times"></i></button>
            <h2 class="toc-title" style="margin-top:0;"><i class="fas fa-book"></i> Table of Contents</h2>
            <ul class="lab-list">
                <li class="lab-item">
                    <a href="#lab1" class="lab-link active" data-lab="lab1">
                        Lab 1: First lab in the logic world
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab2" class="lab-link" data-lab="lab2">
                        Lab 2: Implementing Basic Logic Gates
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab3" class="lab-link" data-lab="lab3">
                        Lab 3: Simplifying complicated formulas
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab4" class="lab-link" data-lab="lab4">
                        Lab 4: Simplifying formulas (cont.)
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab5" class="lab-link" data-lab="lab5">
                        Lab 5: Using K-maps
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab6" class="lab-link" data-lab="lab6">
                        Lab 6: Using K-maps (cont.)
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab7" class="lab-link" data-lab="lab7">
                        Lab 7: Using Full Adder
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab8" class="lab-link" data-lab="lab8">
                        Lab 8: Using Decoders
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab9" class="lab-link" data-lab="lab9">
                        Lab 9: Using Multiplexers
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab10" class="lab-link" data-lab="lab10">
                        Lab 10: Flip Flops
                    </a>
                </li>
                <li class="lab-item">
                    <a href="#lab11" class="lab-link" data-lab="lab11">
                        Lab 11: Using Counters
                    </a>
                </li>
            </ul>
        </div>
    </header>
    <div class="container">
        <main class="main-content" tabindex="0" aria-live="polite">
            <!-- Lab 1 -->
            <section id="lab1" class="lab-section" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 1: First lab in the logic world</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>The purpose of the first lab is to be familiar with:</p>
                <ul class="objectives-list">
                    <li>The kit</li>
                    <li>The breadboard</li>
                    <li>How to use the Leds</li>
                    <li>How to use the 7 segment display</li>
                    <li>How to use switches to represent Binary numbers</li>
                    <li>What is IC (Integrated circuits)</li>
                    <li>How to connect any IC on the kit</li>
                    <li>Push Buttons</li>
                </ul>
                
                <h3 class="section-title">Steps:</h3>
                <ul class="steps-list">
                    <li>Make sure that the power is on</li>
                    <li>Get to know the boards can be used and which points are connected with each other.</li>
                    <li>How to provide VCC & GND to the circuits.</li>
                    <li>What is a LED (light Emitting Diode)</li>
                    <li>How to use switches to represent Binary numbers</li>
                    <li>Use the seven segment display to display binary numbers (0-9)</li>
                </ul>
                
                <div class="image-frame">
                    <img src="media/image1.png" alt="Breadboard and components" class="responsive-img" />
                </div>
                
                <h3 class="section-title">7447 BCD to 7-Segment Smart Simulator</h3>
                <p class="section-desc lab1-bcd-desc">
                  Experiment with 4 digital switches to see how a real 7447 BCD-to-7-segment decoder drives a display. Toggle the switches to set a 4-bit BCD value (<span class="lab1-bcd-span">A: MSB, D: LSB</span>). LEDs and segment output update instantly. Only valid BCD (0–9) is shown.
                </p>
                <div class="lab1-sim-card" aria-label="7447 BCD to 7-segment simulation experiment">
                    <div class="lab1-switch-row">
                        <div class="lab1-switch-block">
                            <div class="input-switch" style="position:relative;">
                                <input type="checkbox" id="switch1" aria-label="Input A (MSB)" tabindex="0">
                                <label class="slider" for="switch1"></label>
                            </div>
                            <div class="input-label">A (MSB)</div>
                        </div>
                        <div class="lab1-switch-block">
                            <div class="input-switch" style="position:relative;">
                                <input type="checkbox" id="switch2" aria-label="Input B" tabindex="0">
                                <label class="slider" for="switch2"></label>
                            </div>
                            <div class="input-label">B</div>
                        </div>
                        <div class="lab1-switch-block">
                            <div class="input-switch" style="position:relative;">
                                <input type="checkbox" id="switch3" aria-label="Input C" tabindex="0">
                                <label class="slider" for="switch3"></label>
                            </div>
                            <div class="input-label">C</div>
                        </div>
                        <div class="lab1-switch-block">
                            <div class="input-switch" style="position:relative;">
                                <input type="checkbox" id="switch4" aria-label="Input D (LSB)" tabindex="0">
                                <label class="slider" for="switch4"></label>
                            </div>
                            <div class="input-label">D (LSB)</div>
                        </div>
                    </div>
                    <div class="lab1-led-row">
                        <div class="lab1-led-block">
                            <div class="led-output" id="ledA" role="img" aria-label="LED A output status" tabindex="0"></div>
                            <span class="led-state-label" id="ledAState">LOW</span>
                        </div>
                        <div class="lab1-led-block">
                            <div class="led-output" id="ledB" role="img" aria-label="LED B output status" tabindex="0"></div>
                            <span class="led-state-label" id="ledBState">LOW</span>
                        </div>
                        <div class="lab1-led-block">
                            <div class="led-output" id="ledC" role="img" aria-label="LED C output status" tabindex="0"></div>
                            <span class="led-state-label" id="ledCState">LOW</span>
                        </div>
                        <div class="lab1-led-block">
                            <div class="led-output" id="ledD" role="img" aria-label="LED D output status" tabindex="0"></div>
                            <span class="led-state-label" id="ledDState">LOW</span>
                        </div>
                    </div>
                    <div class="lab1-sim-divider" aria-hidden="true">
                        <div class="lab1-sim-divider-line"></div>
                        <span class="lab1-sim-arrow" title="Input to Output">&#8595;</span>
                        <div class="lab1-sim-divider-line"></div>
                    </div>
                    <div class="lab1-seg-container">
                        <div class="input-label" style="margin-bottom:0.5rem;font-weight:600;">7-Segment Display</div>
                        <div class="segment-display" id="sevenSegment" aria-live="polite" tabindex="0">
                            <svg id="sevenSegmentSVG" width="90" height="150" viewBox="0 0 90 150" style="display:block;margin:0 auto;">
                                <rect x="5" y="5" width="80" height="140" rx="18" fill="#181818" stroke="#333" stroke-width="4"/>
                                <g id="segments">
                                    <polygon id="segA" points="20,18 70,18 62,28 28,28" fill="#2a0000"/>
                                    <polygon id="segB" points="72,20 82,32 82,68 72,76 62,68 62,32" fill="#2a0000"/>
                                    <polygon id="segC" points="72,80 82,88 82,124 72,136 62,124 62,88" fill="#2a0000"/>
                                    <polygon id="segD" points="20,132 70,132 62,122 28,122" fill="#2a0000"/>
                                    <polygon id="segE" points="18,80 28,88 28,124 18,136 8,124 8,88" fill="#2a0000"/>
                                    <polygon id="segF" points="18,20 28,32 28,68 18,76 8,68 8,32" fill="#2a0000"/>
                                    <polygon id="segG" points="22,75 68,75 62,85 28,85" fill="#2a0000"/>
                                </g>
                            </svg>
                        </div>
                        <div class="lab1-seg-labels">
                            <div class="input-label">Binary: <span id="binaryValue">0000</span></div>
                            <div class="input-label">Decimal: <span id="decimalValue">0</span></div>
                        </div>
                        <div class="lab1-note">Valid BCD input: 0000–1001 (decimal 0–9). For 1010–1111, display is blank.</div>
                    </div>
                </div>
            </section>
            
            <!-- Lab 2 -->
            <section id="lab2" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 2: Implementing Basic Logic Gates</h2>
                </div>
                
                <h3 class="section-title">Objective:</h3>
                <p>Becoming familiar with the AND, OR and NOT (Inverter) logic operations implemented with TTL level integrated circuit gates.</p>
                
                <h3 class="section-title">Experiment requirements:</h3>
                <p>This experiment uses the following TTL level ICs; the pin configurations for these ICs are available in appendix A:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7404</div>
                    <div class="ic-table-cell" role="cell">Hex inverter</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7408</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input AND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7432</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input OR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7400</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input NAND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7402</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input NOR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7486</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input XOR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7410</div>
                    <div class="ic-table-cell" role="cell">Triple 3-input NAND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7420</div>
                    <div class="ic-table-cell" role="cell">Dual 4-input NAND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ol style="margin-left: 1.5rem; color: var(--light); font-size: 1.08rem; line-height: 1.8;">
                    <li><b>Verify the truth table of logic gates</b> by trying different combinations of inputs of the following gates:<br>
                        <span style="color: var(--secondary); font-weight: 500;">AND, OR, NAND, NOR, XOR, XNOR, 3-input NAND, 4-input NAND</span>
                    </li>
                    <li>Implement the function of the <b>NAND gate</b> using <span style="color: var(--accent);">AND gate</span> &amp; an <span style="color: var(--accent);">INVERTER</span>.</li>
                    <li>Implement the function of the <b>NAND gate</b> using <span style="color: var(--secondary);">OR gate</span> &amp; an <span style="color: var(--accent);">INVERTER</span>.</li>
                    <li>Using only <b>one NAND gate</b>, implement the function of a <span style="color: var(--success);">NOT gate</span>.</li>
                    <li>Using only <b>one NOR gate</b>, implement the function of a <span style="color: var(--success);">NOT gate</span>.</li>
                </ol>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth tables for: AND, OR, NAND, NOR, XOR, XNOR</b></p>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="interactive-truth-table">
                    <thead>
                      <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>AND</th>
                        <th>OR</th>
                        <th>NAND</th>
                        <th>NOR</th>
                        <th>XOR</th>
                        <th>XNOR</th>
                    </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td>
                        <td><input class="output-field" data-gate="AND" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="AND output for 0 0"></td>
                        <td><input class="output-field" data-gate="OR" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="OR output for 0 0"></td>
                        <td><input class="output-field" data-gate="NAND" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="NAND output for 0 0"></td>
                        <td><input class="output-field" data-gate="NOR" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="NOR output for 0 0"></td>
                        <td><input class="output-field" data-gate="XOR" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="XOR output for 0 0"></td>
                        <td><input class="output-field" data-gate="XNOR" data-a="0" data-b="0" maxlength="1" inputmode="numeric" aria-label="XNOR output for 0 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td>
                        <td><input class="output-field" data-gate="AND" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="AND output for 0 1"></td>
                        <td><input class="output-field" data-gate="OR" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="OR output for 0 1"></td>
                        <td><input class="output-field" data-gate="NAND" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="NAND output for 0 1"></td>
                        <td><input class="output-field" data-gate="NOR" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="NOR output for 0 1"></td>
                        <td><input class="output-field" data-gate="XOR" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="XOR output for 0 1"></td>
                        <td><input class="output-field" data-gate="XNOR" data-a="0" data-b="1" maxlength="1" inputmode="numeric" aria-label="XNOR output for 0 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td>
                        <td><input class="output-field" data-gate="AND" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="AND output for 1 0"></td>
                        <td><input class="output-field" data-gate="OR" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="OR output for 1 0"></td>
                        <td><input class="output-field" data-gate="NAND" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="NAND output for 1 0"></td>
                        <td><input class="output-field" data-gate="NOR" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="NOR output for 1 0"></td>
                        <td><input class="output-field" data-gate="XOR" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="XOR output for 1 0"></td>
                        <td><input class="output-field" data-gate="XNOR" data-a="1" data-b="0" maxlength="1" inputmode="numeric" aria-label="XNOR output for 1 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td>
                        <td><input class="output-field" data-gate="AND" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="AND output for 1 1"></td>
                        <td><input class="output-field" data-gate="OR" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="OR output for 1 1"></td>
                        <td><input class="output-field" data-gate="NAND" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="NAND output for 1 1"></td>
                        <td><input class="output-field" data-gate="NOR" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="NOR output for 1 1"></td>
                        <td><input class="output-field" data-gate="XOR" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="XOR output for 1 1"></td>
                        <td><input class="output-field" data-gate="XNOR" data-a="1" data-b="1" maxlength="1" inputmode="numeric" aria-label="XNOR output for 1 1"></td>
                    </tr>
                    </tbody>
                </table>
                </div>
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>

                <p id="question2-text"><b>2. Sketch the logic diagram for circuit of question 2.</b></p>
                <section class="logic-drawing-section" id="logic-drawing-2" style="margin-bottom:1.5rem;">
                  <div class="toolbar-scroll-x">
                    <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--secondary);">Pen</span>
                        <input type="color" id="penColor2" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                      </label>
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--secondary);">Size</span>
                        <input type="range" id="penSize2" min="1" max="10" value="3" style="width:70px;">
                      </label>
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--accent);">Eraser</span>
                        <input type="range" id="eraserSize2" min="5" max="30" value="15" style="width:70px;">
                      </label>
                      <button id="toggleTool2" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                        <span class="icon">✏️</span>
                      </button>
                      <button id="zoomInBtn2" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                      <input type="range" id="zoomSlider2" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                      <button id="zoomOutBtn2" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                      <span class="zoom-level" id="zoomLevel2">100%</span>
                      <button id="downloadCanvas2" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                    </div>
                  </div>
                  <div id="drawingContainer2" class="drawing-wrapper">
                    <canvas id="drawingCanvas2" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                  </div>
                </section>

                <p id="question3-text"><b>3. Sketch the logic diagram for circuit of question 3, 4, 5.</b></p>
                <section class="logic-drawing-section" id="logic-drawing-3" style="margin-bottom:1.5rem;">
                  <div class="toolbar-scroll-x">
                    <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--secondary);">Pen</span>
                        <input type="color" id="penColor3" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                      </label>
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--secondary);">Size</span>
                        <input type="range" id="penSize3" min="1" max="10" value="3" style="width:70px;">
                      </label>
                      <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                        <span style="color:var(--accent);">Eraser</span>
                        <input type="range" id="eraserSize3" min="5" max="30" value="15" style="width:70px;">
                      </label>
                      <button id="toggleTool3" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                        <span class="icon">✏️</span>
                      </button>
                      <button id="zoomInBtn3" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                      <input type="range" id="zoomSlider3" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                      <button id="zoomOutBtn3" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                      <span class="zoom-level" id="zoomLevel3">100%</span>
                      <button id="downloadCanvas3" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                    </div>
                  </div>
                  <div id="drawingContainer3" class="drawing-wrapper">
                    <canvas id="drawingCanvas3" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                  </div>
                </section>
                
                <div class="simulator-container">
                    <h3 class="section-title">Logic Gate Simulator</h3>
                    <div class="gate-selector" style="display:flex;gap:1rem;margin-bottom:1.2rem;flex-wrap:wrap;justify-content:center;">
                        <button class="gate-btn active" data-gate="and" type="button" aria-pressed="true">AND</button>
                        <button class="gate-btn" data-gate="or" type="button" aria-pressed="false">OR</button>
                        <button class="gate-btn" data-gate="nand" type="button" aria-pressed="false">NAND</button>
                        <button class="gate-btn" data-gate="nor" type="button" aria-pressed="false">NOR</button>
                        <button class="gate-btn" data-gate="xor" type="button" aria-pressed="false">XOR</button>
                        <button class="gate-btn" data-gate="xnor" type="button" aria-pressed="false">XNOR</button>
                    </div>
                    <div class="simulator" style="display:flex;align-items:center;justify-content:center;gap:3rem;flex-wrap:wrap;">
                        <div class="input-container" style="display:flex;gap:2.5rem;align-items:center;">
                            <div>
                                <div class="input-switch">
                                    <input type="checkbox" id="simInputA" aria-label="Input A">
                                    <label class="slider" for="simInputA"></label>
                                </div>
                                <div class="input-label">Input A</div>
                            </div>
                            <div>
                                <div class="input-switch">
                                    <input type="checkbox" id="simInputB" aria-label="Input B">
                                    <label class="slider" for="simInputB"></label>
                                </div>
                                <div class="input-label">Input B</div>
                            </div>
                        </div>
                        <div class="output-container" style="display:flex;flex-direction:column;align-items:center;gap:0.7rem;min-width:120px;">
                            <div class="led-output" id="simLed" role="img" aria-label="Output LED" tabindex="0"></div>
                            <div class="input-label">Output: <span id="simOutputValue">0 (LOW)</span></div>
                            <div class="input-label" id="simGateLabel">Gate: AND</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Lab 3 -->
            <section id="lab3" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 3: Simplifying complicated formulas</h2>
                </div>
                <h3 class="section-title">Objectives:</h3>
                <p>The purpose of the lab is to use the Boolean Algebra axioms and theories taught in the course to simplify complicated formula into simplified ones with minimum number of terms and literals.</p>
                <h3 class="section-title">Experiment requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7404</div>
                    <div class="ic-table-cell" role="cell">Hex inverter</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7408</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input AND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7432</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input OR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>

                <h3 class="section-title">Procedure:</h3>
                <ol style="margin-left: 1.5rem; color: var(--light); font-size: 1.08rem; line-height: 1.8;">
                    <li>
                    Implement the following function using logic gates:
                    <div class="equation-box">
                        <span style="font-weight:600;">F = X' + X·Y + X·Z' + X·(Y·Z)'</span>
                    </div>
                    <p>Get the truth table of the function. Write it down in the results part.</p>
                    </li>
                    <li>Simplify the previous function into minimum number of literals, implement it using logic gates, and then verify the truth table of the previous step.</li>
                </ol>
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth table for the function:</b></p>
                <div class="equation-box">
                    <span style="font-weight:600;">F = X' + X·Y + X·Z' + X·(Y·Z)'</span>
                    </div>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="lab3-truth-table">
                    <thead>
                      <tr>
                        <th>X</th>
                        <th>Y</th>
                        <th>Z</th>
                        <th>F</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab3" data-x="0" data-y="0" data-z="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab3" data-x="0" data-y="0" data-z="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab3" data-x="0" data-y="1" data-z="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab3" data-x="0" data-y="1" data-z="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab3" data-x="1" data-y="0" data-z="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab3" data-x="1" data-y="0" data-z="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab3" data-x="1" data-y="1" data-z="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab3" data-x="1" data-y="1" data-z="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 1"></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn-lab3" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn-lab3" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <p><b>2. Simplify the function into minimum number of literals. Write all the steps clearly.</b></p>
                <div class="simplification-question-box">
                    <div class="question-header">
                        <h4>Simplify the function F = X' + X·Y + X·Z' + X·(Y·Z)' step by step:</h4>
                        <button id="show-answer-btn-lab3" type="button" class="btn btn-accent" style="min-width:140px;">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                    </div>
                    <div class="rich-editor-container">
                        <div class="editor-toolbar">
                            <!-- Text Formatting -->
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough (Ctrl+S)">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Mathematical Notation -->
                            <button type="button" class="toolbar-btn" data-command="subscript" title="Subscript (Ctrl+Shift+S)">
                                <i class="fas fa-subscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript (Ctrl+Shift+P)">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="Σ" title="Sum Symbol (Σ)">
                                <span style="font-weight: bold; font-size: 1.1em;">Σ</span>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="π" title="Pi Symbol (π)">
                                <span style="font-weight: bold; font-size: 1.1em;">π</span>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Lists -->
                            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List (Ctrl+Shift+L)">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List (Ctrl+Shift+O)">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Alignment -->
                            <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left (Ctrl+Shift+L)">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center (Ctrl+Shift+C)">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right (Ctrl+Shift+R)">
                                <i class="fas fa-align-right"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Utility Functions -->
                            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                            <button type="button" class="toolbar-btn clear-format" data-command="removeFormat" title="Clear Formatting (Ctrl+Shift+F)">
                                <i class="fas fa-eraser"></i>
                            </button>
                        </div>
                        <div id="simplification-editor-lab3" class="rich-editor" contenteditable="true" 
                             placeholder="Type your step-by-step simplification here..."></div>
                    </div>
                </div>
                
                <p id="question3-lab3-text"><b>3. Sketch the logic diagram of both the function F before and after the simplification.</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab3" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab3" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab3" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--accent);">Eraser</span>
                          <input type="range" id="eraserSizeLab3" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab3" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab3" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab3" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab3" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab3">100%</span>
                        <button id="downloadCanvasLab3" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab3" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab3" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                  </section>
                <!-- Boolean Expression Simulator MOVED HERE -->
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="booleanSimTitle">
                    <h3 class="section-title" id="booleanSimTitle">Boolean Expression Simulator</h3>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputX" aria-label="Input X">
                                    <label class="slider" for="boolSimInputX"></label>
                                </div>
                                <div class="input-label">input X</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputY" aria-label="Input Y">
                                    <label class="slider" for="boolSimInputY"></label>
                                </div>
                                <div class="input-label">input Y</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputZ" aria-label="Input Z">
                                    <label class="slider" for="boolSimInputZ"></label>
                                </div>
                                <div class="input-label">input Z</div>
                            </div>
                        </div>
                        <div class="boolean-sim-equation">
                            <div class="equation-box circuit-border" style="margin-bottom:0;">
                                <div style="font-weight:600;">F = X' + X·Y + X·Z' + X·(Y·Z)'</div>
                            </div>
                        </div>
                        <div class="boolean-sim-output">
                            <div class="led-output" id="boolSimLed" role="img" aria-label="Output LED" tabindex="0"></div>
                            <div class="input-label">Output: <span id="boolSimOutput">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
                <script>
                // Boolean Expression Simulator Logic for Lab 3 (matches Lab 1/2 structure)
                function evaluateLab3Sim(x, y, z) {
                  // F = X' + X·Y + X·Z' + X·(Y·Z)'
                  // This function is a tautology (always 1)
                  x = Number(x); y = Number(y); z = Number(z);
                  return 1; // F is always 1 regardless of X, Y, Z values
                }
                function updateLab3Sim() {
                  const X = document.getElementById('boolSimInputX').checked;
                  const Y = document.getElementById('boolSimInputY').checked;
                  const Z = document.getElementById('boolSimInputZ').checked;
                  const led = document.getElementById('boolSimLed');
                  const output = document.getElementById('boolSimOutput');
                  const F = evaluateLab3Sim(X, Y, Z);
                  if (F) {
                    led.classList.add('active');
                    led.setAttribute('aria-label', 'Output LED is ON');
                    output.textContent = '1 (HIGH)';
                    output.style.color = '#2ecc71';
                  } else {
                    led.classList.remove('active');
                    led.setAttribute('aria-label', 'Output LED is OFF');
                    output.textContent = '0 (LOW)';
                    output.style.color = '#e74c3c';
                  }
                }
                document.addEventListener('DOMContentLoaded', function() {
                  ['boolSimInputX','boolSimInputY','boolSimInputZ'].forEach(id => {
                    const el = document.getElementById(id);
                    el.addEventListener('change', updateLab3Sim);
                    el.addEventListener('keydown', function(e) {
                      if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        el.checked = !el.checked;
                        updateLab3Sim();
                      }
                    });
                  });
                  updateLab3Sim();
                });
                </script>
            </section>
            
                            <!-- Answer Modal for Lab 3 -->
                <div id="answer-modal-lab3" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="modal-title-lab3" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                    <div class="modal-header">
                        <h3 id="modal-title-lab3">Simplification Answer Comparison</h3>
                        <button class="modal-close" id="close-modal-lab3" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-content">
                        <div class="answer-comparison">
                            <div class="answer-section">
                                <h4>Your Answer:</h4>
                                <div id="user-answer-display-lab3" class="answer-display"></div>
                            </div>
                            <div class="answer-section">
                                <h4>Correct Answer:</h4>
                                <div id="correct-answer-display-lab3" class="answer-display correct-answer">
                                    <div class="math-solution">
                                        <p><strong>Here's the step-by-step simplification:</strong></p>
                                        <div class="math-equation">
                                            <p>F = X' + X·Y + X·Z' + X·(Y·Z)'</p>
                                            <p>Using De Morgan's Law: (Y·Z)' = Y' + Z'</p>
                                            <p>F = X' + X·Y + X·Z' + X(Y' + Z')</p>
                                            <p>F = X' + X·Y + X·Z' + X·Y' + X·Z'</p>
                                            <p>F = X' + X·Y + X·Y' + X·Z' (remove duplicate X·Z')</p>
                                            <p>F = X' + X(Y + Y') + X·Z'</p>
                                            <p>F = X' + X·1 + X·Z'</p>
                                            <p>F = X' + X + X·Z'</p>
                                            <p>F = 1 + X·Z'</p>
                                            <p><strong>F = 1</strong></p>
                                        </div>
                                        <p><strong>So F is a tautology (always 1), independent of Y and Z.</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" id="copy-answer-btn-lab3">
                            <i class="fas fa-copy"></i> Copy Correct Answer
                        </button>
                        <button class="btn btn-secondary" id="close-modal-footer-lab3">Close</button>
                    </div>
                </div>
            </div>
            
            <!-- Lab 4 -->
            <section id="lab4" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 4: Simplifying complicated formulas (cont.)</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>The purpose of the third lab is to use the Boolean algebra axioms and theories taught in the course to simplify complicated formula into simplified ones with minimum number of terms and literals.</p>
                
                <h3 class="section-title">Experiment requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7404</div>
                    <div class="ic-table-cell" role="cell">Hex inverter</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7408</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input AND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7432</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input OR gate</div>
                    <div class="ic-table-cell" role="cell">2</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ol style="margin-left: 1.5rem; color: var(--light); font-size: 1.08rem; line-height: 1.8;">
                  <li>
                    Implement the following function using logic gates:
                    <div class="equation-box">
                        <span style="font-weight:600;">F = (A'+C)(A'+C')(A+B+C'D)</span>
                    </div>
                    <p>Get the truth table of the function. Write it down in the results part.</p>
                  </li>
                  <li>Simplify the previous function into minimum number of literals, implement it using logic gates, and then verify the truth table of the previous step.</li>
                </ol>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth table for the function:</b></p>
                <div class="equation-box">
                    <span style="font-weight:600;">F = (A'+C)(A'+C')(A+B+C'D)</span>
                </div>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="lab4-truth-table">
                    <thead>
                    <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>F</th>
                    </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 0 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 0 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 1 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 1 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 0 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 0 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 1 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="0" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 1 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 0 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 0 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 1 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 1 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 0 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 0 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 1 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab4" data-a="1" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 1 1"></td>
                    </tr>
                    </tbody>
                </table>
                </div>
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn-lab4" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn-lab4" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <p><b>2. Simplify the function into minimum number of literals. Write all the steps clearly.</b></p>
                <div class="simplification-question-box">
                    <div class="question-header">
                        <h4>Simplify the function F = (A'+C)(A'+C')(A+B+C'D) step by step:</h4>
                        <button id="show-answer-btn-lab4" type="button" class="btn btn-accent" style="min-width:140px;">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                </div>
                    <div class="rich-editor-container">
                        <div class="editor-toolbar">
                            <!-- Text Formatting -->
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough (Ctrl+S)">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Mathematical Notation -->
                            <button type="button" class="toolbar-btn" data-command="subscript" title="Subscript (Ctrl+Shift+S)">
                                <i class="fas fa-subscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript (Ctrl+Shift+P)">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="Σ" title="Sum Symbol (Σ)">
                                <span style="font-weight: bold; font-size: 1.1em;">Σ</span>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="π" title="Pi Symbol (π)">
                                <span style="font-weight: bold; font-size: 1.1em;">π</span>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Lists -->
                            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List (Ctrl+Shift+L)">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List (Ctrl+Shift+O)">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Alignment -->
                            <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left (Ctrl+Shift+L)">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center (Ctrl+Shift+C)">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right (Ctrl+Shift+R)">
                                <i class="fas fa-align-right"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Utility Functions -->
                            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                            <button type="button" class="toolbar-btn clear-format" data-command="removeFormat" title="Clear Formatting (Ctrl+Shift+F)">
                                <i class="fas fa-eraser"></i>
                            </button>
                </div>
                        <div id="simplification-editor-lab4" class="rich-editor" contenteditable="true" 
                             placeholder="Type your step-by-step simplification here..."></div>
                    </div>
                </div>
                
                <p id="question4-lab4-text"><b>3. Sketch the logic diagram of both the function F before and after the simplification.</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab4" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab4" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab4" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--accent);">Eraser</span>
                          <input type="range" id="eraserSizeLab4" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab4" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab4" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab4" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab4" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab4">100%</span>
                        <button id="downloadCanvasLab4" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                </div>
                    </div>
                    <div id="drawingContainerLab4" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab4" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
            </section>
                
                <!-- Boolean Expression Simulator for Lab 4 -->
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="booleanSimTitleLab4">
                    <h3 class="section-title" id="booleanSimTitleLab4">Boolean Expression Simulator</h3>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputALab4" aria-label="Input A">
                                    <label class="slider" for="boolSimInputALab4"></label>
                                </div>
                                <div class="input-label">Input A</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputBLab4" aria-label="Input B">
                                    <label class="slider" for="boolSimInputBLab4"></label>
                                </div>
                                <div class="input-label">Input B</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputCLab4" aria-label="Input C">
                                    <label class="slider" for="boolSimInputCLab4"></label>
                                </div>
                                <div class="input-label">Input C</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputDLab4" aria-label="Input D">
                                    <label class="slider" for="boolSimInputDLab4"></label>
                                </div>
                                <div class="input-label">Input D</div>
                            </div>
                        </div>
                        <div class="boolean-sim-equation">
                            <div class="equation-box circuit-border" style="margin-bottom:0;">
                                <div style="font-weight:600;">F = (A'+C)(A'+C')(A+B+C'D)</div>
                            </div>
                        </div>
                        <div class="boolean-sim-output">
                            <div class="led-output" id="boolSimLedLab4" role="img" aria-label="Output LED" tabindex="0"></div>
                            <div class="input-label">Output: <span id="boolSimOutputLab4">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
                
                <script>
                // Boolean Expression Simulator Logic for Lab 4
                function updateLab4Sim() {
                  const A = document.getElementById('boolSimInputALab4').checked;
                  const B = document.getElementById('boolSimInputBLab4').checked;
                  const C = document.getElementById('boolSimInputCLab4').checked;
                  const D = document.getElementById('boolSimInputDLab4').checked;
                  const led = document.getElementById('boolSimLedLab4');
                  const output = document.getElementById('boolSimOutputLab4');
                  const F = evaluateLab4F(A, B, C, D);
                  if (F) {
                    led.classList.add('active');
                    led.setAttribute('aria-label', 'Output LED is ON');
                    output.textContent = '1 (HIGH)';
                    output.style.color = '#2ecc71';
                  } else {
                    led.classList.remove('active');
                    led.setAttribute('aria-label', 'Output LED is OFF');
                    output.textContent = '0 (LOW)';
                    output.style.color = '#e74c3c';
                  }
                }
                document.addEventListener('DOMContentLoaded', function() {
                  ['boolSimInputALab4','boolSimInputBLab4','boolSimInputCLab4','boolSimInputDLab4'].forEach(id => {
                    const el = document.getElementById(id);
                    el.addEventListener('change', updateLab4Sim);
                    el.addEventListener('keydown', function(e) {
                      if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        el.checked = !el.checked;
                        updateLab4Sim();
                      }
                    });
                  });
                  updateLab4Sim();
                });
                </script>
            </section>
            
                            <!-- Answer Modal for Lab 4 -->
                <div id="answer-modal-lab4" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="modal-title-lab4" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                    <div class="modal-header">
                        <h3 id="modal-title-lab4">Simplification Answer Comparison</h3>
                        <button class="modal-close" id="close-modal-lab4" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-content">
                        <div class="answer-comparison">
                            <div class="answer-section">
                                <h4>Your Answer:</h4>
                                <div id="user-answer-display-lab4" class="answer-display"></div>
                            </div>
                            <div class="answer-section">
                                <h4>Correct Answer:</h4>
                                <div id="correct-answer-display-lab4" class="answer-display correct-answer">
                                    <div class="math-solution">
                                        <p><strong>Here's a clean Boolean-algebra simplification, step by step:</strong></p>
                                        
                                        <div class="math-equation">
                                            <h4>Step 1: Collapse the First Two Factors</h4>
                                            <p><strong>Using the identity (X+Y)(X+Z) = X+YZ:</strong></p>
                                            <p>(A'+C)(A'+C') = A' + CC' = A' + 0 = A'</p>
                                            <p><strong>Explanation:</strong> When we have (X+Y)(X+Z), we can factor out X and get X + YZ.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 2: Substitute Back into F</h4>
                                            <p><strong>Original function:</strong> F = (A'+C)(A'+C')(A+B+C'D)</p>
                                            <p><strong>After Step 1:</strong> F = A'(A+B+C'D)</p>
                                            <p><strong>Explanation:</strong> We replace the first two factors with their simplified form A'.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 3: Distribute A' and Simplify</h4>
                                            <p><strong>Distribute A' over the remaining expression:</strong></p>
                                            <p>A'(A+B+C'D) = A'A + A'B + A'C'D</p>
                                            <p><strong>Use the identity AA' = 0:</strong></p>
                                            <p>A'A + A'B + A'C'D = 0 + A'B + A'C'D = A'B + A'C'D</p>
                                            <p><strong>Explanation:</strong> A'A = 0 because A and A' are complements, and 0 + X = X.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 4: Optional Factoring</h4>
                                            <p><strong>Factor out A' from the remaining terms:</strong></p>
                                            <p>A'B + A'C'D = A'(B + C'D)</p>
                                            <p><strong>Explanation:</strong> This gives us a more compact factored form.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Final Answer</h4>
                                            <p><strong>Simplified function:</strong></p>
                                            <p>F = A'B + A'C'D</p>
                                            <p><strong>Factored form:</strong></p>
                                            <p>F = A'(B + C'D)</p>
                                            <p><strong>Verification:</strong> Both forms are equivalent and represent the same Boolean function.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" id="copy-answer-btn-lab4">
                            <i class="fas fa-copy"></i> Copy Correct Answer
                        </button>
                        <button class="btn btn-secondary" id="close-modal-footer-lab4">Close</button>
                    </div>
                </div>
            </div>
            
            <!-- Lab 5 -->
            <section id="lab5" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 5: Using K-maps</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>The purpose of this lab is to be able to get the truth table of the function, get an expression from that table and then use K-maps to obtain the minimized function.</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>The requirements depend on the expression that you will obtain.</p>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Implement the function of a 4 input (4 bits) majority encoder <strong>(a circuit whose output is one if the majority of its inputs is one and its output is zero otherwise, e.g. if the input is 1011 the output is 0 and if the input is 1110 the output is 1)</strong></li>
                    <li>Obtain the truth table of the circuit.</li>
                    <li>Get the expression of the circuit function using min-terms</li>
                    <li>Simplify the expression using k-map</li>
                    <li>Implement using logic gates</li>
                </ul>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth table for the function:</b></p>
                <div class="equation-box">
                    <span style="font-weight:600;">X = 1 if majority of inputs (A, B, C, D) is 1, otherwise 0</span>
                </div>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="lab5-truth-table">
                    <thead>
                    <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>X</th>
                    </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 0 0 0 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 0 0 0 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 0 0 1 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 0 0 1 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 0 1 0 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 0 1 0 1"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 0 1 1 0"></td>
                    </tr>
                    <tr>
                        <td>0</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="0" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 0 1 1 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 1 0 0 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 1 0 0 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 1 0 1 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 1 0 1 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 1 1 0 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 1 1 0 1"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="X output for 1 1 1 0"></td>
                    </tr>
                    <tr>
                        <td>1</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab5" data-a="1" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="X output for 1 1 1 1"></td>
                    </tr>
                    </tbody>
                </table>
                </div>
                
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn-lab5" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn-lab5" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <p><b>2. Get the function expression using min-terms?</b></p>
                <div class="simplification-question-box">
                    <div class="question-header">
                        <h4>Get the function expression using min-terms for the 4-input majority encoder:</h4>
                        <button id="show-answer-btn-lab5" type="button" class="btn btn-accent" style="min-width:140px;">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                    </div>
                    <div class="rich-editor-container">
                        <div class="editor-toolbar">
                            <!-- Text Formatting -->
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough (Ctrl+S)">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Mathematical Notation -->
                            <button type="button" class="toolbar-btn" data-command="subscript" title="Subscript (Ctrl+Shift+S)">
                                <i class="fas fa-subscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript (Ctrl+Shift+P)">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="Σ" title="Sum Symbol (Σ)">
                                <span style="font-weight: bold; font-size: 1.1em;">Σ</span>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="π" title="Pi Symbol (π)">
                                <span style="font-weight: bold; font-size: 1.1em;">π</span>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Lists -->
                            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List (Ctrl+Shift+L)">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List (Ctrl+Shift+O)">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Alignment -->
                            <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left (Ctrl+Shift+L)">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center (Ctrl+Shift+C)">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right (Ctrl+Shift+R)">
                                <i class="fas fa-align-right"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Utility Functions -->
                            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                            <button type="button" class="toolbar-btn clear-format" data-command="removeFormat" title="Clear Formatting (Ctrl+Shift+F)">
                                <i class="fas fa-eraser"></i>
                            </button>
                        </div>
                        <div id="simplification-editor-lab5" class="rich-editor" contenteditable="true" 
                             placeholder="Type your step-by-step solution here..."></div>
                    </div>
                </div>
                
                <p><b>3. Simplify it using k-maps</b></p>
                
                <div class="k-map-section">
                    <div class="k-map-container">
                        <h4>Fill the K-Map for the 4-input majority encoder:</h4>
                                                <div class="k-map" id="k-map-lab5">
                    <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">AB</div>
                            <div class="k-map-cell k-map-header">AB'</div>
                            <div class="k-map-cell k-map-header">A'B'</div>
                            <div class="k-map-cell k-map-header">A'B</div>
                            
                            <div class="k-map-cell k-map-header">CD</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB (1111)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB' (1101)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B' (1001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B (1011)">
                            
                            <div class="k-map-cell k-map-header">CD'</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB (1110)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB' (1100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B' (1000)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B (1010)">
                            
                            <div class="k-map-cell k-map-header">C'D'</div>
                            <input type="text" class="k-map-input" data-row="2" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB (0110)">
                            <input type="text" class="k-map-input" data-row="2" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB' (0100)">
                            <input type="text" class="k-map-input" data-row="2" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B' (0000)">
                            <input type="text" class="k-map-input" data-row="2" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B (0010)">
                            
                            <div class="k-map-cell k-map-header">C'D</div>
                            <input type="text" class="k-map-input" data-row="3" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB (0111)">
                            <input type="text" class="k-map-input" data-row="3" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB' (0101)">
                            <input type="text" class="k-map-input" data-row="3" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B' (0001)">
                            <input type="text" class="k-map-input" data-row="3" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B (0011)">
                </div>
                
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab5" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab5" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                </div>
                
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab5-simple-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                </div>
                            <div id="kmap-simplification-editor-lab5" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab5" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- K-Map Answer Modal for Lab 5 -->
                <div id="kmap-answer-modal-lab5" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab5" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3 id="kmap-modal-title-lab5">K-Map Simplification Answer</h3>
                            <button class="modal-close" id="close-kmap-modal-lab5" aria-label="Close modal">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-content">
                            <div class="kmap-modal-layout">
                                <!-- Left Side: User's Answers -->
                                <div class="kmap-left-panel">
                                    <div class="answer-section">
                                        <h4>Your K-Map Values:</h4>
                                        <div id="user-kmap-display-lab5" class="answer-display compact"></div>
                                    </div>
                                    <div class="answer-section">
                                        <h4>Your Simplified Expression:</h4>
                                        <div id="user-expression-display-lab5" class="answer-display compact"></div>
                                    </div>
                                </div>
                                
                                <!-- Right Side: Correct Answers -->
                                <div class="kmap-right-panel">
                                    <div class="answer-section">
                                        <h4>Correct K-Map:</h4>
                                        <div id="correct-kmap-display-lab5" class="answer-display correct-answer">
                                            <div class="kmap-grid-display">
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">CD\AB</div>
                                                    <div class="kmap-header-cell">AB</div>
                                                    <div class="kmap-header-cell">AB'</div>
                                                    <div class="kmap-header-cell">A'B'</div>
                                                    <div class="kmap-header-cell">A'B</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">CD</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">1</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">CD'</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">C'D'</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">C'D</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="answer-section">
                                        <h4>Correct Simplified Expression:</h4>
                                        <div id="correct-expression-display-lab5" class="answer-display correct-answer compact">
                                            <p><strong>F = ABC + ABD + ACD + BCD</strong></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Explanation Below -->
                            <div class="kmap-explanation">
                                <h4>Detailed Solution Explanation:</h4>
                                <div class="math-solution">
                                    <div class="math-equation">
                                        <h5>Step 1: Understanding the K-Map Structure</h5>
                                        <p>The K-Map is organized as follows:</p>
                                        <ul>
                                            <li><strong>Rows:</strong> CD, CD', C'D', C'D (representing C and D combinations)</li>
                                            <li><strong>Columns:</strong> AB, AB', A'B', A'B (representing A and B combinations)</li>
                                            <li><strong>Cell values:</strong> 1 for majority cases (≥3 inputs are 1), 0 otherwise</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>Step 2: Truth Table to K-Map Mapping</h5>
                                        <p>Based on the majority encoder logic (X = 1 when ≥3 inputs are 1):</p>
                                        <ul>
                                            <li><strong>CD-AB (1111):</strong> 1 (all 4 inputs are 1)</li>
                                            <li><strong>CD-AB' (1101):</strong> 1 (3 inputs are 1: A=1, B=1, D=1)</li>
                                            <li><strong>CD-A'B' (1001):</strong> 0 (only 2 inputs are 1: C=1, D=1)</li>
                                            <li><strong>CD-A'B (1011):</strong> 1 (3 inputs are 1: A=1, C=1, D=1)</li>
                                            <li><strong>CD'-AB (1110):</strong> 1 (3 inputs are 1: A=1, B=1, C=1)</li>
                                            <li><strong>CD'-AB' (1100):</strong> 0 (only 2 inputs are 1: A=1, B=1)</li>
                                            <li><strong>CD'-A'B' (1000):</strong> 0 (only 1 input is 1: C=1)</li>
                                            <li><strong>CD'-A'B (1010):</strong> 0 (only 2 inputs are 1: A=1, C=1)</li>
                                            <li><strong>C'D'-AB (0110):</strong> 0 (only 2 inputs are 1: A=1, B=1)</li>
                                            <li><strong>C'D'-AB' (0100):</strong> 0 (only 1 input is 1: B=1)</li>
                                            <li><strong>C'D'-A'B' (0000):</strong> 0 (no inputs are 1)</li>
                                            <li><strong>C'D'-A'B (0010):</strong> 0 (only 1 input is 1: B=1)</li>
                                            <li><strong>C'D-AB (0111):</strong> 1 (3 inputs are 1: A=1, B=1, D=1)</li>
                                            <li><strong>C'D-AB' (0101):</strong> 0 (only 2 inputs are 1: B=1, D=1)</li>
                                            <li><strong>C'D-A'B' (0001):</strong> 0 (only 1 input is 1: D=1)</li>
                                            <li><strong>C'D-A'B (0011):</strong> 0 (only 2 inputs are 1: B=1, D=1)</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>Step 3: Grouping and Simplification</h5>
                                        <p>Looking at the K-Map, we can group the 1s:</p>
                                        <ul>
                                            <li><strong>Group 1:</strong> CD-AB, CD-AB', CD-A'B, CD'-AB (forms ABC)</li>
                                            <li><strong>Group 2:</strong> CD-AB, CD-AB', CD-A'B, C'D-AB (forms ABD)</li>
                                            <li><strong>Group 3:</strong> CD-AB, CD-A'B, CD'-AB, C'D-AB (forms ACD)</li>
                                            <li><strong>Group 4:</strong> CD-AB', CD-A'B, CD'-AB, C'D-AB (forms BCD)</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>Final Answer</h5>
                                        <p><strong>Simplified expression from K-Map:</strong></p>
                                        <p>F = ABC + ABD + ACD + BCD</p>
                                        <p><strong>Verification:</strong> This function outputs 1 when any 3 or more inputs are 1, which matches our majority requirement.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" id="copy-kmap-answer-btn-lab5">
                                <i class="fas fa-copy"></i> Copy Correct Answer
                            </button>
                            <button class="btn btn-secondary" id="close-kmap-modal-footer-lab5">Close</button>
                        </div>
                    </div>
                </div>
                
                <p id="question5-lab5-text"><b>4. Sketch the logic and circuit diagrams of your implementation.</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab5" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab5" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab5" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--accent);">Eraser</span>
                          <input type="range" id="eraserSizeLab5" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab5" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab5" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab5" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab5" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab5">100%</span>
                        <button id="downloadCanvasLab5" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab5" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab5" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
            </section>
                
                <!-- Boolean Expression Simulator for Lab 5 -->
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="booleanSimTitleLab5">
                    <h3 class="section-title" id="booleanSimTitleLab5">Boolean Expression Simulator</h3>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputALab5" aria-label="Input A">
                                    <label class="slider" for="boolSimInputALab5"></label>
                                </div>
                                <div class="input-label">Input A</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputBLab5" aria-label="Input B">
                                    <label class="slider" for="boolSimInputBLab5"></label>
                                </div>
                                <div class="input-label">Input B</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputCLab5" aria-label="Input C">
                                    <label class="slider" for="boolSimInputCLab5"></label>
                                </div>
                                <div class="input-label">Input C</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="boolSimInputDLab5" aria-label="Input D">
                                    <label class="slider" for="boolSimInputDLab5"></label>
                                </div>
                                <div class="input-label">Input D</div>
                            </div>
                        </div>
                        <div class="boolean-sim-equation">
                            <div class="equation-box circuit-border" style="margin-bottom:0;">
                                <div style="font-weight:600;">F = ABC + ABD + ACD + BCD</div>
                            </div>
                        </div>
                        <div class="boolean-sim-output">
                            <div class="led-output" id="boolSimLedLab5" role="img" aria-label="Output LED" tabindex="0"></div>
                            <div class="input-label">Output: <span id="boolSimOutputLab5">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
                
                <script>
                // Boolean Expression Simulator Logic for Lab 5
                function updateLab5Sim() {
                  const A = document.getElementById('boolSimInputALab5').checked;
                  const B = document.getElementById('boolSimInputBLab5').checked;
                  const C = document.getElementById('boolSimInputCLab5').checked;
                  const D = document.getElementById('boolSimInputDLab5').checked;
                  const led = document.getElementById('boolSimLedLab5');
                  const output = document.getElementById('boolSimOutputLab5');
                  const F = evaluateLab5X(A, B, C, D);
                  if (F) {
                    led.classList.add('active');
                    led.setAttribute('aria-label', 'Output LED is ON');
                    output.textContent = '1 (HIGH)';
                    output.style.color = '#2ecc71';
                  } else {
                    led.classList.remove('active');
                    led.setAttribute('aria-label', 'Output LED is OFF');
                    output.textContent = '0 (LOW)';
                    output.style.color = '#e74c3c';
                  }
                }
                document.addEventListener('DOMContentLoaded', function() {
                  ['boolSimInputALab5','boolSimInputBLab5','boolSimInputCLab5','boolSimInputDLab5'].forEach(id => {
                    const el = document.getElementById(id);
                    el.addEventListener('change', updateLab5Sim);
                    el.addEventListener('keydown', function(e) {
                      if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        el.checked = !el.checked;
                        updateLab5Sim();
                      }
                    });
                  });
                  updateLab5Sim();
                });
                </script>
            </section>
            
                            <!-- Answer Modal for Lab 5 -->
                <div id="answer-modal-lab5" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="modal-title-lab5" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                    <div class="modal-header">
                        <h3 id="modal-title-lab5">Minterm Expression Answer</h3>
                        <button class="modal-close" id="close-modal-lab5" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-content">
                        <div class="answer-comparison">
                            <div class="answer-section">
                                <h4>Your Answer:</h4>
                                <div id="user-answer-display-lab5" class="answer-display"></div>
                            </div>
                            <div class="answer-section">
                                <h4>Correct Answer:</h4>
                                <div id="correct-answer-display-lab5" class="answer-display correct-answer">
                                    <div class="math-solution">
                                        <p><strong>Here's the complete step-by-step solution for the 4-input majority encoder:</strong></p>
                                        
                                        <div class="math-equation">
                                            <h4>Step 1: Understanding the Problem</h4>
                                            <p>We need the function of a <strong>4-input majority encoder</strong>:</p>
                                            <ul>
                                                <li>Inputs: A, B, C, D (4 bits)</li>
                                                <li>Output: F</li>
                                                <li>F = 1 <strong>if the majority (≥ 3 of 4 inputs) are 1</strong></li>
                                                <li>F = 0 otherwise</li>
                                            </ul>
                                            
                                            <p><strong>Example Analysis:</strong></p>
                                            <ul>
                                                <li>1011 → has <strong>3 ones</strong> → majority 1 → output should be <strong>1</strong></li>
                                                <li>1110 → has <strong>3 ones</strong> → majority 1 → output should be <strong>1</strong></li>
                                            </ul>
                                            
                                            <p><strong>Note:</strong> The description mentions "if input is 1011 the output is 0" which seems inconsistent.<br>
                                            Logically, 1011 = 3 ones, so output = 1.<br>
                                            We'll use the <strong>standard majority rule (≥3 ones → output 1)</strong>.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 2: List All Cases</h4>
                                            <p>Total possible inputs: 16 (2⁴)</p>
                                            <p>Output F = 1 for inputs with <strong>3 or 4 ones</strong>:</p>
                                            <ul>
                                                <li><strong>3 ones:</strong> 1110, 1101, 1011, 0111</li>
                                                <li><strong>4 ones:</strong> 1111</li>
                                            </ul>
                                            <p><strong>Minterm identification:</strong></p>
                                            <p>m₇, m₁₁, m₁₃, m₁₄, m₁₅</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 3: Write Minterm Expression</h4>
                                            <p><strong>Canonical SOP (Sum of Products):</strong></p>
                                            <p>F(A,B,C,D) = Σm(7, 11, 13, 14, 15)</p>
                                            <p><strong>Expanded form:</strong></p>
                                            <p>F = A'BCD + AB'CD + ABC'D + ABCD' + ABCD</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 4: Simplify the Expression</h4>
                                            <p><strong>Key insight:</strong> ABCD is already covered by the 3-input combinations.</p>
                                            <p>When you OR with groups of 3 ones, ABCD becomes redundant.</p>
                                            <p><strong>Simplification process:</strong></p>
                                            <p>Group minterms with 3 ones:</p>
                                            <p>F = (ABC) + (ABD) + (ACD) + (BCD)</p>
                                            <p>This represents the <strong>simplified majority function</strong>.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Final Answer</h4>
                                            <p><strong>Minterm expression:</strong></p>
                                            <p>F(A,B,C,D) = Σm(7, 11, 13, 14, 15)</p>
                                            <p>= A'BCD + AB'CD + ABC'D + ABCD' + ABCD</p>
                                            
                                            <p><strong>Simplified expression (majority function):</strong></p>
                                            <p>F = ABC + ABD + ACD + BCD</p>
                                            
                                            <p><strong>Verification:</strong> This function outputs 1 when any 3 or more inputs are 1, which matches our majority requirement.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" id="copy-answer-btn-lab5">
                            <i class="fas fa-copy"></i> Copy Correct Answer
                        </button>
                        <button class="btn btn-secondary" id="close-modal-footer-lab5">Close</button>
                    </div>
                </div>
            </div>
            
            <!-- Lab 6: Using K-maps (cont.) -->
            <section id="lab6" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 6: Using K-maps (cont.)</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>The purpose of the lab is to be able to use K-maps to get the simplified expression for a given function, and to implement functions using a certain type of gates.</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>The requirements depend on the expression that you will obtain.</p>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Simplify the following function F together with the don't care conditions d using k-map, then implement it using logic gates
                        <div class="equation-box" style="text-align: center; margin: 15px 0;">
                            <div style="font-weight: 600; margin-bottom: 10px;">F(A,B,C,D) = Σ(1,3,5,7,9,15)</div>
                            <div style="font-weight: 600;">d(A,B,C,D) = Σ(4,6,12,13)</div>
                        </div>
                    </li>
                    <li>Simplify the following function and then implement it using two-level NAND gate circuits.
                        <div class="equation-box" style="text-align: center; margin: 15px 0;">
                            <div style="font-weight: 600;">H = AB' + ABC + ABD' + A'C'D' + A'BC'</div>
                        </div>
                    </li>
                </ul>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Simplify the function of question 1</b></p>
                
                <div class="k-map-section">
                    <div class="k-map-container">
                        <h4>Fill the K-Map for the function F(A,B,C,D) = Σ(1,3,5,7,9,15) and use don't care conditions d(A,B,C,D) = Σ(4,6,12,13) to simplify the function:</h4>
                        <div class="k-map" id="k-map-lab6">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">AB</div>
                            <div class="k-map-cell k-map-header">AB'</div>
                            <div class="k-map-cell k-map-header">A'B'</div>
                            <div class="k-map-cell k-map-header">A'B</div>
                            
                            <div class="k-map-cell k-map-header">CD</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB (1111)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB' (1101)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B' (1001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B (1011)">
                            
                            <div class="k-map-cell k-map-header">CD'</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB (1110)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB' (1100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B' (1000)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B (1010)">
                            
                            <div class="k-map-cell k-map-header">C'D'</div>
                            <input type="text" class="k-map-input" data-row="2" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB (0110)">
                            <input type="text" class="k-map-input" data-row="2" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB' (0100)">
                            <input type="text" class="k-map-input" data-row="2" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B' (0000)">
                            <input type="text" class="k-map-input" data-row="2" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B (0010)">
                            
                            <div class="k-map-cell k-map-header">C'D</div>
                            <input type="text" class="k-map-input" data-row="3" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB (0111)">
                            <input type="text" class="k-map-input" data-row="3" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB' (0101)">
                            <input type="text" class="k-map-input" data-row="3" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B' (0001)">
                            <input type="text" class="k-map-input" data-row="3" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B (0011)">
                </div>
                
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab6" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab6" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab6-simple-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab6" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                </div>
                
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab6" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- K-Map Answer Modal for Lab 6 -->
                <div id="kmap-answer-modal-lab6" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab6" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3 id="kmap-modal-title-lab6">K-Map Simplification Answer</h3>
                            <button class="modal-close" id="close-kmap-modal-lab6" aria-label="Close modal">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-content">
                            <div class="kmap-modal-layout">
                                <!-- Left Side: User's Answers -->
                                <div class="kmap-left-panel">
                                    <div class="answer-section">
                                        <h4>Your K-Map Values:</h4>
                                        <div id="user-kmap-display-lab6" class="answer-display compact"></div>
                                    </div>
                                    <div class="answer-section">
                                        <h4>Your Simplified Expression:</h4>
                                        <div id="user-expression-display-lab6" class="answer-display"></div>
                                    </div>
                                </div>
                                
                                <!-- Right Side: Correct Answer -->
                                <div class="kmap-right-panel">
                                    <div class="answer-section">
                                        <h4>Correct K-Map Values:</h4>
                                        <div id="correct-kmap-display-lab6" class="answer-display compact">
                                            <div class="kmap-grid-display">
                                                <!-- Header Row with Column Labels -->
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell"></div>
                                                    <div class="kmap-header-cell">AB</div>
                                                    <div class="kmap-header-cell">AB'</div>
                                                    <div class="kmap-header-cell">A'B'</div>
                                                    <div class="kmap-header-cell">A'B</div>
                                                </div>
                                                <!-- Data Rows -->
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">CD</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">1</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">CD'</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell dont-care-zero">0</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">C'D'</div>
                                                    <div class="kmap-cell dont-care-zero">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell">0</div>
                                                    <div class="kmap-cell dont-care-zero">0</div>
                                                </div>
                                                <div class="kmap-row">
                                                    <div class="kmap-header-cell">C'D</div>
                                                    <div class="kmap-cell dont-care-one">1</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">1</div>
                                                    <div class="kmap-cell">1</div>
                                                </div>
                                            </div>
                                            <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                <strong>Note:</strong> Don't care positions (X) are at: CD'-A'B(6), C'D'-A'B(4), C'D'-AB(12), C'D-AB(13)
                                            </p>
                                            <p style="margin-top: 5px; font-size: 0.9em; color: var(--text);">
                                                <strong>Color Coding:</strong> <span style="color: #3498db;">Blue (1)</span> = Don't care converted to 1, <span style="color: #f39c12;">Yellow (0)</span> = Don't care kept as 0
                                            </p>
                                            <p style="margin-top: 5px; font-size: 0.9em; color: var(--text);">
                                                <strong>Don't Care Usage:</strong> <span style="color: #3498db;">C'D-AB(13) → 1</span> (used in grouping), <span style="color: #f39c12;">CD'-A'B(6), C'D'-A'B(4), C'D'-AB(12) → 0</span> (not used)
                                            </p>
                                        </div>
                                    </div>
                                    <div class="answer-section">
                                        <h4>Correct Simplified Expression:</h4>
                                        <div id="correct-expression-display-lab6" class="answer-display correct-answer compact">
                                            <p><strong>F = A'D + C'D + BD</strong></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Explanation Below -->
                            <div class="kmap-explanation">
                                <h4>Detailed Solution Explanation:</h4>
                                <div class="math-solution">
                                    <div class="math-equation">
                                        <h5>1) Convert minterms to binary (A B C D)</h5>
                                        <ul>
                                            <li>1 = 0001</li>
                                            <li>3 = 0011</li>
                                            <li>5 = 0101</li>
                                            <li>7 = 0111</li>
                                            <li>9 = 1001</li>
                                            <li>15 = 1111</li>
                                        </ul>
                                        <p><strong>Don't-cares (X):</strong></p>
                                        <ul>
                                            <li>4 = 0100, 6 = 0110, 12 = 1100, 13 = 1101</li>
                                        </ul>
                                        <p>All the 1's occur with D=1 (odd indices) — this hints D will factor out.</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>2) Place values on a K-map</h5>
                                        <p>Use Gray order: rows AB={00,01,11,10}, columns CD={00,01,11,10}.</p>
                                        <ul>
                                            <li>Put 1's at cells: 1,3,5,7,9,15</li>
                                            <li>Put X's at: 4,6,12,13</li>
                                            <li>Zeros elsewhere</li>
                                        </ul>
                                        <p>(Only group 1's; X's can be used to enlarge groups but don't have to be covered.)</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>3) Make largest power-of-two groups (use X's to help)</h5>
                                        <p>Choose these groups:</p>
                                        <p><strong>G1 (4-cell):</strong> {1,3,5,7}</p>
                                        <ul>
                                            <li>Rows AB=00,01 (so A=0 constant), columns CD=01,11 (so D=1 constant).</li>
                                            <li>Term: A'D.</li>
                                        </ul>
                                        <p><strong>G2 (4-cell using an X):</strong> column CD=01 → {1,5,9,13(X)}</p>
                                        <ul>
                                            <li>Here C=0 and D=1 are constant.</li>
                                            <li>Term: C'D.</li>
                                        </ul>
                                        <p><strong>G3 (2×2 using an X):</strong> rows B=1 (AB=01,11) and columns D=1 (CD=01,11) → {5,7,13(X),15}</p>
                                        <ul>
                                            <li>Here B=1 and D=1 are constant.</li>
                                            <li>Term: BD.</li>
                                        </ul>
                                        <p>These three groups cover all required 1's.</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>4) Write the simplified SOP</h5>
                                        <p>F = A'D + C'D + BD</p>
                                        <p>Factor out D:</p>
                                        <p><strong>F = D(A' + C' + B)</strong></p>
                                        <p>That's the minimal sum-of-products form using the given don't-cares. (Intuitively: the output is 1 only when D=1 <strong>and</strong> at least one of A', C', B is true.)</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" id="copy-kmap-answer-btn-lab6">
                                <i class="fas fa-copy"></i> Copy Correct Answer
                            </button>
                            <button class="btn btn-secondary" id="close-kmap-modal-footer-lab6">Close</button>
                        </div>
                    </div>
                </div>
                
                <p id="question2-lab6-text"><b>2. Sketch the logic and circuit diagrams of the simplified function</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab6" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab6" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab6" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab6" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab6" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab6" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab6" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab6" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab6">100%</span>
                        <button id="downloadCanvasLab6" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab6" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab6" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <p><b>3. Simplify the function of question 2 and Write all the steps clearly.</b></p>
                <div class="simplification-question-box">
                    <div class="question-header">
                        <h4>Simplify the function H = AB' + ABC + ABD' + A'C'D' + A'BC' step by step:</h4>
                        <button id="show-answer-btn-lab6-simplification" type="button" class="btn btn-accent" style="min-width:140px;">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                    </div>
                    <div class="rich-editor-container">
                        <div class="editor-toolbar">
                            <!-- Text Formatting -->
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough (Ctrl+S)">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Mathematical Notation -->
                            <button type="button" class="toolbar-btn" data-command="subscript" title="Subscript (Ctrl+Shift+S)">
                                <i class="fas fa-subscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript (Ctrl+Shift+P)">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="Σ" title="Sum Symbol (Σ)">
                                <span style="font-weight: bold; font-size: 1.1em;">Σ</span>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="π" title="Pi Symbol (π)">
                                <span style="font-weight: bold; font-size: 1.1em;">π</span>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Lists -->
                            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List (Ctrl+Shift+L)">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List (Ctrl+Shift+O)">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Alignment -->
                            <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left (Ctrl+Shift+L)">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center (Ctrl+Shift+C)">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right (Ctrl+Shift+R)">
                                <i class="fas fa-align-right"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Utility Functions -->
                            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                            <button type="button" class="toolbar-btn clear-format" data-command="removeFormat" title="Clear Formatting (Ctrl+Shift+F)">
                                <i class="fas fa-eraser"></i>
                            </button>
                        </div>
                        <div id="simplification-editor-lab6" class="rich-editor" contenteditable="true" 
                             placeholder="Type your step-by-step simplification here..."></div>
                    </div>
                </div>
                
                <!-- Additional K-Map for Function H -->
                <div class="k-map-section" style="margin-top: 2rem;">
                    <div class="k-map-container">
                        <h4>Fill the K-Map for the function H = AB' + ABC + ABD' + A'CD' + A'BC' and simplify:</h4>
                        <div class="k-map" id="k-map-lab6-function-h">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">AB</div>
                            <div class="k-map-cell k-map-header">AB'</div>
                            <div class="k-map-cell k-map-header">A'B'</div>
                            <div class="k-map-cell k-map-header">A'B</div>
                            
                            <div class="k-map-cell k-map-header">CD</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB (1111)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-AB' (1101)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B' (1001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD-A'B (1011)">
                            
                            <div class="k-map-cell k-map-header">CD'</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB (1110)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-AB' (1100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B' (1000)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell CD'-A'B (1010)">
                            
                            <div class="k-map-cell k-map-header">C'D'</div>
                            <input type="text" class="k-map-input" data-row="2" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB (0110)">
                            <input type="text" class="k-map-input" data-row="2" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-AB' (0100)">
                            <input type="text" class="k-map-input" data-row="2" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B' (0000)">
                            <input type="text" class="k-map-input" data-row="2" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D'-A'B (0010)">
                            
                            <div class="k-map-cell k-map-header">C'D</div>
                            <input type="text" class="k-map-input" data-row="3" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB (0111)">
                            <input type="text" class="k-map-input" data-row="3" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-AB' (0101)">
                            <input type="text" class="k-map-input" data-row="3" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B' (0001)">
                            <input type="text" class="k-map-input" data-row="3" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell C'D-A'B (0011)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab6-function-h" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab6-function-h" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab6-function-h-simple-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab6-function-h" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab6-function-h" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                


                <p id="question4-lab6-text"><b>4. Sketch the logic expression using (AND-OR NOT) gates</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab6-q4" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab6Q4" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab6Q4" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab6Q4" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab6Q4" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab6Q4" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab6Q4" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab6Q4" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab6Q4">100%</span>
                        <button id="downloadCanvasLab6Q4" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab6Q4" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab6Q4" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <!-- Function F Simulator -->
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="funcFSimTitle">
                    <h3 class="section-title" id="funcFSimTitle">Function F Simulator</h3>
                    <p style="text-align: center; margin-bottom: 1rem; color: var(--text);">
                        <strong>F(A,B,C,D) = Σ(1,3,5,7,9,15) with don't care d(A,B,C,D) = Σ(4,6,12,13)</strong>
                    </p>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcFA" aria-label="Input A">
                                    <label class="slider" for="funcFA"></label>
                                </div>
                                <div class="input-label">A (MSB)</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcFB" aria-label="Input B">
                                    <label class="slider" for="funcFB"></label>
                                </div>
                                <div class="input-label">B</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcFC" aria-label="Input C">
                                    <label class="slider" for="funcFC"></label>
                                </div>
                                <div class="input-label">C</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcFD" aria-label="Input D">
                                    <label class="slider" for="funcFD"></label>
                                </div>
                                <div class="input-label">D (LSB)</div>
                            </div>
                        </div>
                        
                        <div class="boolean-sim-equation">
                            <div class="equation-box circuit-border" style="margin-bottom:0;">
                                <div style="font-weight:600;">Input: <span id="funcFValue">0000</span></div>
                            </div>
                        </div>
                        
                        <div class="boolean-sim-output">
                            <div class="led-output" id="funcFLed" role="img" aria-label="Function F Output LED" tabindex="0"></div>
                            <div class="input-label">Result: <span id="funcFOutput">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
                
                <!-- Function H Simulator -->
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="funcHSimTitle">
                    <h3 class="section-title" id="funcHSimTitle">Function H Simulator</h3>
                    <p style="text-align: center; margin-bottom: 1rem; color: var(--text);">
                        <strong>H = AB' + ABC + ABD' + A'C'D' + A'BC'</strong>
                    </p>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcHA" aria-label="Input A">
                                    <label class="slider" for="funcHA"></label>
                                </div>
                                <div class="input-label">A (MSB)</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcHB" aria-label="Input B">
                                    <label class="slider" for="funcHB"></label>
                                </div>
                                <div class="input-label">B</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcHC" aria-label="Input C">
                                    <label class="slider" for="funcHC"></label>
                                </div>
                                <div class="input-label">C</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="funcHD" aria-label="Input D">
                                    <label class="slider" for="funcHD"></label>
                                </div>
                                <div class="input-label">D (LSB)</div>
                            </div>
                        </div>
                        
                        <div class="boolean-sim-equation">
                            <div class="equation-box circuit-border" style="margin-bottom:0;">
                                <div style="font-weight:600;">Input: <span id="funcHValue">0000</span></div>
                            </div>
                        </div>
                        
                        <div class="boolean-sim-output">
                            <div class="led-output" id="funcHLed" role="img" aria-label="Function H Output LED" tabindex="0"></div>
                            <div class="input-label">Result: <span id="funcHOutput">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
            </section>
            
                            <!-- Answer Modal for Lab 6 Simplification -->
                <div id="answer-modal-lab6-simplification" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="modal-title-lab6-simplification" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                    <div class="modal-header">
                        <h3 id="modal-title-lab6-simplification">Simplification Answer Comparison</h3>
                        <button class="modal-close" id="close-modal-lab6-simplification" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-content">
                        <div class="answer-comparison">
                            <div class="answer-section">
                                <h4>Your Answer:</h4>
                                <div id="user-answer-display-lab6-simplification" class="answer-display"></div>
                            </div>
                            <div class="answer-section">
                                <h4>Correct Answer:</h4>
                                <div id="correct-answer-display-lab6-simplification" class="answer-display correct-answer">
                                    <div class="math-solution">
                                        <p><strong>Here's the step-by-step simplification:</strong></p>
                                        
                                        <div class="math-equation">
                                            <h4>Step 1: Write the Function</h4>
                                            <p><strong>Original function:</strong></p>
                                            <p>H = AB' + ABC + ABD' + A'C'D' + A'BC'</p>
                                            <p><strong>Explanation:</strong> This is our starting point - a complex Boolean expression that needs simplification.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 2: Group Terms with A and A'</h4>
                                            <p><strong>Factor out A and A' from their respective terms:</strong></p>
                                            <p>H = A(B' + BC + BD') + A'(C'D' + BC')</p>
                                            <p><strong>Explanation:</strong> We group terms by their common factors to make simplification easier.</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 3: Simplify the A-Group</h4>
                                            <p><strong>We simplify: B' + BC + BD'</strong></p>
                                            <p><strong>Using the identity X' + XY = X' + Y:</strong></p>
                                            <p>B' + BC = B' + C (with X = B, Y = C)</p>
                                            <p><strong>Using the identity X' + XY' = X' + Y':</strong></p>
                                            <p>B' + BD' = B' + D' (with X = B, Y = D)</p>
                                            <p><strong>Combining results:</strong></p>
                                            <p>B' + BC + BD' = B' + C + D'</p>
                                            <p><strong>Thus, the A-group becomes:</strong> A(B' + C + D')</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 4: Simplify the A'-Group</h4>
                                            <p><strong>We simplify: C'D' + BC'</strong></p>
                                            <p><strong>Factor out C':</strong></p>
                                            <p>C'D' + BC' = C'(D' + B) = C'(B + D')</p>
                                            <p><strong>So the A'-group becomes:</strong> A'C'(B + D')</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 5: Combine the Results</h4>
                                            <p><strong>Combined expression:</strong></p>
                                            <p>H = A(B' + C + D') + A'C'(B + D')</p>
                                            <p><strong>Expanding to sum-of-products form:</strong></p>
                                            <p>H = AB' + AC + AD' + A'BC' + A'C'D'</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 6: Apply the Consensus Theorem</h4>
                                            <p><strong>Consider the terms: AD' + A'C'D'</strong></p>
                                            <p><strong>Let: X = A, Y = D', Z = C'D'</strong></p>
                                            <p><strong>Then: XY + X'Z = XY + X'Z + YZ</strong></p>
                                            <p><strong>So we add the consensus term:</strong></p>
                                            <p>YZ = D' · C'D' = C'D'</p>
                                            <p><strong>Now: A'C'D' + C'D' = C'D'(A' + 1) = C'D'</strong></p>
                                            <p><strong>Thus, we can replace A'C'D' with C'D', and the expression becomes:</strong></p>
                                            <p>H = AB' + AC + AD' + A'BC' + C'D'</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 7: Check for Redundancy</h4>
                                            <p><strong>We now have: H = AB' + AC + AD' + A'BC' + C'D'</strong></p>
                                            <p><strong>Check if AD' is redundant:</strong></p>
                                            <p>• AB' covers all terms where A = 1 and B = 0</p>
                                            <p>• AC covers all terms where A = 1 and C = 1</p>
                                            <p>• C'D' covers all terms where C = 0 and D = 0</p>
                                            <p>• A'BC' covers all terms where A = 0, B = 1, and C = 0</p>
                                            <p><strong>The minterms covered by AD' (where A = 1, D = 0) are already covered by other terms:</strong></p>
                                            <p>• AB' covers when B = 0</p>
                                            <p>• C'D' covers when C = 0</p>
                                            <p>• AC covers when C = 1</p>
                                            <p><strong>So, AD' is redundant and can be removed.</strong></p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Step 8: Final Simplified Expression</h4>
                                            <p><strong>After removing redundancy:</strong></p>
                                            <p>H = AB' + AC + A'BC' + C'D'</p>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h4>Final Answer</h4>
                                            <p><strong>Simplified function:</strong></p>
                                            <p>H = AB' + AC + A'BC' + C'D'</p>
                                            <p><strong>Verification:</strong> This is the most simplified form with no redundant terms.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" id="copy-answer-btn-lab6-simplification">
                            <i class="fas fa-copy"></i> Copy Correct Answer
                        </button>
                        <button class="btn btn-secondary" id="close-modal-footer-lab6-simplification">Close</button>
                    </div>
                </div>
            </div>
            

            
                            <!-- K-Map Answer Modal for Lab 6 Function H -->
                <div id="kmap-answer-modal-lab6-function-h" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab6-function-h" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                    <div class="modal-header">
                        <h3 id="kmap-modal-title-lab6-function-h">K-Map Simplification Answer - Function H</h3>
                        <button class="modal-close" id="close-kmap-modal-lab6-function-h" aria-label="Close modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-content">
                        <div class="kmap-modal-layout">
                            <!-- Left Side: User's Answers -->
                            <div class="kmap-left-panel">
                                <div class="answer-section">
                                    <h4>Your K-Map Values:</h4>
                                    <div id="user-kmap-display-lab6-function-h" class="answer-display compact"></div>
                                </div>
                                <div class="answer-section">
                                    <h4>Your Simplified Expression:</h4>
                                    <div id="user-expression-display-lab6-function-h" class="answer-display"></div>
                                </div>
                            </div>
                            
                            <!-- Right Side: Correct Answer -->
                            <div class="kmap-right-panel">
                                <div class="answer-section">
                                    <h4>Correct K-Map Values:</h4>
                                    <div id="correct-kmap-display-lab6-function-h" class="answer-display correct-answer compact">
                                        <div class="kmap-grid-display">
                                            <!-- Header Row with Column Labels -->
                                            <div class="kmap-row">
                                                <div class="kmap-header-cell"></div>
                                                <div class="kmap-header-cell">AB</div>
                                                <div class="kmap-header-cell">AB'</div>
                                                <div class="kmap-header-cell">A'B'</div>
                                                <div class="kmap-header-cell">A'B</div>
                                            </div>
                                            <!-- Data Rows -->
                                            <div class="kmap-row">
                                                <div class="kmap-header-cell">CD</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">0</div>
                                                <div class="kmap-cell">0</div>
                                            </div>
                                            <div class="kmap-row">
                                                <div class="kmap-header-cell">CD'</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">0</div>
                                                <div class="kmap-cell">0</div>
                                            </div>
                                            <div class="kmap-row">
                                                <div class="kmap-header-cell">C'D'</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">1</div>
                                            </div>
                                            <div class="kmap-row">
                                                <div class="kmap-header-cell">C'D</div>
                                                <div class="kmap-cell">0</div>
                                                <div class="kmap-cell">1</div>
                                                <div class="kmap-cell">0</div>
                                                <div class="kmap-cell">1</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="answer-section">
                                    <h4>Correct Simplified Expression:</h4>
                                    <div id="correct-expression-display-lab6-function-h" class="answer-display correct-answer compact">
                                        <p><strong>H = AB' + AC + A'BC' + C'D'</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Detailed Explanation Below -->
                        <div class="kmap-explanation">
                            <h4>Detailed Solution Explanation:</h4>
                            <div class="math-solution">
                                <div class="math-equation">
                                    <h5>1) Convert product terms to minterms (A B C D)</h5>
                                    <ul>
                                        <li><strong>AB':</strong> A=1, B=0 → minterms 8, 9, 10, 11 (binary: 1000, 1001, 1010, 1011)</li>
                                        <li><strong>ABC:</strong> A=1, B=1, C=1 → minterms 14, 15 (1110, 1111)</li>
                                        <li><strong>ABD':</strong> A=1, B=1, D=0 → minterms 12, 14 (1100, 1110)</li>
                                        <li><strong>A'CD':</strong> A=0, C=1, D=0 → minterms 2, 6 (0010, 0110)</li>
                                        <li><strong>A'BC':</strong> A=0, B=1, C=0 → minterms 4, 5 (0100, 0101)</li>
                                    </ul>
                                    <p><strong>Taking the union, the minterms where H = 1 are:</strong></p>
                                    <p>{2, 4, 5, 6, 8, 9, 10, 11, 12, 14, 15}</p>
                                </div>
                                
                                <div class="math-equation">
                                    <h5>2) Construct the Karnaugh Map (K-map)</h5>
                                    <p><strong>Label the rows with CD and columns with AB:</strong></p>
                                    <p>The K-map shows the distribution of 1's based on the minterms identified above.</p>
                                </div>
                                
                                <div class="math-equation">
                                    <h5>3) Group the 1's in the K-map</h5>
                                    <p><strong>Look for the largest possible groups of adjacent 1's (powers of 2):</strong></p>
                                    <ul>
                                        <li><strong>Group 1:</strong> AB' (covers minterms 8, 9, 10, 11)</li>
                                        <li><strong>Group 2:</strong> AC (covers minterms 10, 11, 14, 15)</li>
                                        <li><strong>Group 3:</strong> C'D' (covers minterms 0, 4)</li>
                                        <li><strong>Group 4:</strong> A'BC' (covers minterms 4, 5)</li>
                                    </ul>
                                    <p><strong>Note:</strong> Some minterms are covered by multiple groups, which is acceptable.</p>
                                </div>
                                
                                <div class="math-equation">
                                    <h5>4) Write the Simplified Expression</h5>
                                    <p><strong>Each group corresponds to a product term:</strong></p>
                                    <ul>
                                        <li>Group 1: AB'</li>
                                        <li>Group 2: AC</li>
                                        <li>Group 3: C'D'</li>
                                        <li>Group 4: A'BC'</li>
                                    </ul>
                                    <p><strong>So the simplified function is:</strong></p>
                                    <p>H = AB' + AC + A'BC' + C'D'</p>
                                </div>
                                
                                <div class="math-equation">
                                    <h5>Final Answer</h5>
                                    <p><strong>Simplified function:</strong></p>
                                    <p>H = AB' + AC + A'BC' + C'D'</p>
                                    <p><strong>Verification:</strong> This matches the result from the algebraic simplification method.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" id="copy-kmap-answer-btn-lab6-function-h">
                            <i class="fas fa-copy"></i> Copy Correct Answer
                        </button>
                        <button class="btn btn-secondary" id="close-kmap-modal-footer-lab6-function-h">Close</button>
                    </div>
                </div>
            </div>
            
            
            <!-- Lab 7: Using Full Adder -->
            <section id="lab7" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 7: Using Full Adder</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>Becoming familiar with full adders</p>
                
                <h3 class="section-title">Experiment requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7483 / 74283</div>
                    <div class="ic-table-cell" role="cell">4-bit full adder</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Construct a BCD-to-excess-3 code converter with a 4 bit full adder. Remember that the excess-3 code digit is obtained by adding three to the corresponding BCD digit.</li>
                </ul>
                
                <h3 class="section-title">BCD-to-Excess-3 Truth Table:</h3>
                <p>Complete mapping of decimal digits to their BCD and Excess-3 representations:</p>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="lab7-bcd-truth-table">
                    <thead>
                      <tr>
                        <th>Decimal Digit</th>
                        <th>BCD (WXYZ)</th>
                        <th>Excess-3 (ABCD)</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td>
                        <td>0000</td>
                        <td>0011</td>
                      </tr>
                      <tr>
                        <td>1</td>
                        <td>0001</td>
                        <td>0100</td>
                      </tr>
                      <tr>
                        <td>2</td>
                        <td>0010</td>
                        <td>0101</td>
                      </tr>
                      <tr>
                        <td>3</td>
                        <td>0011</td>
                        <td>0110</td>
                      </tr>
                      <tr>
                        <td>4</td>
                        <td>0100</td>
                        <td>0111</td>
                      </tr>
                      <tr>
                        <td>5</td>
                        <td>0101</td>
                        <td>1000</td>
                      </tr>
                      <tr>
                        <td>6</td>
                        <td>0110</td>
                        <td>1001</td>
                      </tr>
                      <tr>
                        <td>7</td>
                        <td>0111</td>
                        <td>1010</td>
                      </tr>
                      <tr>
                        <td>8</td>
                        <td>1000</td>
                        <td>1011</td>
                      </tr>
                      <tr>
                        <td>9</td>
                        <td>1001</td>
                        <td>1100</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                
                <!-- Content placed directly under section title (following Labs 1-6 pattern) -->
                <h3 class="section-title">Understanding BCD and Excess-3 Codes:</h3>
                    <h4 style="margin-top: 0; color: var(--secondary);">Binary Coded Decimal (BCD)</h4>
                    <p><strong>BCD</strong> is a binary encoding of decimal numbers where each decimal digit is represented by its 4-bit binary equivalent. This encoding allows decimal numbers to be stored and processed in digital systems while maintaining human-readable decimal representation.</p>
                    
                    <h4 style="margin-top: 1.5rem; color: var(--secondary);">Excess-3 Code</h4>
                    <p><strong>Excess-3</strong> is a self-complementing binary code where each decimal digit is represented by adding 3 (binary 0011) to its BCD representation. This property makes it useful for arithmetic operations and error detection.</p>
                    
                    <h4 style="margin-top: 1.5rem; color: var(--secondary);">Mathematical Relationship</h4>
                    <p>The relationship between BCD and Excess-3 is straightforward:</p>
                    <div class="equation-box" style="margin: 1rem 0;">
                        <span style="font-weight: 600; color: var(--accent);">Excess-3 = BCD + 0011 (binary 3)</span>
                </div>
                
                    <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Properties</h4>
                    <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                        <li><strong>Self-complementing:</strong> The 9's complement of a digit can be obtained by inverting all bits</li>
                        <li><strong>Arithmetic friendly:</strong> Simplifies addition and subtraction operations</li>
                        <li><strong>Error detection:</strong> Invalid combinations (0000, 0001, 0010, 1101, 1110, 1111) can be detected</li>
                        <li><strong>Range:</strong> Covers decimal digits 0-9 with valid 4-bit combinations</li>
                    </ul>
                    
                    <h4 style="margin-top: 1.5rem; color: var(--secondary);">Practical Applications</h4>
                    <p>BCD and Excess-3 codes are commonly used in:</p>
                    <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                        <li><strong>Digital displays:</strong> 7-segment displays, LCD panels</li>
                        <li><strong>Financial systems:</strong> Banking, accounting, calculators</li>
                        <li><strong>Industrial control:</strong> Process monitoring, instrumentation</li>
                        <li><strong>Communication systems:</strong> Data encoding, protocol design</li>
                    </ul>
                
                <!-- Content placed directly under section title (following Labs 1-6 pattern) -->
                <h3 class="section-title">Full Adder:</h3>
                    <h4 style="margin-top: 0; color: var(--secondary);">1-bit Full Adder</h4>
                    <p>A <strong>1-bit Full Adder</strong> is a combinational circuit that adds three binary inputs (A, B, and Cin) and produces two outputs: Sum (S) and Carry-out (Cout). It's the fundamental building block for multi-bit addition operations.</p>
                    
                    <div class="full-adder-diagram">
                        <div class="diagram-section">
                            <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">Block Diagram</h5>
                            <div class="image-container">
                                <img src="media/full_adder.png" alt="1-bit Full Adder Block Diagram" class="responsive-image">
                            </div>
                                </div>
                        
                        <div class="diagram-section">
                            <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">Internal Logic Design</h5>
                            <div class="image-container">
                                <img src="media/full_adder_internal.png" alt="Internal Design of 1-bit Full Adder" class="responsive-image">
                            </div>
                            <div class="logic-explanation">
                                <p><strong>Logic Implementation:</strong></p>
                                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                                    <li><strong>Sum (S):</strong> Generated using two XOR gates: S = A ⊕ B ⊕ Cin</li>
                                    <li><strong>Carry-out (Cout):</strong> Generated using AND and OR gates: Cout = (A·B) + (A⊕B)·Cin</li>
                                    <li><strong>Propagation:</strong> Carry ripples through the circuit based on input combinations</li>
                                </ul>
                                </div>
                            </div>
                        
                        <div class="diagram-section">
                            <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">Truth Table</h5>
                            <div class="responsive-table" style="margin-bottom: 1.2rem;">
                                <table class="truth-table" id="lab7-full-adder-truth-table">
                                    <thead>
                                        <tr>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>Cin</th>
                                            <th>S</th>
                                            <th>Cout</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
                                        <tr><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td></tr>
                                        <tr><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr>
                                        <tr><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td></tr>
                                        <tr><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td></tr>
                                        <tr><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td></tr>
                                        <tr><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td></tr>
                                        <tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr>
                                    </tbody>
                                </table>
                                </div>
                            </div>
                        </div>
                        
                    <h4 style="margin-top: 2rem; color: var(--secondary);">4-bit Parallel Adder</h4>
                    <p>A <strong>4-bit Parallel Adder</strong> is constructed by cascading four 1-bit Full Adders together, where the Carry-out of each stage becomes the Carry-in of the next stage. This enables parallel processing of multi-bit binary numbers.</p>
                    
                    <div class="parallel-adder-diagram">
                        <div class="image-container">
                            <img src="media/parallel_adder.png" alt="4-bit Parallel Adder Cascaded Design" class="responsive-image">
                        </div>
                        
                        <div class="parallel-adder-summary">
                            <h5 style="color: var(--accent); margin: 1.5rem 0 1rem 0;">Key Features</h5>
                            <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                                <li><strong>Parallel Processing:</strong> All bits are processed simultaneously for faster operation</li>
                                <li><strong>Carry Propagation:</strong> Carry ripples through each stage sequentially (ripple carry)</li>
                                <li><strong>Scalable Design:</strong> Can be extended to any number of bits (8-bit, 16-bit, 32-bit)</li>
                                <li><strong>Standard IC:</strong> Available as 7483 (4-bit full adder) or 74283 with enhanced features</li>
                                <li><strong>Applications:</strong> Arithmetic logic units (ALUs), calculators, digital signal processors</li>
                            </ul>
                            
                            <h5 style="color: var(--accent); margin: 1.5rem 0 1rem 0;">Operation Principle</h5>
                            <p>The 4-bit parallel adder operates by:</p>
                            <ol style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                                <li>Receiving two 4-bit binary numbers (A3A2A1A0 and B3B2B1B0)</li>
                                <li>Processing each bit pair through individual full adders</li>
                                <li>Propagating carry from least significant bit (LSB) to most significant bit (MSB)</li>
                                <li>Generating a 4-bit sum (S3S2S1S0) and final carry-out</li>
                            </ol>
                    </div>
                </div>
                
                <!-- Content placed directly under section title (following Labs 1-6 pattern) -->
                <h3 class="section-title">
                    <span>Pre-lab Activity:</span>
                    <button id="chip-info-btn-lab7" type="button" class="btn btn-info">
                        <i class="fas fa-microchip"></i> Chip Info
                    </button>
                </h3>
                
                    <p id="question-lab7-text"><strong>Circuit Design Task:</strong> Sketch the logic and circuit diagrams for the BCD-to-Excess-3 converter using the 4-bit full adder (7483/74283).</p>
                    <p><strong>Requirements:</strong></p>
                    <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                        <li>Design the complete circuit diagram showing all connections</li>
                    <li>Label all inputs, outputs</li>
                        <li>Include the 4-bit full adder IC with proper pin connections</li>
                        <li>Show the BCD input (4 bits) and Excess-3 output (4 bits)</li>
                        <li>Indicate the constant addition of 0011 (binary 3) to BCD input</li>
                    </ul>
                
                <section class="logic-drawing-section" id="logic-drawing-lab7" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab7" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab7" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab7" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab7" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab7" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab7" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab7" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab7">100%</span>
                        <button id="downloadCanvasLab7" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab7" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab7" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <div class="bcd-excess3-sim-card" aria-label="BCD to Excess-3 conversion simulation experiment">
                        <h3 class="section-title">BCD to Excess-3 Converter Simulator</h3>
                    <!-- BCD Input Section -->
                    <div class="bcd-input-section">
                        <h4 style="margin-bottom: 1rem; color: var(--secondary); text-align: center;">BCD Input (WXYZ)</h4>
                        <div class="bcd-switch-row">
                            <div class="bcd-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="bcdW" aria-label="Input W (MSB)" tabindex="0">
                                    <label class="slider" for="bcdW"></label>
                                </div>
                                <div class="input-label">W (MSB)</div>
                            </div>
                            <div class="bcd-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="bcdX" aria-label="Input X" tabindex="0">
                                    <label class="slider" for="bcdX"></label>
                                </div>
                                <div class="input-label">X</div>
                            </div>
                            <div class="bcd-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="bcdY" aria-label="Input Y" tabindex="0">
                                    <label class="slider" for="bcdY"></label>
                                </div>
                                <div class="input-label">Y</div>
                            </div>
                            <div class="bcd-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="bcdZ" aria-label="Input Z (LSB)" tabindex="0">
                                    <label class="slider" for="bcdZ"></label>
                                </div>
                                <div class="input-label">Z (LSB)</div>
                            </div>
                        </div>
                        
                        <!-- BCD Binary and Decimal Display -->
                        <div class="bcd-values-display">
                            <div style="font-size: 0.9rem; color: var(--light); margin-bottom: 0.5rem;">BCD Values:</div>
                            <div style="font-size: 1rem; color: var(--text);">
                                Binary: <span id="bcdBinaryValue">0000</span><br>
                                Decimal: <span id="bcdDecimalValue">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Conversion Logic Display -->
                    <div class="bcd-conversion-logic">
                        <h4 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">Conversion Logic: Excess-3 = BCD + 0011</h4>
                    </div>
                    
                    <!-- 7-Segment Display Section -->
                    <div class="bcd-seg-section">
                        <h4 style="margin-bottom: 1rem; color: var(--secondary); text-align: center;">7-Segment Displays</h4>
                        
                        <div class="bcd-seg-container">
                            <!-- Tens Place -->
                            <div class="bcd-seg-display">
                                <div style="font-size: 0.9rem; color: var(--light); margin-bottom: 0.5rem; text-align: center;">Tens Place</div>
                                <div class="segment-display" id="tensSevenSegment" aria-live="polite" tabindex="0">
                                    <svg id="tensSevenSegmentSVG" width="90" height="150" viewBox="0 0 90 150" style="display:block;margin:0 auto;">
                                        <rect x="5" y="5" width="80" height="140" rx="18" fill="#181818" stroke="#333" stroke-width="4"/>
                                        <g id="tensSegments">
                                            <polygon id="tensSegA" points="20,18 70,18 62,28 28,28" fill="#2a0000"/>
                                            <polygon id="tensSegB" points="72,20 82,32 82,68 72,76 62,68 62,32" fill="#2a0000"/>
                                            <polygon id="tensSegC" points="72,80 82,88 82,124 72,136 62,124 62,88" fill="#2a0000"/>
                                            <polygon id="tensSegD" points="20,132 70,132 62,122 28,122" fill="#2a0000"/>
                                            <polygon id="tensSegE" points="18,80 28,88 28,124 18,136 8,124 8,88" fill="#2a0000"/>
                                            <polygon id="tensSegF" points="18,20 28,32 28,68 18,76 8,68 8,32" fill="#2a0000"/>
                                            <polygon id="tensSegG" points="22,75 68,75 62,85 28,85" fill="#2a0000"/>
                                        </g>
                                    </svg>
                                </div>
                            </div>
                            
                            <!-- Ones Place -->
                            <div class="bcd-seg-display">
                                <div style="font-size: 0.9rem; color: var(--light); margin-bottom: 0.5rem; text-align: center;">Ones Place</div>
                                <div class="segment-display" id="onesSevenSegment" aria-live="polite" tabindex="0">
                                    <svg id="onesSevenSegmentSVG" width="90" height="150" viewBox="0 0 90 150" style="display:block;margin:0 auto;">
                                        <rect x="5" y="5" width="80" height="140" rx="18" fill="#181818" stroke="#333" stroke-width="4"/>
                                        <g id="onesSegments">
                                            <polygon id="onesSegA" points="20,18 70,18 62,28 28,28" fill="#2a0000"/>
                                            <polygon id="onesSegB" points="72,20 82,32 82,68 72,76 62,68 62,32" fill="#2a0000"/>
                                            <polygon id="onesSegC" points="72,80 82,88 82,124 72,136 62,124 62,88" fill="#2a0000"/>
                                            <polygon id="onesSegD" points="20,132 70,132 62,122 28,122" fill="#2a0000"/>
                                            <polygon id="onesSegE" points="18,80 28,88 28,124 18,136 8,124 8,88" fill="#2a0000"/>
                                            <polygon id="onesSegF" points="18,20 28,32 28,68 18,76 8,68 8,32" fill="#2a0000"/>
                                            <polygon id="onesSegG" points="22,75 68,75 62,85 28,85" fill="#2a0000"/>
                                        </g>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Excess-3 Binary and Decimal Display - Centered below both displays -->
                        <div class="excess3-values-display-centered">
                            <div style="font-size: 0.9rem; color: var(--light); margin-bottom: 0.5rem;">Excess-3 Values:</div>
                            <div style="font-size: 1rem; color: var(--text);">
                                Binary: <span id="excess3BinaryValue">0011</span><br>
                                Decimal: <span id="excess3DecimalValue">3</span>
                            </div>
                        </div>
                        
                        <!-- Excess-3 Output LEDs -->
                        <div class="bcd-excess3-led-section">
                            <h4 style="color: var(--accent); margin: 1.5rem 0 1rem 0; text-align: center;">Excess-3 Binary Output LEDs</h4>
                            <div class="bcd-excess3-led-row">
                                <div class="bcd-excess3-led-block">
                                    <div class="led-output lab7-led" id="lab7LedCout" role="img" aria-label="LED Cout status"></div>
                                    <span class="led-label">Cout (MSB)</span>
                                </div>
                                <div class="bcd-excess3-led-block">
                                    <div class="led-output lab7-led" id="lab7LedD" role="img" aria-label="LED D status"></div>
                                    <span class="led-label">D</span>
                                </div>
                                <div class="bcd-excess3-led-block">
                                    <div class="led-output lab7-led" id="lab7LedC" role="img" aria-label="LED C status"></div>
                                    <span class="led-label">C</span>
                                </div>
                                <div class="bcd-excess3-led-block">
                                    <div class="led-output lab7-led" id="lab7LedB" role="img" aria-label="LED B status"></div>
                                    <span class="led-label">B</span>
                                </div>
                                <div class="bcd-excess3-led-block">
                                    <div class="led-output lab7-led" id="lab7LedA" role="img" aria-label="LED A status"></div>
                                    <span class="led-label">A (LSB)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Chip Information Modal -->
                <div id="chipModalLab7" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>4-bit Full Adder IC Pin Configurations</h3>
                            <button class="modal-close" id="closeChipModalLab7" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-navigation">
                                <button id="chip7483Btn" class="chip-nav-btn active" data-chip="7483">7483</button>
                                <button id="chip74283Btn" class="chip-nav-btn" data-chip="74283">74283</button>
                            </div>
                            <div class="chip-image-container">
                                <img id="chipImageLab7" src="media/7483_4_bit_Full_Adder.png" alt="7483 4-bit Full Adder Pin Configuration" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4 id="chipTitleLab7">7483 4-bit Full Adder</h4>
                                <p id="chipDescLab7">The 7483 is a 4-bit binary full adder with fast carry lookahead. It features four full-adder stages with internal carry lookahead for high-speed operation.</p>
                                <div class="chip-features">
                                    <h5>Key Features:</h5>
                                    <ul>
                                        <li><strong>Package:</strong> 16-pin DIP</li>
                                        <li><strong>Supply Voltage:</strong> 4.75V to 5.25V</li>
                                        <li><strong>Propagation Delay:</strong> 15ns typical</li>
                                        <li><strong>Temperature Range:</strong> 0°C to 70°C</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Lab 8: Using Decoders -->
            <section id="lab8" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 8: Using Decoders</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>Becoming familiar with decoders</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7404</div>
                    <div class="ic-table-cell" role="cell">Hex inverter</div>
                    <div class="ic-table-cell" role="cell">2</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7408</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input AND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7432</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input OR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74139</div>
                    <div class="ic-table-cell" role="cell">2 x 4 decoder</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74LS238</div>
                    <div class="ic-table-cell" role="cell">3 x 8 decoder (alternative)</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74LS138</div>
                    <div class="ic-table-cell" role="cell">3 x 8 decoder (alternative)</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Design the circuit with a decoder and external gates, for the combinational circuit which is defined as follows:
                        <div class="equation-box" style="text-align: center; margin: 15px 0;">
                            <div style="font-weight: 600; margin-bottom: 10px;">F1 = x'y'z' + xz</div>
                            <div style="font-weight: 600; margin-bottom: 10px;">F2 = xy'z' + x'y</div>
                            <div style="font-weight: 600;">F3 = x'y'z' + xy</div>
                        </div>
                    </li>
                </ul>
                
                <h3 class="section-title">Understanding Decoders:</h3>
                <h4 style="margin-top: 0; color: var(--secondary);">General Decoder Block Diagram</h4>
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">General Decoder Block Diagram</h5>
                        <div class="image-container">
                            <img src="media/Gen_Decoder.png" alt="General Decoder Block Diagram with n inputs and 2^n outputs" class="responsive-image">
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button id="decoder-info-btn-lab8" type="button" class="btn btn-info">
                                <i class="fas fa-microchip"></i> Decoder Info
                            </button>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Decoder Fundamentals</h4>
                <p>A <strong>decoder</strong> is a combinational logic circuit that converts binary information from n input lines to a maximum of 2<sup>n</sup> unique output lines. The decoder activates exactly one output line based on the binary value of the input combination, while all other outputs remain inactive.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Characteristics</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Input-Output Relationship:</strong> n inputs generate 2<sup>n</sup> outputs (where n is the number of input bits)</li>
                    <li><strong>One-Hot Output:</strong> Only one output is active (typically HIGH) at any given time</li>
                    <li><strong>Binary Decoding:</strong> Input binary value determines which specific output line is activated</li>
                    <li><strong>Enable Control:</strong> Many decoders include enable inputs for output control and cascading</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Common Decoder Configurations</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>2-to-4 Decoder (74139):</strong> 2 inputs → 4 outputs (2<sup>2</sup> = 4)</li>
                    <li><strong>3-to-8 Decoder (74LS238):</strong> 3 inputs → 8 outputs (2<sup>3</sup> = 8)</li>
                    <li><strong>4-to-16 Decoder:</strong> 4 inputs → 16 outputs (2<sup>4</sup> = 16)</li>
                    <li><strong>n-to-2<sup>n</sup> Decoder:</strong> n inputs → 2<sup>n</sup> outputs</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Applications</h4>
                <p>Decoders are commonly used in:</p>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Address Decoding:</strong> Memory and I/O address selection in computer systems</li>
                    <li><strong>Instruction Decoding:</strong> CPU instruction interpretation and control signal generation</li>
                    <li><strong>Display Control:</strong> 7-segment display and LED matrix control</li>
                    <li><strong>Function Generation:</strong> Implementing Boolean functions using decoder outputs and OR gates</li>
                    <li><strong>Data Demultiplexing:</strong> Routing data to specific output channels</li>
                </ul>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Use boolean Algebric rules to reach for mean terms of the 3 functions (F1, F2, and F3):</b></p>
                <div class="simplification-question-box">
                    <div class="question-header">
                        <h4>Apply Boolean algebra rules to find the minterms for the three functions:</h4>
                        <button id="show-answer-btn-lab8" type="button" class="btn btn-accent" style="min-width:140px;">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                    </div>
                    <div class="rich-editor-container">
                        <div class="editor-toolbar">
                            <!-- Text Formatting -->
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                                <i class="fas fa-underline"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough (Ctrl+S)">
                                <i class="fas fa-strikethrough"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Mathematical Notation -->
                            <button type="button" class="toolbar-btn" data-command="subscript" title="Subscript (Ctrl+Shift+S)">
                                <i class="fas fa-subscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript (Ctrl+Shift+P)">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="Σ" title="Sum Symbol (Σ)">
                                <span style="font-weight: bold; font-size: 1.1em;">Σ</span>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="π" title="Pi Symbol (π)">
                                <span style="font-weight: bold; font-size: 1.1em;">π</span>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Lists -->
                            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List (Ctrl+Shift+L)">
                                <i class="fas fa-list-ul"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List (Ctrl+Shift+O)">
                                <i class="fas fa-list-ol"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Alignment -->
                            <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left (Ctrl+Shift+L)">
                                <i class="fas fa-align-left"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center (Ctrl+Shift+C)">
                                <i class="fas fa-align-center"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right (Ctrl+Shift+R)">
                                <i class="fas fa-align-right"></i>
                            </button>
                            
                            <div class="toolbar-separator"></div>
                            
                            <!-- Utility Functions -->
                            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                            <button type="button" class="toolbar-btn clear-format" data-command="removeFormat" title="Clear Formatting (Ctrl+Shift+F)">
                                <i class="fas fa-eraser"></i>
                            </button>
                        </div>
                        <div id="simplification-editor-lab8" class="rich-editor" contenteditable="true" 
                             placeholder="Type your step-by-step Boolean algebra simplification here..."></div>
                    </div>
                </div>
                
                <p><b>2. Use Truth table for three functions (F1, F2, and F3) to reach for mean terms:</b></p>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table class="truth-table" id="lab8-truth-table">
                    <thead>
                    <tr>
                        <th>Z</th>
                        <th>Y</th>
                        <th>X</th>
                        <th>F1</th>
                        <th>F2</th>
                        <th>F3</th>
                    </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab8-f1" data-z="0" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F1 output for 0 0 0"></td>
                        <td><input class="output-field-lab8-f2" data-z="0" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F2 output for 0 0 0"></td>
                        <td><input class="output-field-lab8-f3" data-z="0" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F3 output for 0 0 0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab8-f1" data-z="0" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F1 output for 0 0 1"></td>
                        <td><input class="output-field-lab8-f2" data-z="0" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F2 output for 0 0 1"></td>
                        <td><input class="output-field-lab8-f3" data-z="0" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F3 output for 0 0 1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab8-f1" data-z="0" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F1 output for 0 1 0"></td>
                        <td><input class="output-field-lab8-f2" data-z="0" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F2 output for 0 1 0"></td>
                        <td><input class="output-field-lab8-f3" data-z="0" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F3 output for 0 1 0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab8-f1" data-z="0" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F1 output for 0 1 1"></td>
                        <td><input class="output-field-lab8-f2" data-z="0" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F2 output for 0 1 1"></td>
                        <td><input class="output-field-lab8-f3" data-z="0" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F3 output for 0 1 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab8-f1" data-z="1" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F1 output for 1 0 0"></td>
                        <td><input class="output-field-lab8-f2" data-z="1" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F2 output for 1 0 0"></td>
                        <td><input class="output-field-lab8-f3" data-z="1" data-y="0" data-x="0" maxlength="1" inputmode="numeric" aria-label="F3 output for 1 0 0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab8-f1" data-z="1" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F1 output for 1 0 1"></td>
                        <td><input class="output-field-lab8-f2" data-z="1" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F2 output for 1 0 1"></td>
                        <td><input class="output-field-lab8-f3" data-z="1" data-y="0" data-x="1" maxlength="1" inputmode="numeric" aria-label="F3 output for 1 0 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab8-f1" data-z="1" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F1 output for 1 1 0"></td>
                        <td><input class="output-field-lab8-f2" data-z="1" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F2 output for 1 1 0"></td>
                        <td><input class="output-field-lab8-f3" data-z="1" data-y="1" data-x="0" maxlength="1" inputmode="numeric" aria-label="F3 output for 1 1 0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab8-f1" data-z="1" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F1 output for 1 1 1"></td>
                        <td><input class="output-field-lab8-f2" data-z="1" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F2 output for 1 1 1"></td>
                        <td><input class="output-field-lab8-f3" data-z="1" data-y="1" data-x="1" maxlength="1" inputmode="numeric" aria-label="F3 output for 1 1 1"></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn-lab8" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn-lab8" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <!-- Text Editor Section for Lab 8 -->
                <div class="k-map-simplification">
                    <h4>Write the three functions as sum of mean terms (ex: Fx = ∑(𝑚i , ..)):</h4>
                    <div class="simple-editor-container">
                        <div id="lab8-simple-editor-toolbar" class="simple-editor-toolbar">
                            <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                <i class="fas fa-superscript"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                <i class="fas fa-quote-right"></i>
                            </button>
                        </div>
                        <div id="lab8-simplification-editor" class="simple-editor" contenteditable="true" 
                             placeholder="Type your sum of mean terms here..."></div>
                    </div>
                    
                    <div class="k-map-actions">
                        <button id="show-answer-btn-lab8-truth-table" type="button" class="btn btn-accent">
                            <i class="fas fa-eye"></i> Show Answer
                        </button>
                    </div>
                </div>
                
                <p id="question3-lab8-text"><b>3. Design the circuit with a decoder and external gates for three functions (F1, F2, and F3):</b></p>
                <div style="text-align: left; margin-bottom: 1rem;">
                    <button id="chip-info-btn-lab8" type="button" class="btn btn-info">
                        <i class="fas fa-microchip"></i> Chip Info
                    </button>
                </div>
                
                <section class="logic-drawing-section" id="logic-drawing-lab8" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab8" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab8" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab8" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab8" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab8" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab8" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab8" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab8">100%</span>
                        <button id="downloadCanvasLab8" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab8" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab8" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <!-- Lab 8 Chip Info Modal -->
                <div id="chipModalLab8" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>IC 74283 4-bit Full Adder Pin Configuration</h3>
                            <button class="modal-close" id="closeChipModalLab8" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/IC_74283.png" alt="IC 74283 4-bit Full Adder Pin Configuration" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4>IC 74283 4-bit Full Adder</h4>
                                <p>The 74283 is a 4-bit binary full adder with fast carry lookahead. It features four full-adder stages with internal carry lookahead for high-speed operation, making it ideal for implementing the three functions (F1, F2, and F3) using decoder outputs and external gates.</p>
                                <div class="chip-features">
                                    <h5>Key Features:</h5>
                                    <ul>
                                        <li><strong>Package:</strong> 16-pin DIP</li>
                                        <li><strong>Supply Voltage:</strong> 4.75V to 5.25V</li>
                                        <li><strong>Propagation Delay:</strong> 15ns typical</li>
                                        <li><strong>Temperature Range:</strong> 0°C to 70°C</li>
                                        <li><strong>Inputs:</strong> A4, A3, A2, A1 (4-bit binary number A)</li>
                                        <li><strong>Inputs:</strong> B4, B3, B2, B1 (4-bit binary number B)</li>
                                        <li><strong>Input:</strong> C0 (Carry input)</li>
                                        <li><strong>Outputs:</strong> Σ4, Σ3, Σ2, Σ1 (4-bit sum)</li>
                                        <li><strong>Output:</strong> C4 (Carry output)</li>
                                    </ul>
                                </div>
                                
                                <!-- Detailed Solution Explanation Format -->
                                <div class="kmap-explanation" style="margin-top: 2rem;">
                                    <h4>Detailed Solution Explanation:</h4>
                                    <div class="math-solution">
                                        <div class="math-equation">
                                            <h5>Implementation Strategy:</h5>
                                            <p><strong>Using IC 74283 with Decoder and External Gates:</strong></p>
                                            <ul>
                                                <li><strong>Decoder Selection:</strong> Choose appropriate decoder (74139 for 2x4 or 74LS138/74LS238 for 3x8)</li>
                                                <li><strong>Input Mapping:</strong> Map input variables (Z, Y, X) to decoder inputs</li>
                                                <li><strong>Output Selection:</strong> Use decoder outputs to select specific minterms for each function</li>
                                                <li><strong>External Gates:</strong> Combine decoder outputs with OR gates to implement F1, F2, and F3</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Important Note:</h5>
                                            <p><strong>If you are going to use 74LS138 IC, the truth table of it is converted as ones becomes zeros and vice versa for output.</strong></p>
                                            <p>This means that for the 74LS138 decoder:</p>
                                            <ul>
                                                <li>When input combination is active, the corresponding output is LOW (0)</li>
                                                <li>All other outputs remain HIGH (1)</li>
                                                <li>This is the opposite behavior of standard decoders where active outputs are HIGH</li>
                                                <li>Consider this inversion when designing your external gate connections</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Boolean Algebra Answer Modal -->
                <div id="booleanAlgebraModalLab8" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="boolean-algebra-modal-title" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3 id="boolean-algebra-modal-title">Boolean Algebra Solution</h3>
                            <button class="modal-close" id="closeBooleanAlgebraModalLab8" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="answer-section" style="margin-top: 2rem;">
                                <h4>Your Answer:</h4>
                                <div id="user-boolean-algebra-display-lab8" class="answer-display"></div>
                            </div>
                            
                            <div class="answer-section" style="margin-top: 2rem;">
                                <h4>Correct Answer:</h4>
                                <div class="chip-image-container">
                                    <img src="media/Using_Boolean_Algebric.png" alt="Boolean Algebra Solution for Functions F1, F2, and F3" class="chip-image">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Lab 8 Text Editor Answer Modal -->
                <div id="lab8-text-editor-modal" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="lab8-modal-title" aria-hidden="true">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3 id="lab8-modal-title">Sum of Mean Terms Answer</h3>
                            <button class="modal-close" id="close-lab8-modal" aria-label="Close modal">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-content">
                            <div class="kmap-modal-layout">
                                <!-- Left Side: User's Answer -->
                                <div class="kmap-left-panel">
                                    <div class="answer-section">
                                        <h4>Your Answer:</h4>
                                        <div id="user-answer-display-lab8" class="answer-display"></div>
                                    </div>
                                </div>
                                
                                <!-- Right Side: Correct Answer -->
                                <div class="kmap-right-panel">
                                    <div class="answer-section">
                                        <h4>Correct Answer:</h4>
                                        <div id="correct-answer-display-lab8" class="answer-display correct-answer">
                                            <p><strong>Sum of minterms:</strong></p>
                                            <p>F1 = ∑(𝑚₀ , 𝑚₅ , 𝑚₇)</p>
                                            <p>F2 = ∑(𝑚₁ , 𝑚₂ , 𝑚₆)</p>
                                            <p>F3 = ∑(𝑚₀ , 𝑚₃ , 𝑚₇)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Explanation Below Both Panels -->
                            <div class="kmap-explanation">
                                <h4>Detailed Solution Explanation:</h4>
                                <div class="math-solution">
                                    <div class="math-equation">
                                        <h5>1) F1 = ∑(𝑚₀ , 𝑚₅ , 𝑚₇):</h5>
                                        <ul>
                                            <li>𝑚₀ (000): F1 = 1</li>
                                            <li>𝑚₅ (101): F1 = 1</li>
                                            <li>𝑚₇ (111): F1 = 1</li>
                                        </ul>
                                        <p>These minterms represent the input combinations where F1 equals 1 based on the truth table results above.</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>2) F2 = ∑(𝑚₁ , 𝑚₂ , 𝑚₆):</h5>
                                        <ul>
                                            <li>𝑚₁ (001): F2 = 1</li>
                                            <li>𝑚₂ (010): F2 = 1</li>
                                            <li>𝑚₆ (110): F2 = 1</li>
                                        </ul>
                                        <p>These minterms represent the input combinations where F2 equals 1 based on the truth table results above.</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>3) F3 = ∑(𝑚₀ , 𝑚₃ , 𝑚₇):</h5>
                                        <ul>
                                            <li>𝑚₀ (000): F3 = 1</li>
                                            <li>𝑚₃ (011): F3 = 1</li>
                                            <li>𝑚₇ (111): F3 = 1</li>
                                        </ul>
                                        <p>These minterms represent the input combinations where F3 equals 1 based on the truth table results above.</p>
                                    </div>
                                    
                                    <div class="math-equation">
                                        <h5>4) Summary:</h5>
                                        <p><strong>The correct answer is based on the truth table results above:</strong></p>
                                        <p>Each function F1, F2, and F3 is expressed as a sum of minterms where the function equals 1. The minterms are determined by analyzing the truth table and identifying which input combinations (Z, Y, X) produce an output of 1 for each function.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div class="simulator-container">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h3 class="section-title">3x8 Decoder with OR Gates Simulator</h3>
                    <button id="logicDesignBtnLab8" type="button" class="btn btn-info" style="font-size: 0.9rem; padding: 8px 16px;">
                        <i class="fas fa-project-diagram"></i> Logic Design
                    </button>
                </div>
                    <div class="simulator">
                        <div class="input-container">
                            <div>
                                <div class="input-switch">
                                    <input type="checkbox" id="lab8DecX" aria-label="Input X (Most Significant Bit)">
                                    <label class="slider" for="lab8DecX" tabindex="0" role="button" aria-pressed="false"></label>
                                </div>
                                <div class="input-label">X (MSB)</div>
                            </div>
                            <div>
                                <div class="input-switch">
                                    <input type="checkbox" id="lab8DecY" aria-label="Input Y">
                                    <label class="slider" for="lab8DecY" tabindex="0" role="button" aria-pressed="false"></label>
                                </div>
                                <div class="input-label">Y</div>
                            </div>
                            <div>
                                <div class="input-switch">
                                    <input type="checkbox" id="lab8DecZ" aria-label="Input Z (Least Significant Bit)">
                                    <label class="slider" for="lab8DecZ" tabindex="0" role="button" aria-pressed="false"></label>
                                </div>
                                <div class="input-label">Z (LSB)</div>
                            </div>
                        </div>
                        
                        <div class="gate-display">
                            <div>3x8 Decoder Outputs</div>
                            <div style="font-size: 0.9rem; margin-top: 10px; line-height: 1.4;">
                                D0: <span id="lab8D0">0</span> | D1: <span id="lab8D1">0</span> | D2: <span id="lab8D2">0</span> | D3: <span id="lab8D3">0</span><br>
                                D4: <span id="lab8D4">0</span> | D5: <span id="lab8D5">0</span> | D6: <span id="lab8D6">0</span> | D7: <span id="lab8D7">0</span>
                            </div>
                            <div style="font-size: 0.8rem; margin-top: 8px; color: var(--light);">
                                Binary: <span id="lab8BinaryInput">000</span> → Decimal: <span id="lab8DecimalInput">0</span>
                            </div>
                        </div>
                        
                        <div class="output-container">
                            <div>
                                <div>Function Outputs</div>
                                <div style="margin: 15px 0;">
                                    <div style="margin-bottom: 15px;">
                                        <div class="input-label">F1 (D0 + D5 + D7)</div>
                                        <div class="led-output" id="lab8F1Led"></div>
                                        <div class="input-label">State: <span id="lab8F1State">0 (LOW)</span></div>
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <div class="input-label">F2 (D1 + D2 + D6)</div>
                                        <div class="led-output" id="lab8F2Led"></div>
                                        <div class="input-label">State: <span id="lab8F2State">0 (LOW)</span></div>
                                    </div>
                                    <div>
                                        <div class="input-label">F3 (D0 + D3 + D7)</div>
                                        <div class="led-output" id="lab8F3Led"></div>
                                        <div class="input-label">State: <span id="lab8F3State">0 (LOW)</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Decoder Examples Modal -->
                <div id="decoderModalLab8" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Decoder Examples</h3>
                            <button class="modal-close" id="closeDecoderModalLab8" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-navigation">
                                <button id="decoder74139Btn" class="chip-nav-btn active" data-decoder="74139">Decoder (2x4)</button>
                                <button id="decoder74LS238Btn" class="chip-nav-btn" data-decoder="74LS238">Decoder (3x8)</button>
                            </div>
                            <div class="chip-image-container">
                                <img id="decoderImageLab8" src="media/Decoder_2_4.png" alt="Decoder 2x4 Example" class="chip-image">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Logic Design Modal -->
                <div id="logicDesignModalLab8" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Logic Design: 3x8 Decoder with External Gates</h3>
                            <button class="modal-close" id="closeLogicDesignModalLab8" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/Decoder_design_gates.svg" alt="Logic Design for Functions F1, F2, and F3 using 3x8 Decoder and External Gates" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4>Logic Design Implementation</h4>
                                <p>This diagram shows the complete logic design for implementing the three functions (F1, F2, and F3) using a 3x8 decoder and external OR gates. The design demonstrates how decoder outputs are combined to create the desired Boolean functions.</p>
                                
                                <div class="chip-features">
                                    <h5>Design Components:</h5>
                                    <ul>
                                        <li><strong>3x8 Decoder:</strong> Converts 3-bit binary input (Z, Y, X) to 8 active-low outputs</li>
                                        <li><strong>External OR Gates:</strong> Combine specific decoder outputs for each function</li>
                                        <li><strong>External NOT Gates:</strong> In order to invert active-low of 74138 IC</li>
                                        <li><strong>Function F1:</strong> D0 + D5 + D7 (sum of minterms 0, 5, and 7)</li>
                                        <li><strong>Function F2:</strong> D1 + D2 + D6 (sum of minterms 1, 2, and 6)</li>
                                        <li><strong>Function F3:</strong> D0 + D3 + D7 (sum of minterms 0, 3, and 7)</li>
                                    </ul>
                                </div>
                                
                                <!-- Important Note Section -->
                                <div class="kmap-explanation" style="margin-top: 2rem;">
                                    <h4>Important Implementation Note:</h4>
                                    <div class="math-solution">
                                        <div class="math-equation">
                                            <h5>Decoder IC Selection:</h5>
                                            <p><strong>If you use 74238 IC instead of 74138:</strong></p>
                                            <ul>
                                                <li><strong>74138 (Active-Low):</strong> Outputs are active-low (LOW when selected, HIGH when not selected)</li>
                                                <li><strong>74238 (Active-High):</strong> Outputs are active-high (HIGH when selected, LOW when not selected)</li>
                                                <li><strong>Design Modification:</strong> For 74238, simply remove the NOT gates from the above logic design</li>
                                                <li><strong>Connection:</strong> Connect decoder outputs directly to OR gate inputs without inversion</li>
                                                <li><strong>Result:</strong> The same logical functions (F1, F2, F3) will be achieved with simpler gate connections</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Implementation Summary:</h5>
                                            <p><strong>Current Design (74138):</strong> Uses active-low outputs with NOT gates for proper logic</p>
                                            <p><strong>Alternative Design (74238):</strong> Remove NOT gates and connect outputs directly to OR gates</p>
                                            <p><strong>Both Designs:</strong> Produce identical function outputs (F1, F2, F3) with different gate configurations</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Lab 9: Using Multiplexers -->
            <section id="lab9" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 9: Using Multiplexers</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>Becoming familiar with multiplexer and full adders</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74151</div>
                    <div class="ic-table-cell" role="cell">8-input multiplexer</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Implement the following Boolean function with 8*1 multiplexer
                        <div class="equation-box" style="text-align: center; margin: 15px 0;">
                            <div style="font-weight: 600; margin-bottom: 10px;">F(A,B,C,D) = Σ(0,3,4,7,8,9,12,15)</div>
                        </div>
                    </li>
                </ul>
                
                <h3 class="section-title">Understanding Multiplexer / Demultiplexer:</h3>
                <h4 style="margin-top: 0; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">Multiplexer:</h4>
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">General Multiplexer Block Diagram</h5>
                        <div class="image-container">
                            <img src="media/Mux_struc.png" alt="General Multiplexer Block Diagram with 2^n inputs, n selection lines, and 1 output" class="responsive-image">
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button id="multiplexer-info-btn-lab9" type="button" class="btn btn-info">
                                <i class="fas fa-microchip"></i> Multiplexer Info
                            </button>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Definition</h4>
                <p>A <strong>multiplexer</strong> is a data selector which takes several inputs and gives a single output. In multiplexer we have 2<sup>n</sup> input lines and 1 output lines where n is the number of selection lines.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Characteristics</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Input-Output Relationship:</strong> 2<sup>n</sup> inputs generate 1 output (where n is the number of selection bits)</li>
                    <li><strong>Data Selection:</strong> Selection lines determine which input is routed to the output</li>
                    <li><strong>Single Output:</strong> Only one input is selected and routed to the output at any given time</li>
                    <li><strong>Enable Control:</strong> Many multiplexers include enable inputs for output control and cascading</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Common Multiplexer Configurations</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>2-to-1 Multiplexer:</strong> 2 inputs → 1 output (2<sup>1</sup> = 2)</li>
                    <li><strong>4-to-1 Multiplexer:</strong> 4 inputs → 1 output (2<sup>2</sup> = 4)</li>
                    <li><strong>8-to-1 Multiplexer (74151):</strong> 8 inputs → 1 output (2<sup>3</sup> = 8)</li>
                    <li><strong>16-to-1 Multiplexer:</strong> 16 inputs → 1 output (2<sup>4</sup> = 16)</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Applications</h4>
                <p>Multiplexers are commonly used in:</p>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Data Routing:</strong> Selecting data from multiple sources to a single destination</li>
                    <li><strong>Address Multiplexing:</strong> Sharing address lines between different memory banks</li>
                    <li><strong>Function Implementation:</strong> Implementing Boolean functions using multiplexer inputs</li>
                    <li><strong>Data Transmission:</strong> Combining multiple data streams into a single channel</li>
                    <li><strong>Control Systems:</strong> Selecting control signals from multiple sources</li>
                </ul>

                                
                <h4 style="margin-top: 1.5rem; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">Demultiplexer:</h4>
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">General Demultiplexer Block Diagram</h5>
                        <div class="image-container">
                            <img src="media/DeMux_struc.png" alt="General Demultiplexer Block Diagram with 1 input, n selection lines, and 2^n outputs" class="responsive-image">
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button id="demultiplexer-info-btn-lab9" type="button" class="btn btn-info">
                                <i class="fas fa-microchip"></i> Demultiplexer Info
                            </button>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Definition</h4>
                <p>A <strong>demultiplexer</strong> is a data distributor which takes a single input and gives several outputs. In demultiplexer we have 1 input and 2<sup>n</sup> output lines where n is the selection line.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Characteristics</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Input-Output Relationship:</strong> 1 input generates 2<sup>n</sup> outputs (where n is the number of selection bits)</li>
                    <li><strong>Data Distribution:</strong> Selection lines determine which output receives the input data</li>
                    <li><strong>Single Input:</strong> Only one input is distributed to one of the multiple outputs at any given time</li>
                    <li><strong>Enable Control:</strong> Many demultiplexers include enable inputs for output control and cascading</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Common Demultiplexer Configurations</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>1-to-2 Demultiplexer:</strong> 1 input → 2 outputs (2<sup>1</sup> = 2)</li>
                    <li><strong>1-to-4 Demultiplexer:</strong> 1 input → 4 outputs (2<sup>2</sup> = 4)</li>
                    <li><strong>1-to-8 Demultiplexer:</strong> 1 input → 8 outputs (2<sup>3</sup> = 8)</li>
                    <li><strong>1-to-16 Demultiplexer:</strong> 1 input → 16 outputs (2<sup>4</sup> = 16)</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Applications</h4>
                <p>Demultiplexers are commonly used in:</p>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Data Distribution:</strong> Routing data from one source to multiple destinations</li>
                    <li><strong>Memory Address Decoding:</strong> Selecting specific memory locations or banks</li>
                    <li><strong>Display Control:</strong> Controlling multiple displays or LED segments from a single source</li>
                    <li><strong>Signal Routing:</strong> Directing control signals to different subsystems</li>
                    <li><strong>Communication Systems:</strong> Broadcasting data to multiple receivers</li>
                </ul>
                
                <!-- Pre-lab Activity Section -->
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth table for the function:</b></p>
                <div class="equation-box">
                    <span style="font-weight:600;">F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15)</span>
                </div>
                <div class="info-box" style="background: var(--card-bg); border-left: 4px solid var(--accent); padding: 1.5rem; margin: 1.5rem 0; border-radius: 8px; box-shadow: 0 3px 12px rgba(0,0,0,0.15);">
                    <h4 style="color: var(--accent); margin: 0 0 1rem 0; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-lightbulb"></i> Implementation Strategy
                    </h4>
                    <div style="display: grid; gap: 1rem;">
                        <div style="background: rgba(52,152,219,0.05); padding: 1rem; border-radius: 6px; border-left: 3px solid var(--secondary);">
                            <h5 style="color: var(--secondary); margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 600;">
                                <i class="fas fa-bullseye"></i> Objective
                            </h5>
                            <p style="margin: 0; color: var(--light); line-height: 1.6; font-size: 0.95rem;">
                                Implement the Boolean function F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15) using only one 8×1 Multiplexer (MUX).
                            </p>
                        </div>
                        <div style="background: rgba(52,152,219,0.05); padding: 1rem; border-radius: 6px; border-left: 3px solid var(--accent);">
                            <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 600;">
                                <i class="fas fa-cogs"></i> Strategy
                            </h5>
                            <p style="margin: 0; color: var(--light); line-height: 1.6; font-size: 0.95rem;">
                                Use A, B, C as selection lines and analyze D's influence on consecutive outputs. For each pair of consecutive rows (D=0, D=1), determine the optimal input to the MUX data lines.
                            </p>
                        </div>
                        <div style="background: rgba(52,152,219,0.05); padding: 1rem; border-radius: 6px; border-left: 3px solid #27ae60;">
                            <h5 style="color: #27ae60; margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 600;">
                                <i class="fas fa-list-check"></i> MUX Input Options
                            </h5>
                            <p style="margin: 0; color: var(--light); line-height: 1.6; font-size: 0.95rem;">
                                Each MUX data line can receive: <strong>0</strong>, <strong>1</strong>, <strong>D</strong>, or <strong>D'</strong> based on the pattern analysis of F outputs.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="responsive-table" style="margin-bottom: 1.2rem;">
                  <table id="lab9-truth-table">
                    <thead>
                      <tr>
                        <th>A</th>
                        <th>B</th>
                        <th>C</th>
                        <th>D</th>
                        <th>F</th>
                        <th>MUX Input</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>0</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 0 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="000" maxlength="2" inputmode="text" aria-label="MUX input for A=0 B=0 C=0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 0 1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 1 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="001" maxlength="2" inputmode="text" aria-label="MUX input for A=0 B=0 C=1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 0 1 1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 0 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="010" maxlength="2" inputmode="text" aria-label="MUX input for A=0 B=1 C=0"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 0 1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 1 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="011" maxlength="2" inputmode="text" aria-label="MUX input for A=0 B=1 C=1"></td>
                      </tr>
                      <tr>
                        <td>0</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="0" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 0 1 1 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="0" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 0 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="100" maxlength="2" inputmode="text" aria-label="MUX input for A=1 B=0 C=0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="0" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 0 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="0" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 1 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="101" maxlength="2" inputmode="numeric" aria-label="MUX input for A=1 B=0 C=1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>0</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="0" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 0 1 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>0</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="1" data-c="0" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 0 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="110" maxlength="2" inputmode="text" aria-label="MUX input for A=1 B=1 C=0"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>0</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="1" data-c="0" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 0 1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>1</td><td>0</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="1" data-c="1" data-d="0" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 1 0"></td>
                        <td rowspan="2"><input class="mux-input-field-lab9" data-abc="111" maxlength="2" inputmode="text" aria-label="MUX input for A=1 B=1 C=1"></td>
                      </tr>
                      <tr>
                        <td>1</td><td>1</td><td>1</td><td>1</td>
                        <td><input class="output-field-lab9" data-a="1" data-b="1" data-c="1" data-d="1" maxlength="1" inputmode="numeric" aria-label="F output for 1 1 1 1"></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                  <button id="check-answers-btn-lab9" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                  <button id="clear-table-btn-lab9" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <p id="question2-lab9-text"><b>2. Design the circuit with 8×1 multiplexer for F(A,B,C,D):</b></p>
                <div style="text-align: left; margin-bottom: 1rem;">
                    <button id="mux-info-btn-lab9" type="button" class="btn btn-info">
                        <i class="fas fa-microchip"></i> MUX Info
                    </button>
                </div>
                
                <section class="logic-drawing-section" id="logic-drawing-lab9" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab9" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab9" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab9" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab9" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab9" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab9" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab9" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab9">100%</span>
                        <button id="downloadCanvasLab9" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                      </div>
                    </div>
                    <div id="drawingContainerLab9" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab9" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <!-- Lab 9 MUX Info Modal -->
                <div id="muxModalLab9" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>8×1 Multiplexer (74151) Pin Configuration</h3>
                            <button class="modal-close" id="closeMuxModalLab9" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/74151_8x1_MUX.png" alt="8×1 Multiplexer (74151) Pin Configuration" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4>8×1 Multiplexer (74151)</h4>
                                <p>The 74151 is an 8-to-1 line data selector/multiplexer with complementary outputs. It features three binary select inputs (A, B, C) and eight data inputs (D0-D7), making it ideal for implementing the function F(A,B,C,D) using A, B, C as selection lines and D as the data input.</p>
                                <div class="chip-features">
                                    <h5>Key Features:</h5>
                                    <ul>
                                        <li><strong>Package:</strong> 16-pin DIP</li>
                                        <li><strong>Supply Voltage:</strong> 4.75V to 5.25V</li>
                                        <li><strong>Propagation Delay:</strong> 15ns typical</li>
                                        <li><strong>Temperature Range:</strong> 0°C to 70°C</li>
                                        <li><strong>Select Inputs:</strong> A, B, C (3-bit binary selection)</li>
                                        <li><strong>Data Inputs:</strong> D0-D7 (8 data input lines)</li>
                                        <li><strong>Outputs:</strong> Y (selected data output), W (complementary output)</li>
                                        <li><strong>Enable:</strong> G (active LOW enable input)</li>
                                    </ul>
                                </div>
                                
                                <!-- Detailed Solution Explanation Format -->
                                <div class="kmap-explanation" style="margin-top: 2rem;">
                                    <h4>Implementation Strategy:</h4>
                                    <div class="math-solution">
                                        <div class="math-equation">
                                            <h5>8×1 MUX Implementation:</h5>
                                            <p><strong>Using 74151 8×1 Multiplexer:</strong></p>
                                            <ul>
                                                <li><strong>Selection Lines:</strong> Connect A, B, C to the select inputs (A, B, C)</li>
                                                <li><strong>Data Lines:</strong> Connect D0-D7 based on MUX Input analysis from truth table</li>
                                                <li><strong>Data Inputs:</strong> Each data line receives 0, 1, D, or D' as determined</li>
                                                <li><strong>Output:</strong> Y output provides the function F(A,B,C,D)</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Important Note:</h5>
                                            <p><strong>The MUX Input column in the truth table determines what connects to each data line:</strong></p>
                                            <ul>
                                                <li><strong>0:</strong> Connect to ground (0V)</li>
                                                <li><strong>1:</strong> Connect to VCC (+5V)</li>
                                                <li><strong>D:</strong> Connect to input variable D</li>
                                                <li><strong>D':</strong> Connect to inverted input variable D (use NOT gate)</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div class="boolean-sim-module boolean-expr-sim" role="region" aria-labelledby="muxSimTitle">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h3 class="section-title" id="muxSimTitle">8×1 Multiplexer Simulator</h3>
                    <button id="logicDesignBtnLab9" type="button" class="btn btn-info" style="font-size: 0.9rem; padding: 8px 16px;">
                        <i class="fas fa-project-diagram"></i> Logic Design
                    </button>
                </div>
                    <p style="text-align: center; margin-bottom: 1rem; color: var(--text);">
                        <strong>A, B, C are selectors, D is data input</strong>
                    </p>
                    <div class="boolean-sim-flex">
                        <div class="boolean-sim-inputs">
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="muxA" aria-label="Selector A">
                                    <label class="slider" for="muxA"></label>
                                </div>
                                <div class="input-label">A (MSB)</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="muxB" aria-label="Selector B">
                                    <label class="slider" for="muxB"></label>
                                </div>
                                <div class="input-label">B</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="muxC" aria-label="Selector C">
                                    <label class="slider" for="muxC"></label>
                                </div>
                                <div class="input-label">C (LSB)</div>
                            </div>
                            <div class="input-switch-block">
                                <div class="input-switch">
                                    <input type="checkbox" id="muxD" aria-label="Data Input D">
                                    <label class="slider" for="muxD"></label>
                                </div>
                                <div class="input-label">D (Data)</div>
                            </div>
                        </div>
                        
                        <div class="gate-display">
                            <div>8×1 Multiplexer Data Inputs</div>
                            <div style="font-size: 0.9rem; margin-top: 10px; line-height: 1.4;">
                                D0: <span id="muxD0">0</span> | D1: <span id="muxD1">0</span> | D2: <span id="muxD2">0</span> | D3: <span id="muxD3">0</span><br>
                                D4: <span id="muxD4">0</span> | D5: <span id="muxD5">0</span> | D6: <span id="muxD6">0</span> | D7: <span id="muxD7">0</span>
                            </div>
                            <div style="font-size: 0.8rem; margin-top: 8px; color: var(--light);">
                                Selectors (A,B,C): <span id="muxSelectors">000</span> → Data Input D: <span id="muxDataInput">0</span>
                            </div>
                        </div>
                        
                        <div class="boolean-sim-output">
                            <div class="led-output" id="muxOutput" role="img" aria-label="Multiplexer Output LED" tabindex="0"></div>
                            <div class="input-label">Result: <span id="muxState">0 (LOW)</span></div>
                        </div>
                    </div>
                </div>
                
                <!-- Multiplexer Info Modal -->
                <div id="multiplexerModalLab9" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Multiplexer Examples</h3>
                            <button class="modal-close" id="closeMultiplexerModalLab9" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/MUX_4X1.png" alt="4x1 Multiplexer Example" class="chip-image">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Demultiplexer Info Modal -->
                <div id="demultiplexerModalLab9" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Demultiplexer Examples</h3>
                            <button class="modal-close" id="closeDemultiplexerModalLab9" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/DeMUX_4X1.png" alt="4x1 Demultiplexer Example" class="chip-image">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Logic Design Modal -->
                <div id="logicDesignModalLab9" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Logic Design: 8×1 Multiplexer Implementation</h3>
                            <button class="modal-close" id="closeLogicDesignModalLab9" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/8x1MUX_design_gates.svg" alt="Logic Design for Function F(A,B,C,D) using 8×1 Multiplexer" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4>Logic Design Implementation</h4>
                                <p>This diagram shows the complete logic design for implementing the function F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15) using an 8×1 multiplexer. The design demonstrates how the multiplexer data inputs are configured to achieve the desired Boolean function.</p>
                                
                                <div class="chip-features">
                                    <h5>Design Components:</h5>
                                    <ul>
                                        <li><strong>8×1 Multiplexer:</strong> Uses A, B, C as selection lines and D as data input</li>
                                        <li><strong>Data Input Configuration:</strong> Each data line (D0-D7) is connected based on the truth table analysis</li>
                                        <li><strong>Selection Logic:</strong> A, B, C combinations select the appropriate data input</li>
                                        <li><strong>Data Input D:</strong> The variable D is used as input to create the required function</li>
                                        <li><strong>Function F(A,B,C,D):</strong> Implements the sum of minterms 0, 3, 4, 7, 8, 9, 12, 15</li>
                                    </ul>
                                </div>
                                
                                <!-- Important Note Section -->
                                <div class="kmap-explanation" style="margin-top: 2rem;">
                                    <h4>Important Implementation Note:</h4>
                                    <div class="math-solution">
                                        <div class="math-equation">
                                            <h5>Data Input Strategy:</h5>
                                            <p><strong>Based on the truth table analysis:</strong></p>
                                            <ul>
                                                <li><strong>D0 (A=0,B=0,C=0):</strong> Connected to D' (inverted D) - Pattern: F(0,0,0,0)=1, F(0,0,0,1)=0</li>
                                                <li><strong>D1 (A=0,B=0,C=1):</strong> Connected to D - Pattern: F(0,0,1,0)=0, F(0,0,1,1)=1</li>
                                                <li><strong>D2 (A=0,B=1,C=0):</strong> Connected to D' - Pattern: F(0,1,0,0)=1, F(0,1,0,1)=0</li>
                                                <li><strong>D3 (A=0,B=1,C=1):</strong> Connected to D - Pattern: F(0,1,1,0)=0, F(0,1,1,1)=1</li>
                                                <li><strong>D4 (A=1,B=0,C=0):</strong> Connected to 1 (VCC) - Pattern: F(1,0,0,0)=1, F(1,0,0,1)=1</li>
                                                <li><strong>D5 (A=1,B=0,C=1):</strong> Connected to 0 (Ground) - Pattern: F(1,0,1,0)=0, F(1,0,1,1)=0</li>
                                                <li><strong>D6 (A=1,B=1,C=0):</strong> Connected to D' - Pattern: F(1,1,0,0)=1, F(1,1,0,1)=0</li>
                                                <li><strong>D7 (A=1,B=1,C=1):</strong> Connected to D - Pattern: F(1,1,1,0)=0, F(1,1,1,1)=1</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Implementation Summary:</h5>
                                            <p><strong>Multiplexer Configuration:</strong> A, B, C serve as selection lines (000 to 111)</p>
                                            <p><strong>Data Inputs:</strong> D0=D', D1=D, D2=D', D3=D, D4=1, D5=0, D6=D', D7=D</p>
                                            <p><strong>Result:</strong> The multiplexer output will be HIGH only for the specified minterms, implementing F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Lab 10: Flip Flops -->
            <section id="lab10" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 10: Flip Flops</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>Becoming familiar with flip flops such as D-flip flop, JK-flip flop. How to connect clock from the kit IC</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>This experiment uses the following TTL level ICs:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74175</div>
                    <div class="ic-table-cell" role="cell">D-Flip Flop</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74114</div>
                    <div class="ic-table-cell" role="cell">JK-Flip Flop</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                </div>
                
                <h3 class="section-title">Understanding JK-Flip Flop/ D-Flip Flop:</h3>
                <h4 style="margin-top: 0; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">D-Flip Flop:</h4>
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">General D-Flip Flop Block Diagram</h5>
                        <div class="image-container">
                            <img src="media/D_Flip Flop_understaning.PNG" alt="General D-Flip Flop Block Diagram with D input, clock, and Q output" class="responsive-image">
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button id="d-flipflop-info-btn-lab10" type="button" class="btn btn-info">
                                <i class="fas fa-microchip"></i> D-Flip Flop Info
                            </button>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Definition</h4>
                <p>A <strong>D-Flip Flop</strong> is a sequential logic device that stores one bit of data. The output Q follows the input D when a clock pulse is applied, making it a fundamental building block for memory and sequential circuits.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Characteristics</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Data Storage:</strong> Stores the value of D input at the rising edge of the clock</li>
                    <li><strong>Clock-Triggered:</strong> Output changes only on clock edge, not continuously</li>
                    <li><strong>Single Data Input:</strong> One data input (D) determines the next state</li>
                    <li><strong>Stable Output:</strong> Output remains stable between clock pulses</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Common D-Flip Flop Configurations</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Positive Edge-Triggered:</strong> Changes state on rising edge of clock signal</li>
                    <li><strong>Negative Edge-Triggered:</strong> Changes state on falling edge of clock signal</li>
                    <li><strong>Master-Slave:</strong> Two-stage design for improved noise immunity</li>
                    <li><strong>Asynchronous Reset:</strong> Direct reset capability independent of clock</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Applications</h4>
                <p>D-Flip Flops are commonly used in:</p>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Data Registers:</strong> Storing multiple bits of data in parallel</li>
                    <li><strong>Counters:</strong> Building sequential counting circuits</li>
                    <li><strong>Memory Elements:</strong> Basic storage units in digital systems</li>
                    <li><strong>State Machines:</strong> Implementing sequential logic circuits</li>
                    <li><strong>Data Synchronization:</strong> Aligning data with clock signals</li>
                </ul>

                                
                <h4 style="margin-top: 1.5rem; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">JK-Flip Flop:</h4>
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">General JK-Flip Flop Block Diagram</h5>
                        <div class="image-container">
                            <img src="media/JK_Flip Flop_understaning.PNG" alt="General JK-Flip Flop Block Diagram with J, K inputs, clock, and Q output" class="responsive-image">
                        </div>
                        <div style="text-align: center; margin-top: 1rem;">
                            <button id="jk-flipflop-info-btn-lab10" type="button" class="btn btn-info">
                                <i class="fas fa-microchip"></i> JK-Flip Flop Info
                            </button>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Definition</h4>
                <p>A <strong>JK-Flip Flop</strong> is a versatile sequential logic device that can perform multiple functions based on J and K inputs. It can be configured to act as a D-Flip Flop, T-Flip Flop, or maintain its current state.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Key Characteristics</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Dual Control Inputs:</strong> J and K inputs provide flexible control over output behavior</li>
                    <li><strong>Toggle Functionality:</strong> Can toggle output state when J=K=1</li>
                    <li><strong>Hold State:</strong> Maintains current output when J=K=0</li>
                    <li><strong>Clock-Triggered:</strong> Changes occur only on clock edge transitions</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Common JK-Flip Flop Configurations</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>J=0, K=0:</strong> No change (hold current state)</li>
                    <li><strong>J=0, K=1:</strong> Reset (Q = 0)</li>
                    <li><strong>J=1, K=0:</strong> Set (Q = 1)</li>
                    <li><strong>J=1, K=1:</strong> Toggle (Q = Q')</li>
                </ul>
                
                <h4 style="margin-top: 1.5rem; color: var(--secondary);">Applications</h4>
                <p>JK-Flip Flops are commonly used in:</p>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Frequency Dividers:</strong> Dividing clock frequency by 2</li>
                    <li><strong>Counters:</strong> Building various counting sequences</li>
                    <li><strong>Shift Registers:</strong> Moving data through sequential stages</li>
                    <li><strong>State Machines:</strong> Implementing complex sequential logic</li>
                    <li><strong>Memory Systems:</strong> Building reliable storage circuits</li>
                </ul>
                
                <!-- D-Flip Flop Info Modal -->
                <div id="dFlipFlopModalLab10" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>D-Flip Flop Simulation Screenshots</h3>
                            <button class="modal-close" id="closeDFlipFlopModalLab10" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/D_Simulation.png" alt="D-Flip Flop Simulation Example" class="chip-image">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- JK-Flip Flop Info Modal -->
                <div id="jkFlipFlopModalLab10" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>JK-Flip Flop Simulation Screenshots</h3>
                            <button class="modal-close" id="closeJKFlipFlopModalLab10" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/JK_Simulation.png" alt="JK-Flip Flop Simulation Example" class="chip-image">
                            </div>
                        </div>
                    </div>
                </div>
                
                <h3 class="section-title">Steps:</h3>
                <h4 style="margin-top: 0; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">General Steps:</h4>
                <h5 style="color: var(--accent); margin-bottom: 1rem;">Flip Flop Implementation Process</h5>
                <ol style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Power Setup:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Connect Vcc (+5V) and GND (0V) to power rails</li>
                            <li>Verify stable power supply before proceeding</li>
                        </ul>
                    </li>
                    <li><strong>IC Placement:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Insert IC into breadboard with proper orientation</li>
                            <li>Ensure all pins are properly seated</li>
                        </ul>
                    </li>
                    <li><strong>Input Connections:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Connect logic switches to input pins (J, K, D, Clock)</li>
                            <li>Connect Clear/Reset signals for initialization</li>
                        </ul>
                    </li>
                    <li><strong>Output Monitoring:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Connect LEDs to Q and Q̅ output pins</li>
                        </ul>
                    </li>
                    <li><strong>Clock Connection:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Connect clock signal from kit generator</li>
                            <li>Use manual button for single-step testing</li>
                        </ul>
                    </li>
                    <li><strong>Testing Sequence:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Initialize with Clear/Reset signal</li>
                            <li>Apply input combinations and observe outputs</li>
                            <li>Verify behavior matches truth table</li>
                        </ul>
                    </li>
                </ol>
                
                <h4 style="margin-top: 2rem; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">D Flip-Flop (74175) IC:</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Testing Procedure:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Set CLR̅ = LOW briefly to clear Q=0, Q̅=1</li>
                            <li>Set CLR̅ = HIGH, PRE̅ = HIGH for normal operation</li>
                            <li>Apply D input and clock pulse: Q follows D at rising edge</li>
                            <li>Test: D=0→Q=0, D=1→Q=1 after clock pulse</li>
                        </ul>
                    </li>
                </ul>
                
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">74175 D-Flip Flop Pin Configuration</h5>
                        <div class="image-container">
                            <img src="media/74175_D_FlipFlop.png" alt="74175 D-Flip Flop IC Pin Configuration and Connection Diagram" class="responsive-image">
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 2rem; color: var(--secondary); font-size: 1.3rem; font-weight: 600;">JK Flip-Flop (74114) IC:</h4>
                <ul style="margin-left: 1.5rem; color: var(--light); line-height: 1.6;">
                    <li><strong>Testing Procedure:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>Set CLR̅ = LOW briefly to clear Q=0, Q̅=1</li>
                            <li>Set CLR̅ = HIGH, PRE̅ = HIGH for normal operation</li>
                            <li>Test truth table: J=0,K=0 (hold), J=0,K=1 (reset), J=1,K=0 (set), J=1,K=1 (toggle)</li>
                        </ul>
                    </li>
                </ul>
                
                <div class="full-adder-diagram">
                    <div class="diagram-section">
                        <h5 style="color: var(--accent); margin-bottom: 1rem; text-align: center;">74114 JK-Flip Flop Pin Configuration</h5>
                        <div class="image-container">
                            <img src="media/74114_JK_FlipFlop.gif" alt="74114 JK-Flip Flop IC Pin Configuration and Connection Diagram" class="responsive-image">
                        </div>
                    </div>
                </div>
                
                <div class="simulator-container">
                    <h3 class="section-title">Flip Flop Simulator</h3>
                    
                    <!-- Clock Control Panel -->
                    <div class="clock-control-panel" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; border: 1px solid var(--border);">
                        <h4 style="color: var(--accent); margin-bottom: 1rem; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            Clock Signal Generator
                            <button type="button" class="tooltip-trigger" aria-label="Clock Signal Generator Information" data-tooltip="clock-generator-tooltip">
                                <i class="fas fa-info-circle" style="color: var(--accent); font-size: 1rem;"></i>
                            </button>
                        </h4>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <label for="clockFrequency" style="color: var(--text); font-weight: 500;">Frequency:</label>
                                <select id="clockFrequency" style="padding: 0.5rem; border: 1px solid var(--border); border-radius: 5px; background: var(--bg-primary); color: var(--text);">
                                    <option value="0.5">0.5 Hz (Slow)</option>
                                    <option value="1" selected>1 Hz (Normal)</option>
                                    <option value="2">2 Hz (Fast)</option>
                                    <option value="5">5 Hz (Very Fast)</option>
                                </select>
                            </div>
                            <button id="startClockBtn" class="btn btn-success" style="padding: 0.5rem 1rem;">
                                <i class="fas fa-play"></i> Start Clock
                            </button>
                            <button id="stopClockBtn" class="btn btn-danger" style="padding: 0.5rem 1rem; display: none;">
                                <i class="fas fa-stop"></i> Stop Clock
                            </button>
                            <button id="singlePulseBtn" class="btn btn-info" style="padding: 0.5rem 1rem;">
                                <i class="fas fa-bolt"></i> Single Pulse
                            </button>
                            <button id="resetFlipFlopsBtn" class="btn btn-warning" style="padding: 0.5rem 1rem;">
                                <i class="fas fa-undo"></i> Reset Flip Flops
                            </button>
                        </div>
                        
                        <!-- Clock Waveform Display -->
                        <div class="clock-waveform" style="margin-top: 1rem; text-align: center;">
                            <div style="color: var(--text); font-weight: 500; margin-bottom: 0.5rem;">Clock Signal Waveform:</div>
                            <div id="clockWaveform" style="height: 60px; background: var(--bg-primary); border: 2px solid var(--border); border-radius: 8px; position: relative; overflow: hidden;">
                                <div id="clockSignal" style="position: absolute; top: 50%; left: 0; width: 100%; height: 4px; background: var(--accent); transform: translateY(-50%); transition: all 0.1s ease;"></div>
                                <div id="clockState" style="position: absolute; top: 10px; right: 10px; color: var(--accent); font-weight: bold; font-size: 0.9rem;">LOW</div>
                                <div id="clockEdge" style="position: absolute; bottom: 10px; left: 10px; color: var(--secondary); font-size: 0.8rem;">Rising Edge</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Simulator Navigation -->
                    <div class="simulator-navigation" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; border: 1px solid var(--border); text-align: center;">
                        <h4 style="color: var(--accent); margin-bottom: 1rem; font-size: 1.1rem;">Choose Simulator</h4>
                        <div class="nav-buttons-container" style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                            <button id="showDFlipFlopBtn" class="btn btn-primary simulator-nav-btn active" style="padding: 0.8rem 1.5rem; font-weight: 600; min-width: 160px;">
                                <i class="fas fa-microchip"></i> D Flip Flop (74175)
                            </button>
                            <button id="showJKFlipFlopBtn" class="btn btn-secondary simulator-nav-btn" style="padding: 0.8rem 1.5rem; font-weight: 600; min-width: 160px;">
                                <i class="fas fa-microchip"></i> JK Flip Flop (74114)
                            </button>
                            <button id="showBothBtn" class="btn btn-success simulator-nav-btn" style="padding: 0.8rem 1.5rem; font-weight: 600; min-width: 160px;">
                                <i class="fas fa-th-large"></i> Show Both
                            </button>
                                    </div>
                                </div>
                    
                    <!-- D Flip Flop Simulator -->
                    <div id="dFlipFlopSimulator" class="boolean-sim-module" role="region" aria-labelledby="dFlipFlopTitle">
                        <h4 id="dFlipFlopTitle" style="color: var(--accent); margin-bottom: 1rem; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            D Flip Flop (74175) Simulator
                            <button type="button" class="tooltip-trigger" aria-label="D Flip Flop Simulator Information" data-tooltip="d-flipflop-tooltip">
                                <i class="fas fa-info-circle" style="color: var(--accent); font-size: 1rem;"></i>
                            </button>
                        </h4>
                        <div class="simulator">
                            <div class="input-container">
                                <!-- Clock Indicator -->
                                <div class="clock-indicator" style="text-align: center; padding: 0.8rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); margin-bottom: 1rem;">
                                    <div id="dFlipFlopClockState" style="font-size: 1.3rem; font-weight: bold; color: var(--accent);">LOW</div>
                                    <div class="input-label">Clock (CLK)</div>
                                </div>
                                
                                <!-- Clear and Preset Buttons -->
                                <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                    <div class="input-switch">
                                            <input type="checkbox" id="dFlipFlopClear" aria-label="Clear Signal (Active LOW)">
                                        <label class="slider" for="dFlipFlopClear"></label>
                                    </div>
                                    <div class="input-label">Clear (CLR̅)</div>
                                </div>
                                    <div>
                                    <div class="input-switch">
                                            <input type="checkbox" id="dFlipFlopPreset" aria-label="Preset Signal (Active LOW)">
                                        <label class="slider" for="dFlipFlopPreset"></label>
                                    </div>
                                    <div class="input-label">Preset (PRE̅)</div>
                                </div>
                                    </div>
                                
                                <!-- D Input Button -->
                                <div>
                                    <div class="input-switch">
                                        <input type="checkbox" id="dFlipFlopInput" aria-label="D Input">
                                        <label class="slider" for="dFlipFlopInput"></label>
                                    </div>
                                    <div class="input-label">D Input</div>
                                </div>
                            </div>
                            
                            <div class="gate-display">
                                <div>D Flip Flop Logic States</div>
                                <div style="font-size: 0.9rem; margin-top: 10px; line-height: 1.4;">
                                    D: <span id="dFlipFlopDState">0</span> | CLR̅: <span id="dFlipFlopClearState">1</span> | PRE̅: <span id="dFlipFlopPresetState">1</span>
                                </div>
                                <div style="font-size: 0.8rem; margin-top: 8px; color: var(--light);">
                                    Clock Edge: <span id="dFlipFlopClockEdge">Rising</span> | Previous Q: <span id="dFlipFlopPrevQ">0</span>
                                </div>
                                <div style="font-size: 0.8rem; margin-top: 8px; color: var(--accent);">
                                    <strong>Operation:</strong> <span id="dFlipFlopOperation">Normal</span>
                                </div>
                            </div>
                            
                            <div class="output-container">
                                <div>
                                    <div class="input-label">Q Output</div>
                                <div class="led-output" id="dFlipFlopQLed" role="img" aria-label="D Flip Flop Q Output LED" tabindex="0"></div>
                                    <div class="input-label">State: <span id="dFlipFlopQState">0 (LOW)</span></div>
                                </div>
                                <div>
                                    <div class="input-label">Q̅ Output</div>
                                    <div class="led-output" id="dFlipFlopQBarLed" role="img" aria-label="D Flip Flop Q̅ Output LED" tabindex="0"></div>
                                    <div class="input-label">State: <span id="dFlipFlopQBarState">1 (HIGH)</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- JK Flip Flop Simulator -->
                    <div id="jkFlipFlopSimulator" class="boolean-sim-module" role="region" aria-labelledby="jkFlipFlopTitle" style="margin-top: 2rem;">
                        <h4 id="jkFlipFlopTitle" style="color: var(--accent); margin-bottom: 1rem; text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            JK Flip Flop (74114) Simulator
                            <button type="button" class="tooltip-trigger" aria-label="JK Flip Flop Simulator Information" data-tooltip="jk-flipflop-tooltip">
                                <i class="fas fa-info-circle" style="color: var(--accent); font-size: 1rem;"></i>
                            </button>
                        </h4>
                        <div class="simulator">
                            <div class="input-container">
                                <!-- Clock Indicator -->
                                <div class="clock-indicator" style="text-align: center; padding: 0.8rem; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border); margin-bottom: 1rem;">
                                    <div id="jkFlipFlopClockState" style="font-size: 1.3rem; font-weight: bold; color: var(--accent);">LOW</div>
                                    <div class="input-label">Clock (CLK)</div>
                                    </div>
                                
                                <!-- Clear and Preset Buttons -->
                                <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                    <div class="input-switch">
                                            <input type="checkbox" id="jkFlipFlopClear" aria-label="Clear Signal (Active LOW)">
                                        <label class="slider" for="jkFlipFlopClear"></label>
                                    </div>
                                    <div class="input-label">Clear (CLR̅)</div>
                                </div>
                                    <div>
                                    <div class="input-switch">
                                            <input type="checkbox" id="jkFlipFlopPreset" aria-label="Preset Signal (Active LOW)">
                                        <label class="slider" for="jkFlipFlopPreset"></label>
                                    </div>
                                    <div class="input-label">Preset (PRE̅)</div>
                                </div>
                                    </div>
                                
                                <!-- J and K Input Buttons -->
                                <div style="display: flex; gap: 1rem;">
                                    <div>
                                        <div class="input-switch">
                                            <input type="checkbox" id="jkFlipFlopJ" aria-label="J Input">
                                            <label class="slider" for="jkFlipFlopJ"></label>
                                        </div>
                                        <div class="input-label">J Input</div>
                                    </div>
                                    <div>
                                        <div class="input-switch">
                                            <input type="checkbox" id="jkFlipFlopK" aria-label="K Input">
                                            <label class="slider" for="jkFlipFlopK"></label>
                                        </div>
                                        <div class="input-label">K Input</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="gate-display">
                                <div>JK Flip Flop Logic States</div>
                                <div style="font-size: 0.9rem; margin-top: 10px; line-height: 1.4;">
                                    J: <span id="jkFlipFlopJState">0</span> | K: <span id="jkFlipFlopKState">0</span> | CLR̅: <span id="jkFlipFlopClearState">1</span> | PRE̅: <span id="jkFlipFlopPresetState">1</span>
                                </div>
                                <div style="font-size: 0.8rem; margin-top: 8px; color: var(--light);">
                                    Mode: <span id="jkFlipFlopMode">Hold</span> | Previous Q: <span id="jkFlipFlopPrevQ">0</span>
                                </div>
                                <div style="font-size: 0.8rem; margin-top: 8px; color: var(--accent);">
                                    <strong>Operation:</strong> <span id="jkFlipFlopOperation">Normal</span>
                                </div>
                                <div style="font-size: 0.8rem; margin-top: 8px; color: var(--secondary);">
                                    <strong>Truth Table:</strong> <span id="jkFlipFlopTruthTable">J=0,K=0 (Hold)</span>
                                </div>
                            </div>
                            
                            <div class="output-container">
                                <div>
                                    <div class="input-label">Q Output</div>
                                <div class="led-output" id="jkFlipFlopQLed" role="img" aria-label="JK Flip Flop Q Output LED" tabindex="0"></div>
                                    <div class="input-label">State: <span id="jkFlipFlopQState">0 (LOW)</span></div>
                                </div>
                                <div>
                                    <div class="input-label">Q̅ Output</div>
                                    <div class="led-output" id="jkFlipFlopQBarLed" role="img" aria-label="JK Flip Flop Q̅ Output LED" tabindex="0"></div>
                                    <div class="input-label">State: <span id="jkFlipFlopQBarState">1 (HIGH)</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Tooltips for Flip Flop Simulators and MOD-7 Counter -->
                    <div class="enhanced-tooltips-container" style="position: relative;">

                        
                        <!-- MOD-7 Counter Simulator Tooltip -->
                        <div id="mod7-counter-tooltip" class="enhanced-tooltip" style="display: none;">
                            <div class="tooltip-header">
                                <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1.1rem;">MOD-7 Counter Simulator</h5>
                                <button type="button" class="tooltip-close" aria-label="Close tooltip">×</button>
                            </div>
                            <div class="tooltip-content">
                                <p style="margin: 0 0 0.8rem 0; line-height: 1.5;"><strong>Purpose:</strong> Simulates a 3-bit MOD-7 counter using JK Flip Flops with external gates.</p>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Counter Sequence:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Binary:</strong> 000 → 001 → 010 → 011 → 100 → 101 → 110 → 000</li>
                                        <li><strong>Decimal:</strong> 0 → 1 → 2 → 3 → 4 → 5 → 6 → 0</li>
                                        <li><strong>Cycle:</strong> Repeats indefinitely with clock pulses</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Components:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>3 JK Flip Flops:</strong> A (MSB), B, C (LSB)</li>
                                        <li><strong>External Gates:</strong> Combinational logic for next state</li>
                                        <li><strong>Clock Signal:</strong> Synchronizes all transitions</li>
                                        <li><strong>7-Segment Display:</strong> Shows decimal output</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Operation:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li>Clock rising edge triggers state change</li>
                                        <li>JK inputs determine next state based on current state</li>
                                        <li>Binary outputs drive 7-segment display</li>
                                        <li>Debug logger shows internal JK states</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <!-- D Flip Flop Tooltip -->
                        <div id="d-flipflop-tooltip" class="enhanced-tooltip" style="display: none;">
                            <div class="tooltip-header">
                                <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1.1rem;">D Flip Flop (74175) Simulator</h5>
                                <button type="button" class="tooltip-close" aria-label="Close tooltip">×</button>
                            </div>
                            <div class="tooltip-content">
                                <p style="margin: 0 0 0.8rem 0; line-height: 1.5;"><strong>IC 74175:</strong> Quad D-type flip flop with clear and preset capabilities.</p>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Operation Modes:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Asynchronous Clear (CLR̅):</strong> Immediate reset when active LOW</li>
                                        <li><strong>Asynchronous Preset (PRE̅):</strong> Immediate set when active LOW</li>
                                        <li><strong>Synchronous Data:</strong> Q follows D at clock rising edge</li>
                                        <li><strong>Normal Operation:</strong> Maintains current state</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Setup Time Violation:</h6>
                                    <p style="margin: 0; line-height: 1.4; font-size: 0.9rem;">Occurs when D input changes during the setup time window before the clock rising edge. This is normal behavior that simulates real IC timing requirements.</p>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Truth Table:</h6>
                                    <div class="truth-table-container" style="background: var(--bg-secondary); padding: 0.8rem; border-radius: 8px; overflow-x: auto;">
                                        <table class="enhanced-truth-table" role="table" aria-label="D Flip Flop Truth Table">
                                            <thead>
                                                <tr>
                                                    <th scope="col">CLR̅</th>
                                                    <th scope="col">PRE̅</th>
                                                    <th scope="col">CLK</th>
                                                    <th scope="col">D</th>
                                                    <th scope="col">Q</th>
                                                    <th scope="col">Q̅</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>0</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                </tr>
                                                <tr>
                                                    <td>X</td>
                                                    <td>0</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>0</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- JK Flip Flop Tooltip -->
                        <div id="jk-flipflop-tooltip" class="enhanced-tooltip" style="display: none;">
                            <div class="tooltip-header">
                                <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1.1rem;">JK Flip Flop (74114) Simulator</h5>
                                <button type="button" class="tooltip-close" aria-label="Close tooltip">×</button>
                            </div>
                            <div class="tooltip-content">
                                <p style="margin: 0 0 0.8rem 0; line-height: 1.5;"><strong>IC 74114:</strong> Dual JK flip flop with clear and preset capabilities.</p>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Operation Modes:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Hold (J=0, K=0):</strong> Maintains current state</li>
                                        <li><strong>Reset (J=0, K=1):</strong> Sets Q = 0, Q̅ = 1</li>
                                        <li><strong>Set (J=1, K=0):</strong> Sets Q = 1, Q̅ = 0</li>
                                        <li><strong>Toggle (J=1, K=1):</strong> Q changes to opposite state</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Truth Table:</h6>
                                    <div class="truth-table-container" style="background: var(--bg-secondary); padding: 0.8rem; border-radius: 8px; overflow-x: auto;">
                                        <table class="enhanced-truth-table" role="table" aria-label="JK Flip Flop Truth Table">
                                            <thead>
                                                <tr>
                                                    <th scope="col">CLR̅</th>
                                                    <th scope="col">PRE̅</th>
                                                    <th scope="col">CLK</th>
                                                    <th scope="col">J</th>
                                                    <th scope="col">K</th>
                                                    <th scope="col">Q</th>
                                                    <th scope="col">Q̅</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>0</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                </tr>
                                                <tr>
                                                    <td>X</td>
                                                    <td>0</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>X</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>0</td>
                                                    <td>0</td>
                                                    <td>Q</td>
                                                    <td>Q̅</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                    <td>1</td>
                                                    <td>0</td>
                                                </tr>
                                                <tr>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>↑</td>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>Q̅</td>
                                                    <td>Q</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Key Features:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Versatile Operation:</strong> Four distinct modes of operation</li>
                                        <li><strong>Toggle Mode:</strong> Useful for frequency division and counting</li>
                                        <li><strong>Asynchronous Control:</strong> Immediate clear/preset regardless of clock</li>
                                        <li><strong>Setup Time:</strong> J,K inputs must be stable before clock edge</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Clock Signal Generator Tooltip -->
                        <div id="clock-generator-tooltip" class="enhanced-tooltip" style="display: none;">
                            <div class="tooltip-header">
                                <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1.1rem;">Clock Signal Generator</h5>
                                <button type="button" class="tooltip-close" aria-label="Close tooltip">×</button>
                            </div>
                            <div class="tooltip-content">
                                <p style="margin: 0 0 0.8rem 0; line-height: 1.5;"><strong>Purpose:</strong> Generates digital clock signals for flip flop simulation and testing.</p>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Frequency Options:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>0.5 Hz (Slow):</strong> 2-second period, ideal for detailed observation</li>
                                        <li><strong>1 Hz (Normal):</strong> 1-second period, standard simulation speed</li>
                                        <li><strong>2 Hz (Fast):</strong> 0.5-second period, faster operation</li>
                                        <li><strong>5 Hz (Very Fast):</strong> 0.2-second period, rapid testing</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Control Functions:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Start Clock:</strong> Begins continuous clock signal generation</li>
                                        <li><strong>Stop Clock:</strong> Halts clock signal generation</li>
                                        <li><strong>Single Pulse:</strong> Generates one complete clock cycle</li>
                                        <li><strong>Reset Flip Flops:</strong> Clears all flip flop states to initial values</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Clock Signal Characteristics:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Square Wave:</strong> Digital signal with sharp transitions</li>
                                        <li><strong>50% Duty Cycle:</strong> Equal HIGH and LOW periods</li>
                                        <li><strong>Rising Edge:</strong> Positive transition (LOW to HIGH)</li>
                                        <li><strong>Falling Edge:</strong> Negative transition (HIGH to LOW)</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Visual Indicators:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Waveform Display:</strong> Real-time visual representation of clock signal</li>
                                        <li><strong>State Indicator:</strong> Shows current clock level (HIGH/LOW)</li>
                                        <li><strong>Edge Indicator:</strong> Displays current transition type</li>
                                        <li><strong>Color Coding:</strong> Visual feedback for signal state changes</li>
                                    </ul>
                                </div>
                                
                                <div style="margin: 0 0 0.8rem 0;">
                                    <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Key Features:</h6>
                                    <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                        <li><strong>Variable Frequency:</strong> Adjustable clock speed for different testing needs</li>
                                        <li><strong>Real-time Control:</strong> Immediate start/stop functionality</li>
                                        <li><strong>Single Pulse Mode:</strong> Step-by-step analysis capability</li>
                                        <li><strong>Synchronized Operation:</strong> All flip flops respond to same clock signal</li>
                                        <li><strong>Visual Feedback:</strong> Clear indication of clock state and transitions</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Lab 11: Using Counters -->
            <section id="lab11" class="lab-section hidden" style="max-width:var(--max-width);margin:0 auto 3rem auto;">
                <div class="lab-header">
                    <h2 class="lab-title">Lab 11: Using Counters</h2>
                </div>
                
                <h3 class="section-title">Objectives:</h3>
                <p>How to use counter IC and how to design counter with a specific count</p>
                
                <h3 class="section-title">Experiments Requirements:</h3>
                <p>This experiment uses the following TTL level ICs; the pin configurations for these ICs are available in appendix A:</p>
                <div class="ic-table-grid" role="table" aria-label="IC Requirements">
                  <div class="ic-table-row ic-table-header" role="row">
                    <div class="ic-table-cell" role="columnheader">IC Number</div>
                    <div class="ic-table-cell" role="columnheader">Description</div>
                    <div class="ic-table-cell" role="columnheader">Quantity</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7404</div>
                    <div class="ic-table-cell" role="cell">Hex inverter</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7408</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input AND gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">7432</div>
                    <div class="ic-table-cell" role="cell">Quad 2-input OR gate</div>
                    <div class="ic-table-cell" role="cell">1</div>
                  </div>
                  <div class="ic-table-row" role="row">
                    <div class="ic-table-cell" role="cell">74114</div>
                    <div class="ic-table-cell" role="cell">J-K flip flop</div>
                    <div class="ic-table-cell" role="cell">2</div>
                  </div>
                </div>
                
                <h3 class="section-title">Procedure:</h3>
                <ul class="steps-list">
                    <li>Design a counter with the following binary repeated sequence: 0, 1, 2, 3, 4, 5, 6 using JK flip-flops and external gates</li>
                </ul>
                
                <h3 class="section-title">Pre-lab Activity:</h3>
                <p><b>1. Fill the following truth table for designing of counter using 3 JK flip-flops:</b></p>
                <p style="margin-bottom: 1rem; color: var(--text-secondary); font-size: 0.95rem;">
                    <em>Note that To build the truth table of the MOD-7 counter, first list the present state (A,B,C) and its next state according to the sequence 0→1→2→3→4→5→6→0, then—based on the following truth table of the JK flip-flop—determine the required inputs (JA–KA, JB–KB, JC–KC) for each transition.</em>
                </p>
                
                <!-- JK Transition Truth Table Image -->
                <div style="text-align: center; margin: 2rem 0;">
                    <img src="media/JK-transition-truthtable.PNG" alt="JK Flip Flop Transition Truth Table" class="responsive-image" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
                </div>
                
                <!-- MOD-7 Counter Truth Table -->
                <div class="responsive-table" style="margin-bottom: 1.2rem; overflow-x: auto; -webkit-overflow-scrolling: touch;">
                    <table class="truth-table" id="lab11-counter-truth-table">
                        <thead>
                            <tr>
                                <th>A</th>
                                <th>B</th>
                                <th>C</th>
                                <th>JA</th>
                                <th>KA</th>
                                <th>JB</th>
                                <th>KB</th>
                                <th>JC</th>
                                <th>KC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0</td><td>0</td><td>0</td>
                                <td><input class="output-field-lab11" data-row="0" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 000"></td>
                                <td><input class="output-field-lab11" data-row="0" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 000"></td>
                                <td><input class="output-field-lab11" data-row="0" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 000"></td>
                                <td><input class="output-field-lab11" data-row="0" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 000"></td>
                                <td><input class="output-field-lab11" data-row="0" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 000"></td>
                                <td><input class="output-field-lab11" data-row="0" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 000"></td>
                            </tr>
                            <tr>
                                <td>0</td><td>0</td><td>1</td>
                                <td><input class="output-field-lab11" data-row="1" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 001"></td>
                                <td><input class="output-field-lab11" data-row="1" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 001"></td>
                                <td><input class="output-field-lab11" data-row="1" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 001"></td>
                                <td><input class="output-field-lab11" data-row="1" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 001"></td>
                                <td><input class="output-field-lab11" data-row="1" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 001"></td>
                                <td><input class="output-field-lab11" data-row="1" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 001"></td>
                            </tr>
                            <tr>
                                <td>0</td><td>1</td><td>0</td>
                                <td><input class="output-field-lab11" data-row="2" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 010"></td>
                                <td><input class="output-field-lab11" data-row="2" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 010"></td>
                                <td><input class="output-field-lab11" data-row="2" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 010"></td>
                                <td><input class="output-field-lab11" data-row="2" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 010"></td>
                                <td><input class="output-field-lab11" data-row="2" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 010"></td>
                                <td><input class="output-field-lab11" data-row="2" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 010"></td>
                            </tr>
                            <tr>
                                <td>0</td><td>1</td><td>1</td>
                                <td><input class="output-field-lab11" data-row="3" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 011"></td>
                                <td><input class="output-field-lab11" data-row="3" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 011"></td>
                                <td><input class="output-field-lab11" data-row="3" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 011"></td>
                                <td><input class="output-field-lab11" data-row="3" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 011"></td>
                                <td><input class="output-field-lab11" data-row="3" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 011"></td>
                                <td><input class="output-field-lab11" data-row="3" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 011"></td>
                            </tr>
                            <tr>
                                <td>1</td><td>0</td><td>0</td>
                                <td><input class="output-field-lab11" data-row="4" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 100"></td>
                                <td><input class="output-field-lab11" data-row="4" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 100"></td>
                                <td><input class="output-field-lab11" data-row="4" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 100"></td>
                                <td><input class="output-field-lab11" data-row="4" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 100"></td>
                                <td><input class="output-field-lab11" data-row="4" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 100"></td>
                                <td><input class="output-field-lab11" data-row="4" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 100"></td>
                            </tr>
                            <tr>
                                <td>1</td><td>0</td><td>1</td>
                                <td><input class="output-field-lab11" data-row="5" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 101"></td>
                                <td><input class="output-field-lab11" data-row="5" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 101"></td>
                                <td><input class="output-field-lab11" data-row="5" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 101"></td>
                                <td><input class="output-field-lab11" data-row="5" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 101"></td>
                                <td><input class="output-field-lab11" data-row="5" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 101"></td>
                                <td><input class="output-field-lab11" data-row="5" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 101"></td>
                            </tr>
                            <tr>
                                <td>1</td><td>1</td><td>0</td>
                                <td><input class="output-field-lab11" data-row="6" data-col="0" maxlength="1" inputmode="none" aria-label="JA for state 110"></td>
                                <td><input class="output-field-lab11" data-row="6" data-col="1" maxlength="1" inputmode="none" aria-label="KA for state 110"></td>
                                <td><input class="output-field-lab11" data-row="6" data-col="2" maxlength="1" inputmode="none" aria-label="JB for state 110"></td>
                                <td><input class="output-field-lab11" data-row="6" data-col="3" maxlength="1" inputmode="none" aria-label="KB for state 110"></td>
                                <td><input class="output-field-lab11" data-row="6" data-col="4" maxlength="1" inputmode="none" aria-label="JC for state 110"></td>
                                <td><input class="output-field-lab11" data-row="6" data-col="5" maxlength="1" inputmode="none" aria-label="KC for state 110"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Table Control Buttons -->
                <div class="table-buttons" style="display:flex;gap:1rem;margin-bottom:1.5rem;">
                    <button id="check-answers-btn-lab11" type="button" class="btn btn-pdf" style="min-width:160px;"><i class="fas fa-check-circle"></i> Show Correct Answers</button>
                    <button id="clear-table-btn-lab11" type="button" class="btn btn-png" style="min-width:120px;"><i class="fas fa-eraser"></i> Clear Table</button>
                </div>
                
                <p><b>2. Simplify (JA - KA - JB - KB - JC - KC) using K-maps:</b></p>
                
                <!-- K-Map Navigation -->
                <div class="kmap-navigation" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; border: 1px solid var(--border); text-align: center;">
                    <h4 style="color: var(--accent); margin-bottom: 1rem; font-size: 1.1rem;">Choose K-Map</h4>
                    <div class="nav-buttons-container" style="display: flex; justify-content: center; gap: 0.8rem; flex-wrap: wrap;">
                        <button id="showJAkmapBtn" class="btn kmap-nav-btn active" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> JA
                        </button>
                        <button id="showKAkmapBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> KA
                        </button>
                        <button id="showJBkmapBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> JB
                        </button>
                        <button id="showKBkmapBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> KB
                        </button>
                        <button id="showJCkmapBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> JC
                        </button>
                        <button id="showKCkmapBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 120px; font-size: 0.9rem;">
                            <i class="fas fa-th"></i> KC
                        </button>
                        <button id="showAllKmapsBtn" class="btn kmap-nav-btn" style="padding: 0.7rem 1.2rem; font-weight: 600; min-width: 140px; font-size: 0.9rem;">
                            <i class="fas fa-th-large"></i> Show All
                        </button>
                    </div>
                </div>
                
                <!-- JA K-Map Section -->
                <div id="kmap-section-ja" class="k-map-section">
                    <div class="k-map-container">
                        <h4>JA K-Map:</h4>
                        <div class="k-map" id="k-map-lab11-ja">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">B'C'</div>
                            <div class="k-map-cell k-map-header">B'C</div>
                            <div class="k-map-cell k-map-header">BC</div>
                            <div class="k-map-cell k-map-header">BC'</div>
                            
                            <div class="k-map-cell k-map-header">A'</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (010)">
                            
                            <div class="k-map-cell k-map-header">A</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (101)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (110)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab11-ja" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab11-ja" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab11-ja-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab11-ja" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab11-ja" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- KA K-Map Section -->
                <div id="kmap-section-ka" class="k-map-section">
                    <div class="k-map-container">
                        <h4>KA K-Map:</h4>
                        <div class="k-map" id="k-map-lab11-ka">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">B'C'</div>
                            <div class="k-map-cell k-map-header">B'C</div>
                            <div class="k-map-cell k-map-header">BC</div>
                            <div class="k-map-cell k-map-header">BC'</div>
                            
                            <div class="k-map-cell k-map-header">A'</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (010)">
                            
                            <div class="k-map-cell k-map-header">A</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (101)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (110)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab11-ka" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab11-ka" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab11-ka-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab11-ka" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab11-ka" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- JB K-Map Section -->
                <div id="kmap-section-jb" class="k-map-section">
                    <div class="k-map-container">
                        <h4>JB K-Map:</h4>
                        <div class="k-map" id="k-map-lab11-jb">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">B'C'</div>
                            <div class="k-map-cell k-map-header">B'C</div>
                            <div class="k-map-cell k-map-header">BC</div>
                            <div class="k-map-cell k-map-header">BC'</div>
                            
                            <div class="k-map-cell k-map-header">A'</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (010)">
                            
                            <div class="k-map-cell k-map-header">A</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (101)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (110)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab11-jb" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab11-jb" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab11-jb-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab11-jb" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab11-jb" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- KB K-Map Section -->
                <div id="kmap-section-kb" class="k-map-section">
                    <div class="k-map-container">
                        <h4>KB K-Map:</h4>
                        <div class="k-map" id="k-map-lab11-kb">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">B'C'</div>
                            <div class="k-map-cell k-map-header">B'C</div>
                            <div class="k-map-cell k-map-header">BC</div>
                            <div class="k-map-cell k-map-header">BC'</div>
                            
                            <div class="k-map-cell k-map-header">A'</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (001)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (010)">
                            
                            <div class="k-map-cell k-map-header">A</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (101)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (110)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab11-kb" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab11-kb" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab11-kb-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab11-kb" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab11-kb" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- JC K-Map Section -->
                <div id="kmap-section-jc" class="k-map-section">
                    <div class="k-map-container">
                        <h4>JC K-Map:</h4>
                        <div class="k-map" id="k-map-lab11-jc">
                            <div class="k-map-cell k-map-header"></div>
                            <div class="k-map-cell k-map-header">B'C'</div>
                            <div class="k-map-cell k-map-header">B'C</div>
                            <div class="k-map-cell k-map-header">BC</div>
                            <div class="k-map-cell k-map-header">BC'</div>
                            
                            <div class="k-map-cell k-map-header">A'</div>
                            <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                            <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (010)">
                            <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                            <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (001)">
                            
                            <div class="k-map-cell k-map-header">A</div>
                            <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                            <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (110)">
                            <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                            <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (101)">
                        </div>
                        
                        <div class="k-map-controls">
                            <button id="fill-kmap-btn-lab11-jc" type="button" class="btn btn-accent">
                                <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                            </button>
                            <button id="clear-kmap-btn-lab11-jc" type="button" class="btn btn-png">
                                <i class="fas fa-eraser"></i> Clear K-Map
                            </button>
                        </div>
                    </div>
                    
                    <div class="k-map-simplification">
                        <h4>Write the simplified expression:</h4>
                        <div class="simple-editor-container">
                            <div id="lab11-jc-editor-toolbar" class="simple-editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                    <i class="fas fa-superscript"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                    <i class="fas fa-quote-right"></i>
                                </button>
                            </div>
                            <div id="kmap-simplification-editor-lab11-jc" class="simple-editor" contenteditable="true" 
                                 placeholder="Type your simplified expression here..."></div>
                        </div>
                        
                        <div class="k-map-actions">
                            <button id="show-kmap-answer-btn-lab11-jc" type="button" class="btn btn-accent">
                                <i class="fas fa-eye"></i> Show Answer
                            </button>
                        </div>
                    </div>
                </div>
                
                                  <!-- KC K-Map Section -->
                <div id="kmap-section-kc" class="k-map-section">
                      <div class="k-map-container">
                          <h4>KC K-Map:</h4>
                          <div class="k-map" id="k-map-lab11-kc">
                              <div class="k-map-cell k-map-header"></div>
                              <div class="k-map-cell k-map-header">B'C'</div>
                              <div class="k-map-cell k-map-header">B'C</div>
                              <div class="k-map-cell k-map-header">BC</div>
                              <div class="k-map-cell k-map-header">BC'</div>
                              
                              <div class="k-map-cell k-map-header">A'</div>
                              <input type="text" class="k-map-input" data-row="0" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C' (000)">
                              <input type="text" class="k-map-input" data-row="0" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-B'C (010)">
                              <input type="text" class="k-map-input" data-row="0" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC (011)">
                              <input type="text" class="k-map-input" data-row="0" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A'-BC' (001)">
                              
                              <div class="k-map-cell k-map-header">A</div>
                              <input type="text" class="k-map-input" data-row="1" data-col="0" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C' (100)">
                              <input type="text" class="k-map-input" data-row="1" data-col="1" maxlength="1" inputmode="numeric" aria-label="K-map cell A-B'C (110)">
                              <input type="text" class="k-map-input" data-row="1" data-col="2" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC (111)">
                              <input type="text" class="k-map-input" data-row="1" data-col="3" maxlength="1" inputmode="numeric" aria-label="K-map cell A-BC' (101)">
                          </div>
                          
                          <div class="k-map-controls">
                              <button id="fill-kmap-btn-lab11-kc" type="button" class="btn btn-accent">
                                  <i class="fas fa-check-circle"></i> Fill K-Map with Correct Values
                              </button>
                              <button id="clear-kmap-btn-lab11-kc" type="button" class="btn btn-png">
                                  <i class="fas fa-eraser"></i> Clear K-Map
                              </button>
                          </div>
                      </div>
                      
                      <div class="k-map-simplification">
                          <h4>Write the simplified expression:</h4>
                          <div class="simple-editor-container">
                              <div id="lab11-kc-editor-toolbar" class="simple-editor-toolbar">
                                  <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                                      <i class="fas fa-bold"></i>
                                  </button>
                                  <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                                      <i class="fas fa-italic"></i>
                                  </button>
                                  <button type="button" class="toolbar-btn" data-command="superscript" title="Superscript">
                                      <i class="fas fa-superscript"></i>
                                  </button>
                                  <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="+" title="Plus Symbol (+)">
                                      <i class="fas fa-plus"></i>
                                  </button>
                                  <button type="button" class="toolbar-btn math-symbol" data-command="insertText" data-text="'" title="Prime Symbol (')">
                                      <i class="fas fa-quote-right"></i>
                                  </button>
                              </div>
                              <div id="kmap-simplification-editor-lab11-kc" class="simple-editor" contenteditable="true" 
                                   placeholder="Type your simplified expression here..."></div>
                          </div>
                          
                          <div class="k-map-actions">
                              <button id="show-kmap-answer-btn-lab11-kc" type="button" class="btn btn-accent">
                                  <i class="fas fa-eye"></i> Show Answer
                              </button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- Lab 11 K-Map Answer Modals -->
                  
                  <!-- JA K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-ja" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-ja" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-ja">JA K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-ja" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-ja" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-ja" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-ja" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">0</div>
                                                       <div class="kmap-cell">0</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell">0</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">X</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X in A-BC column (row 1, col 2) is chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-ja" class="answer-display correct-answer compact">
                                              <p><strong>JA = BC</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for JA</h5>
                                          <p>Looking at the K-Map, we can see that JA = 1 when:</p>
                                          <ul>
                                              <li>A'-BC = 1 (definite 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                          </ul>
                                          <p>The X in A-BC column is chosen as 1 to optimize the expression.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form one group covering the BC column:</p>
                                          <ul>
                                              <li><strong>Group:</strong> BC (covers A'-BC and A-BC)</li>
                                          </ul>
                                          <p>This group covers both the definite 1 and the chosen X.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>JA = BC</strong></p>
                                          <p>This is the minimal form since the BC column covers all 1's when X is chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-ja">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-ja">Close</button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- KA K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-ka" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-ka" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-ka">KA K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-ka" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-ka" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-ka" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-ka" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell">0</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">1</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X's in A' row (BC' and BC columns) & A row (BC column) are chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-ka" class="answer-display correct-answer compact">
                                              <p><strong>KA = B</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for KA</h5>
                                          <p>Looking at the K-Map, we can see that KA = 1 when:</p>
                                          <ul>
                                              <li>A-BC' = 1 (definite 1)</li>
                                              <li>A'-BC' = X (don't care, chosen as 1)</li>
                                              <li>A'-BC = X (don't care, chosen as 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                          </ul>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form one group covering the entire B column:</p>
                                          <ul>
                                              <li><strong>Group:</strong> B (covers A'-BC', A'-BC, A-BC', and A-BC)</li>
                                          </ul>
                                          <p>This group covers the definite 1 and both chosen X's.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>KA = B</strong></p>
                                          <p>This is the minimal form since the B column covers all 1's when the X's are chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-ka">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-ka">Close</button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- JB K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-jb" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-jb" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-jb">JB K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-jb" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-jb" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-jb" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-jb" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">0</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">X</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell">0</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">X</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X's in BC column (both rows) are chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-jb" class="answer-display correct-answer compact">
                                              <p><strong>JB = C</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for JB</h5>
                                          <p>Looking at the K-Map, we can see that JB = 1 when:</p>
                                          <ul>
                                              <li>A-B'C = 1 (definite 1)</li>
                                              <li>A'-B'C = 1 (definite 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                              <li>A'-BC = X (don't care, chosen as 1)</li>
                                          </ul>
                                          <p>The 2 X's in the BC column are chosen as 1 to optimize the expression.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form one group covering the entire C column:</p>
                                          <ul>
                                              <li><strong>Group:</strong> C (covers A'-BC, A-BC, A-B'C, and A'-B'C)</li>
                                          </ul>
                                          <p>This group covers the definite 1 and both chosen X's.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>JB = C</strong></p>
                                          <p>This is the minimal form since the C column covers all 1's when the X's are chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-jb">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-jb">Close</button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- KB K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-kb" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-kb" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-kb">KB K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-kb" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-kb" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-kb" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-kb" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell">0</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">1</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X's in A row (B'C', B'C, BC columns) and A' row (B'C column) are chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-kb" class="answer-display correct-answer compact">
                                              <p><strong>KB = C + A</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for KB</h5>
                                          <p>Looking at the K-Map, we can see that KB = 1 when:</p>
                                          <ul>
                                              <li>A'-BC = 1 (definite 1)</li>
                                              <li>A'-B'C = X (don't care, chosen as 1)</li>
                                              <li>A-B'C' = X (don't care, chosen as 1)</li>
                                              <li>A-B'C = X (don't care, chosen as 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                              <li>A-BC' = 1 (definite 1)</li>
                                          </ul>
                                          <p>The 3 X's in the A row and 1 X in the A' row are chosen as 1 to optimize the expression.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form two groups:</p>
                                          <ul>
                                              <li><strong>Group 1:</strong> C (covers A-B'C, A'-B'C, A-BC, and A-BC)</li>
                                              <li><strong>Group 2:</strong> A (covers A-B'C', A-B'C, A-BC, and A-BC')</li>
                                          </ul>
                                          <p>These groups cover all the 1's when the X's are chosen as 1.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>KB = C + A</strong></p>
                                          <p>This is the minimal form since the C group and A group cover all 1's when the X's are chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-kb">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-kb">Close</button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- JC K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-jc" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-jc" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-jc">JC K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-jc" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-jc" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-jc" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-jc" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">1</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">0</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X's in B'C column (both A' and A rows) and BC column (both A' and A rows) are chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-jc" class="answer-display correct-answer compact">
                                              <p><strong>JC = A' + B'</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for JC</h5>
                                          <p>Looking at the K-Map, we can see that JC = 1 when:</p>
                                          <ul>
                                              <li>A'-B'C' = 1 (definite 1)</li>
                                              <li>A-B'C' = 1 (definite 1)</li>
                                              <li>A'-B'C = X (don't care, chosen as 1)</li>
                                              <li>A-B'C = X (don't care, chosen as 1)</li>
                                              <li>A'-BC = X (don't care, chosen as 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                              <li>A'-BC' = 1 (definite 1)</li>
                                          </ul>
                                          <p>The 2 X's in the B'C and BC columns are chosen as 1 to optimize the expression.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form two groups:</p>
                                          <ul>
                                              <li><strong>Group 1:</strong> A' (covers A'-B'C', A'-B'C, A'-BC, and A'-BC')</li>
                                              <li><strong>Group 2:</strong> B' (covers A'-B'C', A-B'C', A'-B'C, and A-B'C)</li>
                                          </ul>
                                          <p>These groups cover all the 1's when the X's are chosen as 1.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>JC = A' + B'</strong></p>
                                          <p>This is the minimal form since the A' group and B' group cover all 1's when the X's are chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-jc">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-jc">Close</button>
                          </div>
                      </div>
                  </div>
                  
                  <!-- KC K-Map Answer Modal -->
                  <div id="kmap-answer-modal-lab11-kc" class="modal-overlay chip-modal-overlay" role="dialog" aria-labelledby="kmap-modal-title-lab11-kc" aria-hidden="true">
                      <div class="modal-container chip-modal-container">
                          <div class="modal-header">
                              <h3 id="kmap-modal-title-lab11-kc">KC K-Map Simplification Answer</h3>
                              <button class="modal-close" id="close-kmap-modal-lab11-kc" aria-label="Close modal">
                                  <i class="fas fa-times"></i>
                              </button>
                          </div>
                          <div class="modal-content">
                              <div class="kmap-modal-layout">
                                  <!-- Left Side: User's Answers -->
                                  <div class="kmap-left-panel">
                                      <div class="answer-section">
                                          <h4>Your K-Map Values:</h4>
                                          <div id="user-kmap-display-lab11-kc" class="answer-display compact"></div>
                                      </div>
                                      <div class="answer-section">
                                          <h4>Your Simplified Expression:</h4>
                                          <div id="user-expression-display-lab11-kc" class="answer-display"></div>
                                      </div>
                                  </div>
                                  
                                  <!-- Right Side: Correct Answer -->
                                  <div class="kmap-right-panel">
                                      <div class="answer-section">
                                          <h4>Correct K-Map Values:</h4>
                                          <div id="correct-kmap-display-lab11-kc" class="answer-display compact">
                                              <div class="kmap-grid-display">
                                                  <!-- Header Row with Column Labels -->
                                                  <div class="kmap-row">
                                                      <div class="kmap-header-cell"></div>
                                                      <div class="kmap-header-cell">B'C'</div>
                                                      <div class="kmap-header-cell">B'C</div>
                                                      <div class="kmap-header-cell">BC</div>
                                                      <div class="kmap-header-cell">BC'</div>
                                                  </div>
                                                                                                     <!-- Data Rows -->
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A'</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell">X</div>
                                                   </div>
                                                   <div class="kmap-row">
                                                       <div class="kmap-header-cell">A</div>
                                                       <div class="kmap-cell">X</div>
                                                       <div class="kmap-cell">1</div>
                                                       <div class="kmap-cell dont-care-chosen">X</div>
                                                       <div class="kmap-cell">X</div>
                                                   </div>
                                                                                             </div>
                                               <p style="margin-top: 10px; font-size: 0.9em; color: var(--text);">
                                                   <strong>Note:</strong> Yellow highlighted X in A-BC Cell is chosen as 1 for simplification
                                               </p>
                                           </div>
                                       </div>
                                       <div class="answer-section">
                                           <h4>Correct Simplified Expression:</h4>
                                           <div id="correct-expression-display-lab11-kc" class="answer-display correct-answer compact">
                                              <p><strong>KC = C</strong></p>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              
                              <!-- Detailed Explanation Below -->
                              <div class="kmap-explanation">
                                  <h4>Detailed Solution Explanation:</h4>
                                  <div class="math-solution">
                                      <div class="math-equation">
                                          <h5>1) Analyze the K-Map for KC</h5>
                                          <p>Looking at the K-Map, we can see that KC = 1 when:</p>
                                          <ul>
                                              <li>A'-B'C = 1 (definite 1)</li>
                                              <li>A-B'C = 1 (definite 1)</li>
                                              <li>A'-BC = 1 (definite 1)</li>
                                              <li>A-BC = X (don't care, chosen as 1)</li>
                                          </ul>
                                          <p>The X in A-BC column is chosen as 1 to optimize the expression.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>2) Group the 1's</h5>
                                          <p>We can form one group covering the entire C column:</p>
                                          <ul>
                                              <li><strong>Group:</strong> C (covers A'-B'C, A-B'C, A'-BC, and A-BC)</li>
                                          </ul>
                                          <p>This group covers the definite 1 and the chosen X.</p>
                                      </div>
                                      
                                      <div class="math-equation">
                                          <h5>3) Write the simplified expression</h5>
                                          <p><strong>KC = C</strong></p>
                                          <p>This is the minimal form since the C column covers all 1's when the X is chosen as 1.</p>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button class="btn btn-primary" id="copy-kmap-answer-btn-lab11-kc">
                                  <i class="fas fa-copy"></i> Copy Correct Answer
                              </button>
                              <button class="btn btn-secondary" id="close-kmap-modal-footer-lab11-kc">Close</button>
                          </div>
                      </div>
                  </div>
                
                <p id="question3-lab11-text"><b>3. Design the circuit with JK-FlipFlops and external gates for a counter with the following binary repeated sequence: 0, 1, 2, 3, 4, 5, 6:</b></p>
                <section class="logic-drawing-section" id="logic-drawing-lab11-circuit" style="margin-bottom:1.5rem;">
                    <div class="toolbar-scroll-x">
                      <div class="toolbar" style="display:flex;align-items:center;gap:1rem;margin-bottom:0.7rem;flex-wrap:nowrap;">
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Pen</span>
                          <input type="color" id="penColorLab11Circuit" value="#222222" style="width:28px;height:28px;border:none;background:none;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Size</span>
                          <input type="range" id="penSizeLab11Circuit" min="1" max="10" value="3" style="width:70px;">
                        </label>
                        <label style="display:flex;align-items:center;gap:0.3rem;font-size:0.98em;">
                          <span style="color:var(--secondary);">Eraser</span>
                          <input type="range" id="eraserSizeLab11Circuit" min="5" max="30" value="15" style="width:70px;">
                        </label>
                        <button id="toggleToolLab11Circuit" type="button" class="tool-toggle pen" aria-pressed="false" aria-label="Toggle to Eraser" tabindex="0">
                          <span class="icon">✏️</span>
                        </button>
                        <button id="zoomInBtnLab11Circuit" class="zoom-btn" title="Zoom In" aria-label="Zoom In">➕</button>
                        <input type="range" id="zoomSliderLab11Circuit" class="zoom-slider" min="100" max="500" value="100" step="1" aria-label="Zoom Level Slider">
                        <button id="zoomOutBtnLab11Circuit" class="zoom-btn" title="Zoom Out" aria-label="Zoom Out">➖</button>
                        <span class="zoom-level" id="zoomLevelLab11Circuit">100%</span>
                        <button id="downloadCanvasLab11Circuit" type="button" class="btn" style="min-width:40px;" title="Download drawing"><i class="fas fa-download"></i></button>
                    </div>
                    </div>
                    <div id="drawingContainerLab11Circuit" class="drawing-wrapper">
                      <canvas id="drawingCanvasLab11Circuit" width="800" height="500" style="width:100%;height:auto;max-width:100%;border-radius:10px;display:block;background:#fff;touch-action:none;"></canvas>
                    </div>
                </section>
                
                <div class="simulator-container" aria-label="MOD-7 Counter simulation experiment">
                    <!-- Header with Logic Design Button -->
                    <div class="simulator-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
                    <h3 class="section-title">MOD-7 Counter Simulator</h3>
                        <button id="logicDesignBtnLab11" type="button" class="btn btn-info logicDesignBtnLab11" style="font-size: 0.9rem; padding: 8px 16px;">
                            <i class="fas fa-project-diagram"></i> Logic Design
                        </button>
                    </div>
                    
                    <!-- Main Simulator Grid Layout -->
                    <div class="grid-layout" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                        
                        <!-- Left Column: Clock Control & Counter Inputs -->
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                    
                            <!-- Clock Control Panel -->
                            <div class="clock-control-panel" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; border: 1px solid var(--border);">
                                <h4 style="color: var(--accent); margin-bottom: 0.8rem; text-align: center; font-size: 1rem;">
                            Clock Signal Generator
                        </h4>
                        
                                <!-- Clock Controls Row -->
                                <div class="clock-controls-row" style="display: grid; grid-template-columns: auto 1fr; gap: 0.8rem; align-items: center; margin-bottom: 0.8rem;">
                                    <label for="clockFrequencyLab11" style="color: var(--text); font-weight: 500; font-size: 0.9rem;">Frequency:</label>
                                    <select id="clockFrequencyLab11" style="padding: 0.4rem; border: 1px solid var(--border); border-radius: 5px; background: var(--bg-primary); color: var(--text); font-size: 0.9rem;">
                                    <option value="0.5">0.5 Hz (Slow)</option>
                                    <option value="1" selected>1 Hz (Normal)</option>
                                    <option value="2">2 Hz (Fast)</option>
                                    <option value="5">5 Hz (Very Fast)</option>
                                </select>
                            </div>
                                
                                <!-- Clock Buttons Grid -->
                                <div class="clock-buttons-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; margin-bottom: 0.8rem;">
                                    <button id="startClockBtnLab11" class="btn btn-success" style="padding: 0.5rem 0.8rem; font-size: 0.85rem;">
                                        <i class="fas fa-play"></i> Start
                            </button>
                                    <button id="stopClockBtnLab11" class="btn btn-danger" style="padding: 0.5rem 0.8rem; font-size: 0.85rem; display: none;">
                                        <i class="fas fa-stop"></i> Stop
                            </button>
                                    <button id="singlePulseBtnLab11" class="btn btn-info" style="padding: 0.5rem 0.8rem; font-size: 0.85rem;">
                                        <i class="fas fa-bolt"></i> Pulse
                            </button>
                                    <button id="resetCounterBtnLab11" class="btn btn-warning" style="padding: 0.5rem 0.8rem; font-size: 0.85rem;">
                                        <i class="fas fa-undo"></i> Reset
                            </button>
                        </div>
                        
                        <!-- Clock Waveform Display -->
                                <div class="clock-waveform" style="text-align: center;">
                                    <div style="color: var(--text); font-weight: 500; margin-bottom: 0.4rem; font-size: 0.9rem;">Clock Signal:</div>
                                    <div id="clockWaveformLab11" style="height: 50px; background: var(--bg-primary); border: 2px solid var(--border); border-radius: 6px; position: relative; overflow: hidden;">
                                        <div id="clockSignalLab11" style="position: absolute; top: 50%; left: 0; width: 100%; height: 3px; background: var(--accent); transform: translateY(-50%); transition: all 0.1s ease;"></div>
                                        <div id="clockStateLab11" style="position: absolute; top: 8px; right: 8px; color: var(--accent); font-weight: bold; font-size: 0.8rem;">LOW</div>
                                        <div id="clockEdgeLab11" style="position: absolute; bottom: 8px; left: 8px; color: var(--secondary); font-size: 0.75rem;">Rising</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Counter Input Section -->
                            <div class="counter-input-section" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; border: 1px solid var(--border);">
                                <h4 style="margin-bottom: 0.8rem; color: var(--secondary); text-align: center; font-size: 1rem;">Counter State (ABC)</h4>
                                
                                <!-- Counter Switches Row -->
                                <div class="counter-switch-row" style="display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 1rem; flex-wrap: wrap; align-items: center;">
                                    <div class="counter-switch-block" style="text-align: center; min-width: 70px;">
                                <div class="input-switch">
                                    <input type="checkbox" id="counterA" aria-label="Counter State A (MSB)" tabindex="0">
                                    <label class="slider" for="counterA"></label>
                                </div>
                                        <div class="input-label" style="font-size: 0.9rem;">A (MSB)</div>
                            </div>
                                    <div class="counter-switch-block" style="text-align: center; min-width: 70px;">
                                <div class="input-switch">
                                    <input type="checkbox" id="counterB" aria-label="Counter State B" tabindex="0">
                                    <label class="slider" for="counterB"></label>
                                </div>
                                        <div class="input-label" style="font-size: 0.9rem;">B</div>
                            </div>
                                    <div class="counter-switch-block" style="text-align: center; min-width: 70px;">
                                <div class="input-switch">
                                    <input type="checkbox" id="counterC" aria-label="Counter State C (LSB)" tabindex="0">
                                    <label class="slider" for="counterC"></label>
                                </div>
                                        <div class="input-label" style="font-size: 0.9rem;">C (LSB)</div>
                            </div>
                        </div>
                        
                                <!-- Counter Values Display -->
                                <div class="counter-values-display" style="text-align: center; background: var(--bg-primary); padding: 0.8rem; border-radius: 6px; border: 1px solid var(--border);">
                                    <div style="font-size: 0.85rem; color: var(--light); margin-bottom: 0.4rem;">Counter Values:</div>
                                    <div style="font-size: 1rem; color: var(--text); font-weight: 500;">
                                        Binary: <span id="counterBinaryValue" style="color: var(--accent);">000</span><br>
                                        Decimal: <span id="counterDecimalValue" style="color: var(--accent);">0</span>
                                    </div>
                            </div>
                        </div>
                    </div>
                        
                        <!-- Right Column: Displays & Outputs -->
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                    
                    <!-- 7-Segment Display Section -->
                            <div class="counter-seg-section" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; border: 1px solid var(--border); text-align: center;">
                                <h4 style="margin-bottom: 0.8rem; color: var(--secondary); font-size: 1rem;">7-Segment Display</h4>
                                
                                <div class="counter-seg-container">
                                    <div class="counter-seg-display">
                                        <div style="font-size: 0.85rem; color: var(--light); margin-bottom: 0.5rem;">Decimal Output</div>
                                <div class="segment-display" id="counterSevenSegment" aria-live="polite" tabindex="0">
                                            <svg id="counterSevenSegmentSVG" width="80" height="130" viewBox="0 0 90 150" style="display:block;margin:0 auto;">
                                        <rect x="5" y="5" width="80" height="140" rx="18" fill="#181818" stroke="#333" stroke-width="4"/>
                                        <g id="counterSegments">
                                            <polygon id="counterSegA" points="20,18 70,18 62,28 28,28" fill="#2a0000"/>
                                            <polygon id="counterSegB" points="72,20 82,32 82,68 72,76 62,68 62,32" fill="#2a0000"/>
                                            <polygon id="counterSegC" points="72,80 82,88 82,124 72,136 62,124 62,88" fill="#2a0000"/>
                                            <polygon id="counterSegD" points="20,132 70,132 62,122 28,122" fill="#2a0000"/>
                                            <polygon id="counterSegE" points="18,80 28,88 28,124 18,136 8,124 8,88" fill="#2a0000"/>
                                            <polygon id="counterSegF" points="18,20 28,32 28,68 18,76 8,68 8,32" fill="#2a0000"/>
                                            <polygon id="counterSegG" points="22,75 68,75 62,85 28,85" fill="#2a0000"/>
                                        </g>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Binary LED Outputs Section -->
                            <div class="counter-led-section" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; border: 1px solid var(--border);">
                                <h4 style="margin-bottom: 0.8rem; color: var(--secondary); text-align: center; font-size: 1rem;">Binary State LEDs</h4>
                                
                                <div class="counter-led-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                    <div class="counter-led-display" style="text-align: center;">
                                        <div class="input-label" style="font-size: 0.9rem; margin-bottom: 0.4rem;">A (MSB)</div>
                                        <div class="led-output" id="counterALed" role="img" aria-label="Counter State A LED" tabindex="0" style="margin: 0 auto 0.4rem auto;"></div>
                                        <div class="input-label" style="font-size: 0.85rem;">State: <span id="counterAState">0 (LOW)</span></div>
                            </div>
                                    <div class="counter-led-display" style="text-align: center;">
                                        <div class="input-label" style="font-size: 0.9rem; margin-bottom: 0.4rem;">B</div>
                                        <div class="led-output" id="counterBLed" role="img" aria-label="Counter State B LED" tabindex="0" style="margin: 0 auto 0.4rem auto;"></div>
                                        <div class="input-label" style="font-size: 0.85rem;">State: <span id="counterBState">0 (LOW)</span></div>
                            </div>
                                    <div class="counter-led-display" style="text-align: center;">
                                        <div class="input-label" style="font-size: 0.9rem; margin-bottom: 0.4rem;">C (LSB)</div>
                                        <div class="led-output" id="counterCLed" role="img" aria-label="Counter State C LED" tabindex="0" style="margin: 0 auto 0.4rem auto;"></div>
                                        <div class="input-label" style="font-size: 0.85rem;">State: <span id="counterCState">0 (LOW)</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                                        <!-- Full Width: JK Debug Logger Section -->
                    <div class="jk-debug-section" style="background: var(--bg-secondary); padding: 1rem; border-radius: 10px; border: 1px solid var(--border);">
                        <h4 style="margin-bottom: 0.8rem; color: var(--accent); text-align: center; font-size: 1rem;">JK Flip Flop Debug Logger</h4>
                        <div class="jk-debug-container">
                            <div class="jk-debug-row" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 0.8rem;">
                                <div class="jk-debug-block" style="text-align: center; background: var(--bg-primary); padding: 0.8rem; border-radius: 6px; border: 1px solid var(--border);">
                                    <div style="font-weight: bold; color: var(--accent); margin-bottom: 0.4rem; font-size: 0.9rem;">Flip Flop A</div>
                                    <div style="font-size: 0.85rem; line-height: 1.4;">
                                        J<sub>A</sub>: <span id="jkDebugJA" style="color: var(--accent);">0</span> | K<sub>A</sub>: <span id="jkDebugKA" style="color: var(--accent);">0</span><br>
                                        Q<sub>A</sub>: <span id="jkDebugQA" style="color: var(--accent);">0</span> | Q̅<sub>A</sub>: <span id="jkDebugQABar" style="color: var(--accent);">1</span>
                                    </div>
                                </div>
                                <div class="jk-debug-block" style="text-align: center; background: var(--bg-primary); padding: 0.8rem; border-radius: 6px; border: 1px solid var(--border);">
                                    <div style="font-weight: bold; color: var(--accent); margin-bottom: 0.4rem; font-size: 0.9rem;">Flip Flop B</div>
                                    <div style="font-size: 0.85rem; line-height: 1.4;">
                                        J<sub>B</sub>: <span id="jkDebugJB" style="color: var(--accent);">0</span> | K<sub>B</sub>: <span id="jkDebugKB" style="color: var(--accent);">0</span><br>
                                        Q<sub>B</sub>: <span id="jkDebugQB" style="color: var(--accent);">0</span> | Q̅<sub>B</sub>: <span id="jkDebugQBBar" style="color: var(--accent);">1</span>
                                    </div>
                                </div>
                                <div class="jk-debug-block" style="text-align: center; background: var(--bg-primary); padding: 0.8rem; border-radius: 6px; border: 1px solid var(--border);">
                                    <div style="font-weight: bold; color: var(--accent); margin-bottom: 0.4rem; font-size: 0.9rem;">Flip Flop B</div>
                                    <div style="font-size: 0.85rem; line-height: 1.4;">
                                        J<sub>C</sub>: <span id="jkDebugJC" style="color: var(--accent);">0</span> | K<sub>C</sub>: <span id="jkDebugKC" style="color: var(--accent);">0</span><br>
                                        Q<sub>C</sub>: <span id="jkDebugQC" style="color: var(--accent);">0</span> | Q̅<sub>C</sub>: <span id="jkDebugQCBar" style="color: var(--accent);">1</span>
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: center; font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">
                                <em>Internal JK Flip Flop states for debugging purposes</em>
                            </div>
                        </div>
                    </div>
                    
                    <!-- MOD-7 Counter Simulator Tooltip -->
                    <div id="mod7-counter-tooltip" class="enhanced-tooltip" style="display: none;">
                        <div class="tooltip-header">
                            <h5 style="color: var(--accent); margin: 0 0 0.5rem 0; font-size: 1.1rem;">MOD-7 Counter Simulator</h5>
                            <button type="button" class="tooltip-close" aria-label="Close tooltip">×</button>
                        </div>
                        <div class="tooltip-content">
                            <p style="margin: 0 0 0.8rem 0; line-height: 1.5;"><strong>Purpose:</strong> Simulates a 3-bit MOD-7 counter using JK Flip Flops with external gates.</p>
                            
                            <div style="margin: 0 0 0.8rem 0;">
                                <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Counter Sequence:</h6>
                                <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                    <li><strong>Binary:</strong> 000 → 001 → 010 → 011 → 100 → 101 → 110 → 000</li>
                                    <li><strong>Decimal:</strong> 0 → 1 → 2 → 3 → 4 → 5 → 6 → 0</li>
                                    <li><strong>Cycle:</strong> Repeats indefinitely with clock pulses</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 0 0 0.8rem 0;">
                                <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Components:</h6>
                                <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                    <li><strong>3 JK Flip Flops:</strong> A (MSB), B, C (LSB)</li>
                                    <li><strong>External Gates:</strong> Combinational logic for next state</li>
                                    <li><strong>Clock Signal:</strong> Synchronizes all transitions</li>
                                    <li><strong>7-Segment Display:</strong> Shows decimal output</li>
                                </ul>
                            </div>
                            
                            <div style="margin: 0 0 0.8rem 0;">
                                <h6 style="color: var(--secondary); margin: 0 0 0.4rem 0; font-size: 0.95rem;">Operation:</h6>
                                <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.4;">
                                    <li>Clock rising edge triggers state change</li>
                                    <li>JK inputs determine next state based on current state</li>
                                    <li>Binary outputs drive 7-segment display</li>
                                    <li>Debug logger shows internal JK states</li>
                                </ul>
                            </div>
                    </div>
                </div>
                
                <!-- Logic Design Modal -->
                <div id="logicDesignModalLab11" class="modal-overlay chip-modal-overlay">
                    <div class="modal-container chip-modal-container">
                        <div class="modal-header">
                            <h3>Logic Design: MOD-7 Counter Implementation</h3>
                            <button class="modal-close" id="closeLogicDesignModalLab11" aria-label="Close modal">&times;</button>
                        </div>
                        <div class="modal-content">
                            <div class="chip-image-container">
                                <img src="media/Lab11_counterDesign.svg" alt="Logic Design for MOD-7 Counter Implementation" class="chip-image">
                            </div>
                            <div class="chip-description">
                                <h4>Logic Design Implementation</h4>
                                <p>This diagram shows the complete logic design for implementing the MOD-7 counter using JK flip-flops. The design demonstrates how the counter progresses through states 0 to 6 and then resets back to 0, creating a synchronous counting sequence.</p>
                                
                                <div class="chip-features">
                                    <h5>Design Components:</h5>
                                    <ul>
                                        <li><strong>JK Flip-Flops:</strong> Three JK flip-flops (A, B, C) connected in cascade for sequential counting</li>
                                        <li><strong>Clock Signal:</strong> Synchronous clock input that triggers state transitions on rising edge</li>
                                        <li><strong>State Logic:</strong> Combinational logic determines next state based on current state and JK inputs</li>
                                        <li><strong>Reset Circuit:</strong> Asynchronous reset to initialize counter to state 000</li>
                                        <li><strong>Output Decoder:</strong> Binary-to-7-segment decoder for visual display</li>
                                    </ul>
                                </div>
                                
                                <!-- Important Note Section -->
                                <div class="kmap-explanation" style="margin-top: 2rem;">
                                    <h4>Counter Operation & Simulator Usage:</h4>
                                    <div class="math-solution">
                                        <div class="math-equation">
                                            <h5>Counter State Sequence:</h5>
                                            <p><strong>MOD-7 Counter Progression:</strong></p>
                                            <ul>
                                                <li><strong>State 000 (0):</strong> Initial state, counter starts here</li>
                                                <li><strong>State 001 (1):</strong> First count, A=0, B=0, C=1</li>
                                                <li><strong>State 010 (2):</strong> Second count, A=0, B=1, C=0</li>
                                                <li><strong>State 011 (3):</strong> Third count, A=0, B=1, C=1</li>
                                                <li><strong>State 100 (4):</strong> Fourth count, A=1, B=0, C=0</li>
                                                <li><strong>State 101 (5):</strong> Fifth count, A=1, B=0, C=1</li>
                                                <li><strong>State 110 (6):</strong> Sixth count, A=1, B=1, C=0</li>
                                                <li><strong>State 111 (7):</strong> Reset state, counter returns to 000</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Simulator Features & How to Use:</h5>
                                            <p><strong>Clock Control:</strong></p>
                                            <ul>
                                                <li><strong>Start Clock:</strong> Begins continuous counting at selected frequency</li>
                                                <li><strong>Stop Clock:</strong> Pauses the counting sequence</li>
                                                <li><strong>Single Pulse:</strong> Advances counter by one clock cycle</li>
                                                <li><strong>Reset Counter:</strong> Returns counter to initial state 000</li>
                                                <li><strong>Frequency Control:</strong> Adjust clock speed from 0.5Hz to 5Hz</li>
                                            </ul>
                                            <p><strong>Visual Feedback:</strong></p>
                                            <ul>
                                                <li><strong>Binary Display:</strong> Shows current counter state in binary (ABC)</li>
                                                <li><strong>7-Segment Display:</strong> Visual decimal representation of count</li>
                                                <li><strong>LED Outputs:</strong> Binary state indicators for each flip-flop</li>
                                                <li><strong>Debug Logger:</strong> Real-time JK input and output states</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="math-equation">
                                            <h5>Learning Objectives:</h5>
                                            <p><strong>Understanding MOD-7 Counter:</strong></p>
                                            <ul>
                                                <li>Learn synchronous sequential circuit design</li>
                                                <li>Understand JK flip-flop behavior and state transitions</li>
                                                <li>Observe binary counting sequence and overflow behavior</li>
                                                <li>Analyze clock timing and edge-triggered operations</li>
                                                <li>Practice debugging sequential circuits using visual tools</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <footer class="footer">
        <p>Developed by <span class="brand">EOPeak</span> | <span class="developer">Eslam Osama Saad</span></p>
        <p>© 2025 Digital Logic Design Lab Manual | MSA University</p>
    </footer>
    
    <script>

        // --- Drawing Canvas Logic for both sections ---
        function setupDrawingCanvas({
        canvasId, penColorId, penSizeId, eraserSizeId, toggleToolId, downloadBtnId, containerId, questionSelector, zoomInBtnId, zoomOutBtnId, zoomLevelId, zoomSliderId
        }) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            let drawing = false;
            let lastX = 0, lastY = 0;
            let tool = 'pen';
            let penColor = document.getElementById(penColorId).value;
            let penSize = parseInt(document.getElementById(penSizeId).value);
            let eraserSize = parseInt(document.getElementById(eraserSizeId).value);
            // Zoom/Resize controls
            let zoomLevel = 1;
            const zoomInBtn = document.getElementById(zoomInBtnId);
            const zoomOutBtn = document.getElementById(zoomOutBtnId);
            const zoomLevelSpan = document.getElementById(zoomLevelId);
            const zoomSlider = document.getElementById(zoomSliderId);
            function updateZoomDisplay() {
            zoomLevelSpan.textContent = Math.round(zoomLevel * 100) + '%';
            zoomSlider.value = Math.round(zoomLevel * 100);
            }
            zoomInBtn.addEventListener('click', () => {
            if (zoomLevel < 5) {
                zoomLevel = Math.min(5, zoomLevel + 0.1);
                canvas.style.transform = `scale(${zoomLevel})`;
                updateZoomDisplay();
            }
            });
            zoomOutBtn.addEventListener('click', () => {
            if (zoomLevel > 1) {
                zoomLevel = Math.max(1, zoomLevel - 0.1);
                canvas.style.transform = `scale(${zoomLevel})`;
                updateZoomDisplay();
            }
            });
            zoomSlider.addEventListener('input', (e) => {
            zoomLevel = parseInt(zoomSlider.value) / 100;
            canvas.style.transform = `scale(${zoomLevel})`;
            updateZoomDisplay();
            });
            updateZoomDisplay();
            // Pen/Eraser controls
            document.getElementById(penColorId).addEventListener('input', e => penColor = e.target.value);
            document.getElementById(penSizeId).addEventListener('input', e => penSize = parseInt(e.target.value));
            document.getElementById(eraserSizeId).addEventListener('input', e => eraserSize = parseInt(e.target.value));
            // Tool toggle logic (modern, animated, accessible)
            const toggleBtn = document.getElementById(toggleToolId);
            const iconSpan = toggleBtn.querySelector('.icon');
            let currentTool = 'pen';
            function setToolMode(toolMode) {
            tool = toolMode;
            }
            function updateToggleUI() {
            if (currentTool === 'pen') {
                toggleBtn.classList.remove('eraser');
                toggleBtn.classList.add('pen');
                iconSpan.textContent = '✏️';
                toggleBtn.setAttribute('aria-label', 'Toggle to Eraser');
                toggleBtn.setAttribute('aria-pressed', 'false');
            } else {
                toggleBtn.classList.remove('pen');
                toggleBtn.classList.add('eraser');
                iconSpan.textContent = '🧽';
                toggleBtn.setAttribute('aria-label', 'Toggle to Pen');
                toggleBtn.setAttribute('aria-pressed', 'true');
            }
            }
            toggleBtn.addEventListener('click', () => {
            currentTool = (currentTool === 'pen') ? 'eraser' : 'pen';
            setToolMode(currentTool);
            updateToggleUI();
            });
            toggleBtn.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                currentTool = (currentTool === 'pen') ? 'eraser' : 'pen';
                setToolMode(currentTool);
                updateToggleUI();
            }
            });
            updateToggleUI();
            // Drawing logic
            function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            if (e.touches) {
                return {
                x: (e.touches[0].clientX - rect.left) * (canvas.width / rect.width),
                y: (e.touches[0].clientY - rect.top) * (canvas.height / rect.height)
                };
            } else {
                return {
                x: (e.clientX - rect.left) * (canvas.width / rect.width),
                y: (e.clientY - rect.top) * (canvas.height / rect.height)
                };
            }
            }
            function startDraw(e) {
            drawing = true;
            const pos = getPos(e);
            lastX = pos.x;
            lastY = pos.y;
            }
            function draw(e) {
            if (!drawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(pos.x, pos.y);
            if (tool === 'pen') {
                ctx.strokeStyle = penColor;
                ctx.lineWidth = penSize;
            } else {
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = eraserSize;
            }
            ctx.stroke();
            lastX = pos.x;
            lastY = pos.y;
            }
            function endDraw() { drawing = false; }
            // Mouse events
            canvas.addEventListener('mousedown', startDraw);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', endDraw);
            canvas.addEventListener('mouseleave', endDraw);
            // Touch events
            canvas.addEventListener('touchstart', startDraw, {passive:false});
            canvas.addEventListener('touchmove', draw, {passive:false});
            canvas.addEventListener('touchend', endDraw);
            // Download logic
            document.getElementById(downloadBtnId).addEventListener('click', function() {
            // Export question + canvas as PNG
            const container = document.getElementById(containerId);
            // Find the question text above
            let questionElem = null;
            if (questionSelector) {
                questionElem = document.querySelector(questionSelector);
            }
            // Create a wrapper div for export
            const exportDiv = document.createElement('div');
            exportDiv.style.background = '#fff';
            exportDiv.style.padding = '1.2rem';
            exportDiv.style.borderRadius = '12px';
            exportDiv.style.width = '800px';
            exportDiv.style.maxWidth = '100%';
            if (questionElem) {
                const qClone = questionElem.cloneNode(true);
                qClone.style.fontSize = '1.15rem';
                qClone.style.fontWeight = 'bold';
                qClone.style.marginBottom = '1.2rem';
                qClone.style.color = '#000';
                exportDiv.appendChild(qClone);
            }
            // Clone the canvas
            const exportCanvas = document.createElement('canvas');
            exportCanvas.width = canvas.width;
            exportCanvas.height = canvas.height;
            exportCanvas.getContext('2d').drawImage(canvas, 0, 0);
            exportCanvas.style.display = 'block';
            exportCanvas.style.width = '800px';
            exportCanvas.style.maxWidth = '100%';
            exportCanvas.style.borderRadius = '10px';
            exportDiv.appendChild(exportCanvas);
            document.body.appendChild(exportDiv);
            html2canvas(exportDiv, {backgroundColor:'#fff', scale:2}).then(function(canvasImg) {
                const link = document.createElement('a');
                link.download = 'logic-diagram.png';
                link.href = canvasImg.toDataURL('image/png');
                link.click();
                document.body.removeChild(exportDiv);
            });
            });
        }
        // Setup for both drawing canvases
        setupDrawingCanvas({
            canvasId: 'drawingCanvas2',
            penColorId: 'penColor2',
            penSizeId: 'penSize2',
            eraserSizeId: 'eraserSize2',
            toggleToolId: 'toggleTool2',
            downloadBtnId: 'downloadCanvas2',
            containerId: 'drawingContainer2',
            questionSelector: '#question2-text',
            zoomInBtnId: 'zoomInBtn2',
            zoomOutBtnId: 'zoomOutBtn2',
            zoomLevelId: 'zoomLevel2',
            zoomSliderId: 'zoomSlider2'
        });
        setupDrawingCanvas({
            canvasId: 'drawingCanvas3',
            penColorId: 'penColor3',
            penSizeId: 'penSize3',
            eraserSizeId: 'eraserSize3',
            toggleToolId: 'toggleTool3',
            downloadBtnId: 'downloadCanvas3',
            containerId: 'drawingContainer3',
            questionSelector: '#question3-text',
            zoomInBtnId: 'zoomInBtn3',
            zoomOutBtnId: 'zoomOutBtn3',
            zoomLevelId: 'zoomLevel3',
            zoomSliderId: 'zoomSlider3'
        });
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab3',
            penColorId: 'penColorLab3',
            penSizeId: 'penSizeLab3',
            eraserSizeId: 'eraserSizeLab3',
            toggleToolId: 'toggleToolLab3',
            downloadBtnId: 'downloadCanvasLab3',
            containerId: 'drawingContainerLab3',
            questionSelector: '#question3-lab3-text',
            zoomInBtnId: 'zoomInBtnLab3',
            zoomOutBtnId: 'zoomOutBtnLab3',
            zoomLevelId: 'zoomLevelLab3',
            zoomSliderId: 'zoomSliderLab3'
        });
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab4',
            penColorId: 'penColorLab4',
            penSizeId: 'penSizeLab4',
            eraserSizeId: 'eraserSizeLab4',
            toggleToolId: 'toggleToolLab4',
            downloadBtnId: 'downloadCanvasLab4',
            containerId: 'drawingContainerLab4',
            questionSelector: '#question4-lab4-text',
            zoomInBtnId: 'zoomInBtnLab4',
            zoomOutBtnId: 'zoomOutBtnLab4',
            zoomLevelId: 'zoomLevelLab4',
            zoomSliderId: 'zoomSliderLab4'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab5',
            penColorId: 'penColorLab5',
            penSizeId: 'penSizeLab5',
            eraserSizeId: 'eraserSizeLab5',
            toggleToolId: 'toggleToolLab5',
            downloadBtnId: 'downloadCanvasLab5',
            containerId: 'drawingContainerLab5',
            questionSelector: '#question5-lab5-text',
            zoomInBtnId: 'zoomInBtnLab5',
            zoomOutBtnId: 'zoomOutBtnLab5',
            zoomLevelId: 'zoomLevelLab5',
            zoomSliderId: 'zoomSliderLab5'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab6',
            penColorId: 'penColorLab6',
            penSizeId: 'penSizeLab6',
            eraserSizeId: 'eraserSizeLab6',
            toggleToolId: 'toggleToolLab6',
            downloadBtnId: 'downloadCanvasLab6',
            containerId: 'drawingContainerLab6',
            questionSelector: '#question2-lab6-text',
            zoomInBtnId: 'zoomInBtnLab6',
            zoomOutBtnId: 'zoomOutBtnLab6',
            zoomLevelId: 'zoomLevelLab6',
            zoomSliderId: 'zoomSliderLab6'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab6Q4',
            penColorId: 'penColorLab6Q4',
            penSizeId: 'penSizeLab6Q4',
            eraserSizeId: 'eraserSizeLab6Q4',
            toggleToolId: 'toggleToolLab6Q4',
            downloadBtnId: 'downloadCanvasLab6Q4',
            containerId: 'drawingContainerLab6Q4',
            questionSelector: '#question4-lab6-text',
            zoomInBtnId: 'zoomInBtnLab6Q4',
            zoomOutBtnId: 'zoomOutBtnLab6Q4',
            zoomLevelId: 'zoomLevelLab6Q4',
            zoomSliderId: 'zoomSliderLab6Q4'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab7',
            penColorId: 'penColorLab7',
            penSizeId: 'penSizeLab7',
            eraserSizeId: 'eraserSizeLab7',
            toggleToolId: 'toggleToolLab7',
            downloadBtnId: 'downloadCanvasLab7',
            containerId: 'drawingContainerLab7',
            questionSelector: '#question-lab7-text',
            zoomInBtnId: 'zoomInBtnLab7',
            zoomOutBtnId: 'zoomOutBtnLab7',
            zoomLevelId: 'zoomLevelLab7',
            zoomSliderId: 'zoomSliderLab7'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab8',
            penColorId: 'penColorLab8',
            penSizeId: 'penSizeLab8',
            eraserSizeId: 'eraserSizeLab8',
            toggleToolId: 'toggleToolLab8',
            downloadBtnId: 'downloadCanvasLab8',
            containerId: 'drawingContainerLab8',
            questionSelector: '#question3-lab8-text',
            zoomInBtnId: 'zoomInBtnLab8',
            zoomOutBtnId: 'zoomOutBtnLab8',
            zoomLevelId: 'zoomLevelLab8',
            zoomSliderId: 'zoomSliderLab8'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab9',
            penColorId: 'penColorLab9',
            penSizeId: 'penSizeLab9',
            eraserSizeId: 'eraserSizeLab9',
            toggleToolId: 'toggleToolLab9',
            downloadBtnId: 'downloadCanvasLab9',
            containerId: 'drawingContainerLab9',
            questionSelector: '#question2-lab9-text',
            zoomInBtnId: 'zoomInBtnLab9',
            zoomOutBtnId: 'zoomOutBtnLab9',
            zoomLevelId: 'zoomLevelLab9',
            zoomSliderId: 'zoomSliderLab9'
        });
        
        setupDrawingCanvas({
            canvasId: 'drawingCanvasLab11Circuit',
            penColorId: 'penColorLab11Circuit',
            penSizeId: 'penSizeLab11Circuit',
            eraserSizeId: 'eraserSizeLab11Circuit',
            toggleToolId: 'toggleToolLab11Circuit',
            downloadBtnId: 'downloadCanvasLab11Circuit',
            containerId: 'drawingContainerLab11Circuit',
            questionSelector: '#question3-lab11-text',
            zoomInBtnId: 'zoomInBtnLab11Circuit',
            zoomOutBtnId: 'zoomOutBtnLab11Circuit',
            zoomLevelId: 'zoomLevelLab11Circuit',
            zoomSliderId: 'zoomSliderLab11Circuit'
        });
        
        // Lab 7 Chip Modal Functionality
        function initializeLab7ChipModal() {
    
            
            const chipModal = document.getElementById('chipModalLab7');
            const chipInfoBtn = document.getElementById('chip-info-btn-lab7');
            const closeChipModal = document.getElementById('closeChipModalLab7');
            const chip7483Btn = document.getElementById('chip7483Btn');
            const chip74283Btn = document.getElementById('chip74283Btn');
            const chipImage = document.getElementById('chipImageLab7');
            const chipTitle = document.getElementById('chipTitleLab7');
            const chipDesc = document.getElementById('chipDescLab7');
            

            
            if (!chipModal || !chipInfoBtn || !closeChipModal || !chip7483Btn || !chip74283Btn || !chipImage || !chipTitle || !chipDesc) {
                console.error('Some elements not found for Lab 7 chip modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            chipInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                chipModal.classList.add('show');
                chipModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeChipModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                chipModal.classList.remove('show');
                chipModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            chipModal.addEventListener('click', function(e) {
                if (e.target === chipModal) {
                    chipModal.classList.remove('show');
                    chipModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Switch to 7483 chip
            chip7483Btn.addEventListener('click', function() {
                chipImage.src = 'media/7483_4_bit_Full_Adder.png';
                chipImage.alt = '7483 4-bit Full Adder Pin Configuration';
                chipTitle.textContent = '7483 4-bit Full Adder';
                chipDesc.textContent = 'The 7483 is a 4-bit binary full adder with fast carry lookahead. It features four full-adder stages with internal carry lookahead for high-speed operation.';
                
                // Update button states
                chip7483Btn.classList.add('active');
                chip74283Btn.classList.remove('active');
            });
            
            // Switch to 74283 chip
            chip74283Btn.addEventListener('click', function() {
                chipImage.src = 'media/74283_4_bit_Full_Adder.png';
                chipImage.alt = '74283 4-bit Full Adder Pin Configuration';
                chipTitle.textContent = '74283 4-bit Full Adder';
                chipDesc.textContent = 'The 74283 is an enhanced 4-bit binary full adder with improved carry lookahead and faster propagation delays. It offers better performance and reliability compared to the 7483.';
                
                // Update button states
                chip74283Btn.classList.add('active');
                chip7483Btn.classList.remove('active');
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (chipModal.style.display === 'block' || chipModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        chipModal.classList.remove('show');
                        chipModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    } else if (e.key === 'ArrowLeft') {
                        // Switch to 7483 chip (left option)
                        chipImage.src = 'media/7483_4_bit_Full_Adder.png';
                        chipImage.alt = '7483 4-bit Full Adder Pin Configuration';
                        chipTitle.textContent = '7483 4-bit Full Adder';
                        chipDesc.textContent = 'The 7483 is a 4-bit binary full adder with fast carry lookahead. It features four full-adder stages with internal carry lookahead for high-speed operation.';
                        
                        // Update button states
                        chip7483Btn.classList.add('active');
                        chip74283Btn.classList.remove('active');
                    } else if (e.key === 'ArrowRight') {
                        // Switch to 74283 chip (right option)
                        chipImage.src = 'media/74283_4_bit_Full_Adder.png';
                        chipImage.alt = '74283 4-bit Full Adder Pin Configuration';
                        chipTitle.textContent = '74283 4-bit Full Adder';
                        chipDesc.textContent = 'The 74283 is an enhanced 4-bit binary full adder with improved carry lookahead and faster propagation delays. It offers better performance and reliability compared to the 7483.';
                        
                        // Update button states
                        chip74283Btn.classList.add('active');
                        chip7483Btn.classList.remove('active');
                    }
                }
            });
            
    
        }
        
        // Lab 9 Multiplexer Modal Functionality
        function initializeLab9MultiplexerModal() {
            
            const multiplexerModal = document.getElementById('multiplexerModalLab9');
            const multiplexerInfoBtn = document.getElementById('multiplexer-info-btn-lab9');
            const closeMultiplexerModal = document.getElementById('closeMultiplexerModalLab9');
            

            
            if (!multiplexerModal || !multiplexerInfoBtn || !closeMultiplexerModal) {
                console.error('Some elements not found for Lab 9 multiplexer modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            multiplexerInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                multiplexerModal.classList.add('show');
                multiplexerModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeMultiplexerModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                multiplexerModal.classList.remove('show');
                multiplexerModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            multiplexerModal.addEventListener('click', function(e) {
                if (e.target === multiplexerModal) {
                    multiplexerModal.classList.remove('show');
                    multiplexerModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (multiplexerModal.style.display === 'block' || multiplexerModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        multiplexerModal.classList.remove('show');
                        multiplexerModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            
    
        }
        
        // Lab 9 Demultiplexer Modal Functionality
        function initializeLab9DemultiplexerModal() {
            
            const demultiplexerModal = document.getElementById('demultiplexerModalLab9');
            const demultiplexerInfoBtn = document.getElementById('demultiplexer-info-btn-lab9');
            const closeDemultiplexerModal = document.getElementById('closeDemultiplexerModalLab9');
            

            
            if (!demultiplexerModal || !demultiplexerInfoBtn || !closeDemultiplexerModal) {
                console.error('Some elements not found for Lab 9 demultiplexer modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            demultiplexerInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                demultiplexerModal.classList.add('show');
                demultiplexerModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeDemultiplexerModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                demultiplexerModal.classList.remove('show');
                demultiplexerModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            demultiplexerModal.addEventListener('click', function(e) {
                if (e.target === demultiplexerModal) {
                    demultiplexerModal.classList.remove('show');
                    demultiplexerModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (demultiplexerModal.style.display === 'block' || demultiplexerModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        demultiplexerModal.classList.remove('show');
                        demultiplexerModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            
    
        }
        
        // Lab 10 D-Flip Flop Modal Functionality
        function initializeLab10DFlipFlopModal() {
            
            const dFlipFlopModal = document.getElementById('dFlipFlopModalLab10');
            const dFlipFlopInfoBtn = document.getElementById('d-flipflop-info-btn-lab10');
            const closeDFlipFlopModal = document.getElementById('closeDFlipFlopModalLab10');
            

            
            if (!dFlipFlopModal || !dFlipFlopInfoBtn || !closeDFlipFlopModal) {
                console.error('Some elements not found for Lab 10 D-Flip Flop modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            dFlipFlopInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                dFlipFlopModal.classList.add('show');
                dFlipFlopModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeDFlipFlopModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                dFlipFlopModal.classList.remove('show');
                dFlipFlopModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            dFlipFlopModal.addEventListener('click', function(e) {
                if (e.target === dFlipFlopModal) {
                    dFlipFlopModal.classList.remove('show');
                    dFlipFlopModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (dFlipFlopModal.style.display === 'block' || dFlipFlopModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        dFlipFlopModal.classList.remove('show');
                        dFlipFlopModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            
    
        }
        
        // Lab 10 JK-Flip Flop Modal Functionality
        function initializeLab10JKFlipFlopModal() {
            
            const jkFlipFlopModal = document.getElementById('jkFlipFlopModalLab10');
            const jkFlipFlopInfoBtn = document.getElementById('jk-flipflop-info-btn-lab10');
            const closeJKFlipFlopModal = document.getElementById('closeJKFlipFlopModalLab10');
            

            
            if (!jkFlipFlopModal || !jkFlipFlopInfoBtn || !closeJKFlipFlopModal) {
                console.error('Some elements not found for Lab 10 JK-Flip Flop modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            jkFlipFlopInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                jkFlipFlopModal.classList.add('show');
                jkFlipFlopModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeJKFlipFlopModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                jkFlipFlopModal.classList.remove('show');
                jkFlipFlopModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            jkFlipFlopModal.addEventListener('click', function(e) {
                if (e.target === jkFlipFlopModal) {
                    jkFlipFlopModal.classList.remove('show');
                    jkFlipFlopModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (jkFlipFlopModal.style.display === 'block' || jkFlipFlopModal.style.display === 'block' || jkFlipFlopModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        jkFlipFlopModal.classList.remove('show');
                        jkFlipFlopModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            
    
        }
        
        // Lab 9 MUX Info Modal Functionality
        function initializeLab9MuxModal() {
    
            
            const muxModal = document.getElementById('muxModalLab9');
            const muxInfoBtn = document.getElementById('mux-info-btn-lab9');
            const closeMuxModal = document.getElementById('closeMuxModalLab9');
            

            
            if (!muxModal || !muxInfoBtn || !closeMuxModal) {
                console.error('Some elements not found for Lab 9 MUX modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            muxInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                muxModal.classList.add('show');
                muxModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeMuxModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                muxModal.classList.remove('show');
                muxModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            muxModal.addEventListener('click', function(e) {
                if (e.target === muxModal) {
                    muxModal.classList.remove('show');
                    muxModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (muxModal.style.display === 'block' || muxModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        muxModal.classList.remove('show');
                        muxModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            
    
        }
        
        // Lab 9 Multiplexer Simulator Logic
        function updateMultiplexerSimulator() {
            const a = document.getElementById('muxA').checked ? 1 : 0;
            const b = document.getElementById('muxB').checked ? 1 : 0;
            const c = document.getElementById('muxC').checked ? 1 : 0;
            const d = document.getElementById('muxD').checked ? 1 : 0;
            
            // Get all the display elements
            const muxDataInputs = [
                document.getElementById('muxD0'),
                document.getElementById('muxD1'),
                document.getElementById('muxD2'),
                document.getElementById('muxD3'),
                document.getElementById('muxD4'),
                document.getElementById('muxD5'),
                document.getElementById('muxD6'),
                document.getElementById('muxD7')
            ];
            
            const selectorsDisplay = document.getElementById('muxSelectors');
            const dataInputDisplay = document.getElementById('muxDataInput');
            const outputValue = document.getElementById('muxState');
            const led = document.getElementById('muxOutput');
            
            // Calculate selector value (0-7)
            const selectValue = a * 4 + b * 2 + c * 1;
            
            // Update selector and data input display
            selectorsDisplay.textContent = `${a}${b}${c}`;
            dataInputDisplay.textContent = d;
            
            // Apply the logic from truth table's two output columns
            // Based on the MUX Input analysis from the Pre-lab Activity
            // Function F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15)
            // Pattern analysis: For each A,B,C combination, analyze F outputs for D=0 and D=1
            // 0,0 → MUX input = 0, 1,1 → MUX input = 1, 0,1 → MUX input = D, 1,0 → MUX input = D'
            const muxInputValues = [
                'D\'', // D0: A=0,B=0,C=0 → F(0,0,0,0)=1, F(0,0,0,1)=0 → Pattern: 1,0 → MUX input = D'
                'D',  // D1: A=0,B=0,C=1 → F(0,0,1,0)=0, F(0,0,1,1)=1 → Pattern: 0,1 → MUX input = D
                'D\'', // D2: A=0,B=1,C=0 → F(0,1,0,0)=1, F(0,1,0,1)=0 → Pattern: 1,0 → MUX input = D'
                'D',  // D3: A=0,B=1,C=1 → F(0,1,1,0)=0, F(0,1,1,1)=1 → Pattern: 0,1 → MUX input = D
                '1',  // D4: A=1,B=0,C=0 → F(1,0,0,0)=1, F(1,0,0,1)=1 → Pattern: 1,1 → MUX input = 1
                '0',  // D5: A=1,B=0,C=1 → F(1,0,1,0)=0, F(1,0,1,1)=0 → Pattern: 0,0 → MUX input = 0
                'D\'', // D6: A=1,B=1,C=0 → F(1,1,0,0)=1, F(1,1,0,1)=0 → Pattern: 1,0 → MUX input = D'
                'D'   // D7: A=1,B=1,C=1 → F(1,1,1,0)=0, F(1,1,1,1)=1 → Pattern: 0,1 → MUX input = D
            ];
            
            // Update all MUX data inputs with their calculated values
            muxDataInputs.forEach((input, index) => {
                if (input) {
                    let displayValue = muxInputValues[index];
                    
                    // Replace D and D' with actual values based on current D input
                    if (displayValue === 'D') {
                        displayValue = d;
                    } else if (displayValue === 'D\'') {
                        displayValue = d === 1 ? 0 : 1; // Invert D
                    }
                    
                    input.textContent = displayValue;
                    
                    // Apply styling based on the value
                    if (displayValue === 1) {
                        input.style.color = '#2ecc71';  // Green for 1
                        input.style.fontWeight = 'bold';
                    } else {
                        input.style.color = '#e74c3c';  // Red for 0
                        input.style.fontWeight = 'normal';
                    }
                }
            });
            
            // Calculate the final output based on selected data line
            const selectedDataValue = muxDataInputs[selectValue] ? 
                parseInt(muxDataInputs[selectValue].textContent) : 0;
            
            // Update output display
            if (selectedDataValue) {
                outputValue.textContent = '1 (HIGH)';
                outputValue.style.color = '#2ecc71';
                led.classList.add('active');
                led.setAttribute('aria-label', 'Multiplexer Output LED is ON');
            } else {
                outputValue.textContent = '0 (LOW)';
                outputValue.style.color = '#e74c3c';
                led.classList.remove('active');
                led.setAttribute('aria-label', 'Multiplexer Output LED is OFF');
            }
            
    
            
            // Verification: Log the MUX input values for debugging and validation
    
        }
        
        // Verification function to ensure MUX input logic matches truth table
        function verifyMuxInputLogic() {
    
            
            const testCases = [
                { abc: '000', expected: 'D\'', description: 'A=0,B=0,C=0 → F(0,0,0,0)=1, F(0,0,0,1)=0 → Pattern: 1,0 → D\'' },
                { abc: '001', expected: 'D', description: 'A=0,B=0,C=1 → F(0,0,1,0)=0, F(0,0,1,1)=1 → Pattern: 0,1 → D' },
                { abc: '010', expected: 'D\'', description: 'A=0,B=1,C=0 → F(0,1,0,0)=1, F(0,1,0,1)=0 → Pattern: 1,0 → D\'' },
                { abc: '011', expected: 'D', description: 'A=0,B=1,C=1 → F(0,1,1,0)=0, F(0,1,1,1)=1 → Pattern: 0,1 → D' },
                { abc: '100', expected: '1', description: 'A=1,B=0,C=0 → F(1,0,0,0)=1, F(1,0,0,1)=1 → Pattern: 1,1 → 1' },
                { abc: '101', expected: '0', description: 'A=1,B=0,C=1 → F(1,0,1,0)=0, F(1,0,1,1)=0 → Pattern: 0,0 → 0' },
                { abc: '110', expected: 'D\'', description: 'A=1,B=1,C=0 → F(1,1,0,0)=1, F(1,1,0,1)=0 → Pattern: 1,0 → D\'' },
                { abc: '111', expected: 'D', description: 'A=1,B=1,C=1 → F(1,1,1,0)=0, F(1,1,1,1)=1 → Pattern: 0,1 → D' }
            ];
            
            testCases.forEach(testCase => {
                const abcNum = parseInt(testCase.abc, 2);
                const a = abcNum >> 2;
                const b = (abcNum >> 1) & 1;
                const c = abcNum & 1;
                
                const f0 = evaluateLab9F(a, b, c, 0);
                const f1 = evaluateLab9F(a, b, c, 1);
                
                let expectedMuxInput;
                if (f0 === 0 && f1 === 0) expectedMuxInput = '0';
                else if (f0 === 1 && f1 === 1) expectedMuxInput = '1';
                else if (f0 === 0 && f1 === 1) expectedMuxInput = 'D';
                else if (f0 === 1 && f1 === 0) expectedMuxInput = 'D\'';
                else expectedMuxInput = 'ERROR';
                
                const isCorrect = expectedMuxInput === testCase.expected;

                
                if (!isCorrect) {
                    console.error(`Logic Error: ${testCase.description}`);
                }
            });
            
    
        }
        
        // Lab 9 Truth Table Logic
        function evaluateLab9F(a, b, c, d) {
            // F(A,B,C,D) = ∑(0,3,4,7,8,9,12,15)
            // Convert to decimal and check if it's in the minterm list
            a = Number(a); b = Number(b); c = Number(c); d = Number(d);
            const decimal = a * 8 + b * 4 + c * 2 + d * 1;
            const minterms = [0, 3, 4, 7, 8, 9, 12, 15];
            return minterms.includes(decimal) ? 1 : 0;
        }
        
        function evaluateLab9MuxInput(abc) {
            // Determine MUX input based on A,B,C combination and F outputs
            // This function analyzes the pattern of F outputs for D=0 and D=1
            const abcNum = parseInt(abc, 2);
            const f0 = evaluateLab9F(abcNum >> 2, (abcNum >> 1) & 1, abcNum & 1, 0);
            const f1 = evaluateLab9F(abcNum >> 2, (abcNum >> 1) & 1, abcNum & 1, 1);
            
            // Pattern analysis for MUX input determination
            if (f0 === 0 && f1 === 0) return '0';      // Both outputs are 0
            if (f0 === 1 && f1 === 1) return '1';      // Both outputs are 1
            if (f0 === 0 && f1 === 1) return 'D';      // Output follows D
            if (f0 === 1 && f1 === 0) return 'D\'';    // Output follows D'
            
            return '0'; // Default fallback
        }
        
        function clearFieldStyleLab9(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        
        function clearMuxFieldStyleLab9(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        
        // Initialize Lab 9 Truth Table when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab9TruthTable);
            document.addEventListener('DOMContentLoaded', initializeLab9MultiplexerSimulator);
            document.addEventListener('DOMContentLoaded', initializeLab9LogicDesignModal);
        } else {
            initializeLab9TruthTable();
            initializeLab9MultiplexerSimulator();
            initializeLab9LogicDesignModal();
        }
        
        // Initialize Lab 11 Logic Design Modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab11LogicDesignModal);
        } else {
            initializeLab11LogicDesignModal();
        }
        
        // Lab 11 Logic Design Modal Functionality
        function initializeLab11LogicDesignModal() {
            const logicDesignModal = document.getElementById('logicDesignModalLab11');
            const logicDesignBtn = document.getElementById('logicDesignBtnLab11');
            const closeLogicDesignModal = document.getElementById('closeLogicDesignModalLab11');
            
            if (!logicDesignModal || !logicDesignBtn || !closeLogicDesignModal) {
                console.error('Some elements not found for Lab 11 logic design modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            logicDesignBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                logicDesignModal.classList.add('show');
                logicDesignModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeLogicDesignModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                logicDesignModal.classList.remove('show');
                logicDesignModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            logicDesignModal.addEventListener('click', function(e) {
                if (e.target === logicDesignModal) {
                    logicDesignModal.classList.remove('show');
                    logicDesignModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation (Escape key)
            document.addEventListener('keydown', function(e) {
                if (logicDesignModal.style.display === 'block' || logicDesignModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        logicDesignModal.classList.remove('show');
                        logicDesignModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        }
        
        function initializeLab9TruthTable() {
    
            
            const fInputs = document.querySelectorAll('.output-field-lab9');
            const muxInputs = document.querySelectorAll('.mux-input-field-lab9');
            const checkAnswersBtn = document.getElementById('check-answers-btn-lab9');
            const clearTableBtn = document.getElementById('clear-table-btn-lab9');
            
            if (!fInputs.length || !muxInputs.length || !checkAnswersBtn || !clearTableBtn) {
                console.error('Some elements not found for Lab 9 truth table');
                return;
            }
            
            // Add event listeners to F inputs
            fInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value;
                    if (v !== '0' && v !== '1') input.value = '';
                    clearFieldStyleLab9(input);
                });
                
                input.addEventListener('focus', function() {
                    input.select();
                });
                
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab9, .mux-input-field-lab9', true);
                });
            });
            
            // Add event listeners to MUX inputs
            muxInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value.toLowerCase();
                    // Allow: 0, 1, d, d', D, D'
                    if (!['0', '1', 'd', 'd\''].includes(v) && !['0', '1', 'd', 'd\''].includes(input.value)) {
                        input.value = '';
                    }
                    clearMuxFieldStyleLab9(input);
                });
                
                input.addEventListener('focus', function() {
                    input.select();
                });
                
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab9, .mux-input-field-lab9', true);
                });
            });
            
            // Check answers button
            checkAnswersBtn.addEventListener('click', () => {
                // Check F outputs
                fInputs.forEach(input => {
                    const { a, b, c, d } = input.dataset;
                    const correct = evaluateLab9F(a, b, c, d);
                    
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct','incorrect');
                    } else if (parseInt(input.value) === correct) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect','empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct','empty');
                    }
                });
                
                // Check MUX inputs
                muxInputs.forEach(input => {
                    const { abc } = input.dataset;
                    const correct = evaluateLab9MuxInput(abc);
                    
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct','incorrect');
                    } else if (input.value.toLowerCase() === correct.toLowerCase()) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect','empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct','empty');
                    }
                });
            });
            
            // Clear table button
            clearTableBtn.addEventListener('click', () => {
                fInputs.forEach(input => {
                    input.value = '';
                    clearFieldStyleLab9(input);
                });
                muxInputs.forEach(input => {
                    input.value = '';
                    clearMuxFieldStyleLab9(input);
                });
            });
            
    
        }
        
        function initializeLab9MultiplexerSimulator() {
    
            
            const muxInputs = ['muxA', 'muxB', 'muxC', 'muxD'];
            
            muxInputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('change', updateMultiplexerSimulator);
                }
            });
            
            // Verify the MUX input logic against the truth table
            verifyMuxInputLogic();
            
            // Initialize the simulator
            updateMultiplexerSimulator();
            
    
        }
        
        // Lab 9 Logic Design Modal Functionality
        function initializeLab9LogicDesignModal() {
    
            
            const logicDesignModal = document.getElementById('logicDesignModalLab9');
            const logicDesignBtn = document.getElementById('logicDesignBtnLab9');
            const closeLogicDesignModal = document.getElementById('closeLogicDesignModalLab9');
            
            if (!logicDesignModal || !logicDesignBtn || !closeLogicDesignModal) {
                console.error('Some elements not found for Lab 9 logic design modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            logicDesignBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                logicDesignModal.classList.add('show');
                logicDesignModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeLogicDesignModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                logicDesignModal.classList.remove('show');
                logicDesignModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            logicDesignModal.addEventListener('click', function(e) {
                if (e.target === logicDesignModal) {
                    logicDesignModal.classList.remove('show');
                    logicDesignModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation (Escape key)
            document.addEventListener('keydown', function(e) {
                if (logicDesignModal.style.display === 'block' || logicDesignModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        logicDesignModal.classList.remove('show');
                        logicDesignModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
            

        }
        

        
        // Lab 8 Decoder Modal Functionality
        function initializeLab8DecoderModal() {
    
            
            const decoderModal = document.getElementById('decoderModalLab8');
            const decoderInfoBtn = document.getElementById('decoder-info-btn-lab8');
            const closeDecoderModal = document.getElementById('closeDecoderModalLab8');
            const decoder74139Btn = document.getElementById('decoder74139Btn');
            const decoder74LS238Btn = document.getElementById('decoder74LS238Btn');
            const decoderImage = document.getElementById('decoderImageLab8');

            

            
            if (!decoderModal || !decoderInfoBtn || !closeDecoderModal || !decoder74139Btn || !decoder74LS238Btn || !decoderImage) {
                console.error('Some elements not found for Lab 8 decoder modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            decoderInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();

                decoderModal.classList.add('show');
                decoderModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeDecoderModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                decoderModal.classList.remove('show');
                decoderModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            decoderModal.addEventListener('click', function(e) {
                if (e.target === decoderModal) {
                    decoderModal.classList.remove('show');
                    decoderModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Switch to 2x4 decoder
            decoder74139Btn.addEventListener('click', function() {
                decoderImage.src = 'media/Decoder_2_4.png';
                decoderImage.alt = 'Decoder 2x4 Example';
                
                // Update button states
                decoder74139Btn.classList.add('active');
                decoder74LS238Btn.classList.remove('active');
            });
            
            // Switch to 3x8 decoder
            decoder74LS238Btn.addEventListener('click', function() {
                decoderImage.src = 'media/Decoder_3_8.png';
                decoderImage.alt = 'Decoder 3x8 Example';
                
                // Update button states
                decoder74LS238Btn.classList.add('active');
                decoder74139Btn.classList.remove('active');
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (decoderModal.style.display === 'block' || decoderModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        decoderModal.classList.remove('show');
                        decoderModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    } else if (e.key === 'ArrowLeft') {
                        // Switch to 2x4 decoder (left option)
                        decoderImage.src = 'media/Decoder_2_4.png';
                        decoderImage.alt = 'Decoder 2x4 Example';
                        
                        // Update button states
                        decoder74139Btn.classList.add('active');
                        decoder74LS238Btn.classList.remove('active');
                    } else if (e.key === 'ArrowRight') {

                        // Switch to 3x8 decoder (right option)
                        decoderImage.src = 'media/Decoder_3_8.png';
                        decoderImage.alt = 'Decoder 3x8 Example';
                        
                        // Update button states
                        decoder74LS238Btn.classList.add('active');
                        decoder74139Btn.classList.remove('active');
                    }
                }
            });
            
    
        }
        
        // Lab 8 Logic Design Modal Functionality
        function initializeLab8LogicDesignModal() {
            const logicDesignModal = document.getElementById('logicDesignModalLab8');
            const logicDesignBtn = document.getElementById('logicDesignBtnLab8');
            const closeLogicDesignModal = document.getElementById('closeLogicDesignModalLab8');
            
            if (!logicDesignModal || !logicDesignBtn || !closeLogicDesignModal) {
                console.error('Some elements not found for Lab 8 logic design modal');
                return; // Elements not found, exit early
            }
            
                        // Open modal
            logicDesignBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                logicDesignModal.classList.add('show');
                logicDesignModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeLogicDesignModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                logicDesignModal.classList.remove('show');
                logicDesignModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            logicDesignModal.addEventListener('click', function(e) {
                if (e.target === logicDesignModal) {
                    logicDesignModal.classList.remove('show');
                    logicDesignModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation (Escape key)
            document.addEventListener('keydown', function(e) {
                if (logicDesignModal.style.display === 'block' || logicDesignModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        logicDesignModal.classList.remove('show');
                        logicDesignModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        }
        
        // Lab 8 Chip Modal Functionality
        function initializeLab8ChipModal() {
            const chipModal = document.getElementById('chipModalLab8');
            const chipInfoBtn = document.getElementById('chip-info-btn-lab8');
            const closeChipModal = document.getElementById('closeChipModalLab8');
            
            if (!chipModal || !chipInfoBtn || !closeChipModal) {
                console.error('Some elements not found for Lab 8 chip modal');
                return; // Elements not found, exit early
            }
            
            // Open modal
            chipInfoBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                chipModal.classList.add('show');
                chipModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            closeChipModal.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                chipModal.classList.remove('show');
                chipModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
            
            // Close modal when clicking outside
            chipModal.addEventListener('click', function(e) {
                if (e.target === chipModal) {
                    chipModal.classList.remove('show');
                    chipModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (chipModal.style.display === 'block' || chipModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        chipModal.classList.remove('show');
                        chipModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        }
        
        // Lab 8: 3x8 Decoder with OR Gates Simulator
        function initializeLab8DecoderSimulator() {
    
            
            // Wait a bit to ensure DOM is fully ready
            setTimeout(() => {
                const decX = document.getElementById('lab8DecX');
                const decY = document.getElementById('lab8DecY');
                const decZ = document.getElementById('lab8DecZ');
                
                const decoderOutputs = [
                    document.getElementById('lab8D0'),
                    document.getElementById('lab8D1'),
                    document.getElementById('lab8D2'),
                    document.getElementById('lab8D3'),
                    document.getElementById('lab8D4'),
                    document.getElementById('lab8D5'),
                    document.getElementById('lab8D6'),
                    document.getElementById('lab8D7')
                ];
                
                const binaryInput = document.getElementById('lab8BinaryInput');
                const decimalInput = document.getElementById('lab8DecimalInput');
                
                const f1Led = document.getElementById('lab8F1Led');
                const f2Led = document.getElementById('lab8F2Led');
                const f3Led = document.getElementById('lab8F3Led');
                
                const f1State = document.getElementById('lab8F1State');
                const f2State = document.getElementById('lab8F2State');
                const f3State = document.getElementById('lab8F3State');
                

                
                if (!decX || !decY || !decZ || decoderOutputs.some(el => !el) || 
                    !binaryInput || !decimalInput || !f1Led || !f2Led || !f3Led ||
                    !f1State || !f2State || !f3State) {
                    console.error('Some elements not found for Lab 8 decoder simulator');
                    return;
                }
                
                function updateLab8DecoderSimulator() {
                    const X = decX.checked ? 1 : 0;
                    const Y = decY.checked ? 1 : 0;
                    const Z = decZ.checked ? 1 : 0;
                    
                    // Calculate binary and decimal input
                    const binary = `${X}${Y}${Z}`;
                    const decimal = (X << 2) | (Y << 1) | Z;
                    
                    // Update input display
                    binaryInput.textContent = binary;
                    decimalInput.textContent = decimal;
                    
                    // Update decoder outputs (only one output is active at a time)
                    decoderOutputs.forEach((output, index) => {
                        output.textContent = (index === decimal) ? '1' : '0';
                        output.style.color = (index === decimal) ? '#2ecc71' : '#e74c3c';
                        output.style.fontWeight = (index === decimal) ? 'bold' : 'normal';
                    });
                    
                    // Calculate function outputs using OR gates
                    // F1 = D0 + D5 + D7 (minterms 0, 5, 7)
                    const f1 = (decimal === 0 || decimal === 5 || decimal === 7) ? 1 : 0;
                    
                    // F2 = D1 + D2 + D6 (minterms 1, 2, 6)
                    const f2 = (decimal === 1 || decimal === 2 || decimal === 6) ? 1 : 0;
                    
                    // F3 = D0 + D3 + D7 (minterms 0, 3, 7)
                    const f3 = (decimal === 0 || decimal === 3 || decimal === 7) ? 1 : 0;
                    
                    // Update F1 LED and state
                    if (f1) {
                        f1Led.classList.add('active');
                        f1Led.setAttribute('aria-label', 'F1 LED is ON');
                        f1State.textContent = '1 (HIGH)';
                        f1State.style.color = '#2ecc71';
                    } else {
                        f1Led.classList.remove('active');
                        f1Led.setAttribute('aria-label', 'F1 LED is OFF');
                        f1State.textContent = '0 (LOW)';
                        f1State.style.color = '#e74c3c';
                    }
                    
                    // Update F2 LED and state
                    if (f2) {
                        f2Led.classList.add('active');
                        f2Led.setAttribute('aria-label', 'F2 LED is ON');
                        f2State.textContent = '1 (HIGH)';
                        f2State.style.color = '#2ecc71';
                    } else {
                        f2Led.classList.remove('active');
                        f2Led.setAttribute('aria-label', 'F2 LED is OFF');
                        f2State.textContent = '0 (LOW)';
                        f2State.style.color = '#e74c3c';
                    }
                    
                    // Update F3 LED and state
                    if (f3) {
                        f3Led.classList.add('active');
                        f3Led.setAttribute('aria-label', 'F3 LED is ON');
                        f3State.textContent = '1 (HIGH)';
                        f3State.style.color = '#2ecc71';
                    } else {
                        f3Led.classList.remove('active');
                        f3Led.setAttribute('aria-label', 'F3 LED is OFF');
                        f3State.textContent = '0 (LOW)';
                        f3State.style.color = '#e74c3c';
                    }
                    

                }
                
                // Add event listeners with better error handling
                try {
                    [decX, decY, decZ].forEach((input, index) => {
                        if (input) {
                            const inputName = ['X', 'Y', 'Z'][index];
                            const label = document.querySelector(`label[for="${input.id}"]`);
                            
                            // Remove any existing listeners first
                            input.removeEventListener('change', updateLab8DecoderSimulator);
                            input.removeEventListener('keydown', input._keydownHandler);
                            
                            // Add change event listener
                            input.addEventListener('change', function(e) {
                                if (label) {
                                    label.setAttribute('aria-pressed', input.checked.toString());
                                }
                                updateLab8DecoderSimulator();
                            });
                            
                            // Add keyboard event listener
                            const keydownHandler = function(e) {
                                if (e.key === 'Enter' || e.key === ' ') {
                                    e.preventDefault();
                                    input.checked = !input.checked;
                                    if (label) {
                                        label.setAttribute('aria-pressed', input.checked.toString());
                                    }
                                    updateLab8DecoderSimulator();
                                }
                            };
                            input._keydownHandler = keydownHandler;
                            input.addEventListener('keydown', keydownHandler);
                            
                            // Add click event listener as backup
                            input.addEventListener('click', function(e) {
                                if (label) {
                                    label.setAttribute('aria-pressed', input.checked.toString());
                                }
                                updateLab8DecoderSimulator();
                            });
                            
                            // Add label click event listener
                            if (label) {
                                label.addEventListener('click', function(e) {
                                    e.preventDefault();
                                    input.checked = !input.checked;
                                    label.setAttribute('aria-pressed', input.checked.toString());
                                    updateLab8DecoderSimulator();
                                });
                                
                                label.addEventListener('keydown', function(e) {
                                    if (e.key === 'Enter' || e.key === ' ') {
                                        e.preventDefault();
                                        input.checked = !input.checked;
                                        label.setAttribute('aria-pressed', input.checked.toString());
                                        updateLab8DecoderSimulator();
                                    }
                                });
                            }
                            

                        } else {
                            console.error(`Lab 8 Input ${['X', 'Y', 'Z'][index]} not found`);
                        }
                    });
                    
                    // Initialize simulator
                    updateLab8DecoderSimulator();
                    

                } catch (error) {
                    console.error('Error setting up Lab 8 Decoder Simulator:', error);
                }
            }, 100); // Small delay to ensure DOM is ready
        }
        
        // Lab 7: BCD to Excess-3 Converter Simulator
        function initializeBcdToExcess3Simulator() {
    
            
                        const bcdSwitches = [
                document.getElementById('bcdW'),
                document.getElementById('bcdX'),
                document.getElementById('bcdY'),
                document.getElementById('bcdZ')
            ];
            
            const excess3Leds = [
                document.getElementById('lab7LedCout'),
                document.getElementById('lab7LedD'),
                document.getElementById('lab7LedC'),
                document.getElementById('lab7LedB'),
                document.getElementById('lab7LedA')
            ];
            

            
            // ===== LAB 7: BCD to Excess-3 Simulator (Completely separate from Lab 1) =====
            // Note: Lab 7 uses IDs: lab7LedA, lab7LedB, lab7LedC, lab7LedD, lab7LedCout
            
            const bcdBinaryValue = document.getElementById('bcdBinaryValue');
            const bcdDecimalValue = document.getElementById('bcdDecimalValue');
            const excess3BinaryValue = document.getElementById('excess3BinaryValue');
            const excess3DecimalValue = document.getElementById('excess3DecimalValue');
            
            const tensSegments = {
                a: document.getElementById('tensSegA'),
                b: document.getElementById('tensSegB'),
                c: document.getElementById('tensSegC'),
                d: document.getElementById('tensSegD'),
                e: document.getElementById('tensSegE'),
                f: document.getElementById('tensSegF'),
                g: document.getElementById('tensSegG')
            };
            
            const onesSegments = {
                a: document.getElementById('onesSegA'),
                b: document.getElementById('onesSegB'),
                c: document.getElementById('onesSegC'),
                d: document.getElementById('onesSegD'),
                e: document.getElementById('onesSegE'),
                f: document.getElementById('onesSegF'),
                g: document.getElementById('onesSegG')
            };
            
            // BCD to Excess-3 conversion function
            function bcdToExcess3(bcdValue) {
                // Add 3 (0011) to BCD value
                const excess3Value = bcdValue + 3;
                return excess3Value;
            }
            
            // Update 7-segment display based on decimal value (0-9 only)
            function updateSevenSegment(segments, decimalValue) {
                const segKeys = ['a', 'b', 'c', 'd', 'e', 'f', 'g'];
                const SEG_ON_COLOR = '#ff1744'; // bright red
                const SEG_OFF_COLOR = '#2a0000'; // dim red
                const SEG_INVALID_COLOR = '#333333'; // darker gray for invalid input
                const SEG_ON_GLOW = 'drop-shadow(0 0 12px #ff1744)';
                
                // 7-segment truth table for 0-9 (common cathode)
                const bcd7447Segments = [
                    [1,1,1,1,1,1,0], // 0
                    [0,1,1,0,0,0,0], // 1
                    [1,1,0,1,1,0,1], // 2
                    [1,1,1,1,0,0,1], // 3
                    [0,1,1,0,0,1,1], // 4
                    [1,0,1,1,0,1,1], // 5
                    [1,0,1,1,1,1,1], // 6
                    [1,1,1,0,0,0,0], // 7
                    [1,1,1,1,1,1,1], // 8
                    [1,1,1,1,0,1,1], // 9
                ];
                
                // Handle different input cases
                let segs;
                if (decimalValue === -1) {
                    // Invalid input - all segments off with darker color
                    segs = [0,0,0,0,0,0,0];
                } else if (decimalValue >= 0 && decimalValue <= 9) {
                    // Valid decimal value (0-9)
                    segs = bcd7447Segments[decimalValue];
                } else {
                    // Out of range - all segments off
                    segs = [0,0,0,0,0,0,0];
                }
                
                segKeys.forEach((key, i) => {
                    if (segments[key]) {
                        if (segs[i]) {
                            segments[key].setAttribute('fill', SEG_ON_COLOR);
                            segments[key].setAttribute('filter', SEG_ON_GLOW);
                        } else {
                            // Use darker color for invalid input, normal off color for valid off segments
                            const offColor = decimalValue === -1 ? SEG_INVALID_COLOR : SEG_OFF_COLOR;
                            segments[key].setAttribute('fill', offColor);
                            segments[key].removeAttribute('filter');
                        }
                    }
                });
            }
            
            // Update BCD to Excess-3 simulator
            function updateBcdToExcess3Simulator() {
                if (!bcdSwitches[0] || !bcdSwitches[1] || !bcdSwitches[2] || !bcdSwitches[3]) return;
                
                // Get BCD input values
                const bcdW = bcdSwitches[0].checked;
                const bcdX = bcdSwitches[1].checked;
                const bcdY = bcdSwitches[2].checked;
                const bcdZ = bcdSwitches[3].checked;
                
                // Calculate BCD decimal value
                const bcdDecimal = (bcdW ? 8 : 0) + (bcdX ? 4 : 0) + (bcdY ? 2 : 0) + (bcdZ ? 1 : 0);
                const bcdBinary = `${bcdW ? '1' : '0'}${bcdX ? '1' : '0'}${bcdY ? '1' : '0'}${bcdZ ? '1' : '0'}`;
                
                // Check if BCD input is valid (0-9 only)
                const isBcdValid = bcdDecimal >= 0 && bcdDecimal <= 9;
                
                if (isBcdValid) {
                    // Calculate Excess-3 output for valid BCD input
                    const excess3Decimal = bcdToExcess3(bcdDecimal);
                    const excess3Binary = excess3Decimal.toString(2).padStart(5, '0');
                    
                    // Update Excess-3 LEDs
                    const excess3Bits = excess3Binary.split('').map(bit => bit === '1');
                    excess3Bits.forEach((state, i) => {
                        if (excess3Leds[i]) {
                            if (state) {
                                excess3Leds[i].classList.add('active');
                                excess3Leds[i].setAttribute('aria-label', `LED ${['Cout', 'D', 'C', 'B', 'A'][i]} is ON`);
                            } else {
                                excess3Leds[i].classList.remove('active');
                                excess3Leds[i].setAttribute('aria-label', `LED ${['Cout', 'D', 'C', 'B', 'A'][i]} is OFF`);
                            }
                        }
                    });
                    
                    // Update 7-segment displays
                    const tensPlace = Math.floor(excess3Decimal / 10);
                    const onesPlace = excess3Decimal % 10;
                    
                    updateSevenSegment(tensSegments, tensPlace);
                    updateSevenSegment(onesSegments, onesPlace);
                    
                    // Update binary and decimal displays
                    if (excess3BinaryValue) {
                        excess3BinaryValue.textContent = excess3Binary;
                        excess3BinaryValue.style.color = 'var(--text)';
                    }
                    if (excess3DecimalValue) {
                        excess3DecimalValue.textContent = excess3Decimal;
                        excess3DecimalValue.style.color = 'var(--text)';
                    }
                } else {
                    // Invalid BCD input (> 9) - turn off all LEDs and 7-segments
                    excess3Leds.forEach((led, i) => {
                        if (led) {
                            led.classList.remove('active');
                            led.setAttribute('aria-label', `LED ${['Cout', 'D', 'C', 'B', 'A'][i]} is OFF (Invalid Input)`);
                        }
                    });
                    
                    updateSevenSegment(tensSegments, -1); // -1 indicates invalid/off
                    updateSevenSegment(onesSegments, -1);
                    
                    // Clear Excess-3 values for invalid input
                    if (excess3BinaryValue) {
                        excess3BinaryValue.textContent = '----';
                        excess3BinaryValue.style.color = '#e74c3c';
                    }
                    if (excess3DecimalValue) {
                        excess3DecimalValue.textContent = '--';
                        excess3DecimalValue.style.color = '#e74c3c';
                    }
                }
                
                // Always update BCD values (input is always shown)
                if (bcdBinaryValue) bcdBinaryValue.textContent = bcdBinary;
                if (bcdDecimalValue) bcdDecimalValue.textContent = bcdDecimal;
            }
            
            // Add event listeners for BCD switches
            bcdSwitches.forEach(switchElement => {
                if (switchElement) {
                    switchElement.addEventListener('change', updateBcdToExcess3Simulator);
                }
            });
            
            // Initialize BCD to Excess-3 simulator
            if (bcdSwitches[0] && bcdSwitches[1] && bcdSwitches[2] && bcdSwitches[3]) {
                updateBcdToExcess3Simulator();
            }
            
            // Test function to verify Lab 7 simulator independence
    
    
        }
        
        // Initialize BCD to Excess-3 Simulator
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeBcdToExcess3Simulator);
        } else {
            initializeBcdToExcess3Simulator();
        }
        
        // Initialize Lab 7 chip modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab7ChipModal);
        } else {
            initializeLab7ChipModal();
        }
        
        // Initialize Lab 8 decoder modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab8DecoderModal);
        } else {
            initializeLab8DecoderModal();
        }
        
        // Initialize Lab 9 multiplexer modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab9MultiplexerModal);
        } else {
            initializeLab9MultiplexerModal();
        }
        
        // Initialize Lab 9 demultiplexer modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab9DemultiplexerModal);
            document.addEventListener('DOMContentLoaded', initializeLab9MuxModal);
        } else {
            initializeLab9DemultiplexerModal();
            initializeLab9MuxModal();
        }
        
        // Initialize Lab 10 D-Flip Flop modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab10DFlipFlopModal);
        } else {
            initializeLab10DFlipFlopModal();
        }
        
        // Initialize Lab 10 JK-Flip Flop modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab10JKFlipFlopModal);
        } else {
            initializeLab10JKFlipFlopModal();
        }
        
        // Initialize Lab 8 chip modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab8ChipModal);
        } else {
            initializeLab8ChipModal();
        }
        
        // Initialize Lab 8 logic design modal when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab8LogicDesignModal);
        } else {
            initializeLab8LogicDesignModal();
        }
        
        // Initialize Lab 8 decoder simulator when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab8DecoderSimulator);
        } else {
            initializeLab8DecoderSimulator();
        }
        

        
        // Lab 6 Function Simulators
        function evaluateFunctionF(a, b, c, d) {
            // Function F(A,B,C,D) = Σ(1,3,5,7,9,13,15) with don't care d(A,B,C,D) = Σ(4,6,12)
            // Convert binary to decimal
            const decimal = (a << 3) | (b << 2) | (c << 1) | d;
            
            // Check if it's a minterm (output = 1)
            if ([1, 3, 5, 7, 9, 13, 15].includes(decimal)) {
                return 1;
            }
            // Check if it's a don't care (output = 0 for this implementation)
            else if ([4, 6, 12].includes(decimal)) {
                return 0;
            }
            // Otherwise output = 0
            else {
                return 0;
            }
        }
        
        function evaluateFunctionH(a, b, c, d) {
            // Function H = AB' + ABC + ABD' + A'C'D' + A'BC'
            // Convert to Boolean logic
            const A = a ? 1 : 0;
            const B = b ? 1 : 0;
            const C = c ? 1 : 0;
            const D = d ? 1 : 0;
            
            // Calculate each term
            const term1 = A && !B;        // AB'
            const term2 = A && B && C;    // ABC
            const term3 = A && B && !D;   // ABD'
            const term4 = !A && !C && !D; // A'C'D'
            const term5 = !A && B && !C;  // A'BC'
            
            // OR all terms together
            return (term1 || term2 || term3 || term4 || term5) ? 1 : 0;
        }
        
        function updateFunctionFSimulator() {
            const a = document.getElementById('funcFA').checked ? 1 : 0;
            const b = document.getElementById('funcFB').checked ? 1 : 0;
            const c = document.getElementById('funcFC').checked ? 1 : 0;
            const d = document.getElementById('funcFD').checked ? 1 : 0;
            
            const inputValue = document.getElementById('funcFValue');
            const outputValue = document.getElementById('funcFOutput');
            const led = document.getElementById('funcFLed');
            
            // Update input display
            inputValue.textContent = `${a}${b}${c}${d}`;
            
            // Calculate output
            const result = evaluateFunctionF(a, b, c, d);
            
            // Update output display
            if (result) {
                outputValue.textContent = '1 (HIGH)';
                outputValue.style.color = '#2ecc71';
                led.classList.add('active');
                led.setAttribute('aria-label', 'Function F Output LED is ON');
            } else {
                outputValue.textContent = '0 (LOW)';
                outputValue.style.color = '#e74c3c';
                led.classList.remove('active');
                led.setAttribute('aria-label', 'Function F Output LED is OFF');
            }
        }
        
        function updateFunctionHSimulator() {
            const a = document.getElementById('funcHA').checked ? 1 : 0;
            const b = document.getElementById('funcHB').checked ? 1 : 0;
            const c = document.getElementById('funcHC').checked ? 1 : 0;
            const d = document.getElementById('funcHD').checked ? 1 : 0;
            
            const inputValue = document.getElementById('funcHValue');
            const outputValue = document.getElementById('funcHOutput');
            const led = document.getElementById('funcHLed');
            
            // Update input display
            inputValue.textContent = `${a}${b}${c}${d}`;
            
            // Calculate output
            const result = evaluateFunctionH(a, b, c, d);
            
            // Update output display
            if (result) {
                outputValue.textContent = '1 (HIGH)';
                outputValue.style.color = '#2ecc71';
                led.classList.add('active');
                led.setAttribute('aria-label', 'Function H Output LED is ON');
            } else {
                outputValue.textContent = '0 (LOW)';
                outputValue.style.color = '#e74c3c';
                led.classList.remove('active');
                led.setAttribute('aria-label', 'Function H Output LED is OFF');
            }
        }
        
        // Initialize Lab 6 Function Simulators
        document.addEventListener('DOMContentLoaded', function() {
            // Function F Simulator
            const funcFInputs = ['funcFA', 'funcFB', 'funcFC', 'funcFD'];
            funcFInputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('change', updateFunctionFSimulator);
                }
            });
            
            // Function H Simulator
            const funcHInputs = ['funcHA', 'funcHB', 'funcHC', 'funcHD'];
            funcHInputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('change', updateFunctionHSimulator);
                }
            });
            
            // Initialize both simulators
            updateFunctionFSimulator();
            updateFunctionHSimulator();
        });
 

        // Interactive Truth Table Logic for Lab 5
        function evaluateLab5X(a, b, c, d) {
            // X = 1 if majority of inputs (A, B, C, D) is 1, otherwise 0
            a = Number(a); b = Number(b); c = Number(c); d = Number(d);
            const sum = a + b + c + d;
            return sum >= 3 ? 1 : 0; // Majority is 3 or more 1s
        }

        // Interactive Truth Table Logic
        function evaluateLogicGate(gate, a, b) {
            a = Number(a); b = Number(b);
            switch (gate) {
            case "AND": return a & b;
            case "OR": return a | b;
            case "NAND": return !(a & b) ? 1 : 0;
            case "NOR": return !(a | b) ? 1 : 0;
            case "XOR": return a ^ b;
            case "XNOR": return (a ^ b) ? 0 : 1;
            }
        }
        function clearFieldStyle(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        document.addEventListener('DOMContentLoaded', function() {
            // Keyboard: only allow 0/1
            document.querySelectorAll('.output-field').forEach(input => {
            input.addEventListener('input', function(e) {
                let v = input.value;
                if (v !== '0' && v !== '1') input.value = '';
                clearFieldStyle(input);
            });
            input.addEventListener('focus', function() {
                input.select();
            });
            input.addEventListener('keydown', function(e) {
                handleTruthTableNavigation(e, '.output-field', true); // true for 2D navigation
            });
            });
            document.getElementById('check-answers-btn').addEventListener('click', () => {
            document.querySelectorAll('.output-field').forEach(input => {
                const { gate, a, b } = input.dataset;
                const correct = evaluateLogicGate(gate, a, b);
                if (input.value === '') {
                input.style.backgroundColor = '#cce5ff'; // Light blue
                input.style.color = '#222';
                input.value = correct;
                input.classList.add('empty');
                input.classList.remove('correct','incorrect');
                } else if (parseInt(input.value) === correct) {
                input.style.backgroundColor = '#d4edda'; // Green
                input.style.color = '#155724';
                input.classList.add('correct');
                input.classList.remove('incorrect','empty');
                } else {
                input.style.backgroundColor = '#f8d7da'; // Red
                input.style.color = '#721c24';
                input.value = correct;
                input.classList.add('incorrect');
                input.classList.remove('correct','empty');
                }
            });
            });
            document.getElementById('clear-table-btn').addEventListener('click', () => {
            document.querySelectorAll('.output-field').forEach(input => {
                input.value = '';
                clearFieldStyle(input);
            });
            });
        });
        
        // Lab 11 Counter Truth Table Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            const lab11Inputs = document.querySelectorAll('.output-field-lab11');
    
            
            lab11Inputs.forEach(input => {

                
                input.addEventListener('input', function(e) {
                    let v = input.value.toUpperCase();
                    if (v !== '0' && v !== '1' && v !== 'X') {
                        input.value = '';
                    } else {
                        input.value = v;
                    }
                    clearFieldStyleLab11(input);
                });
                
                input.addEventListener('focus', function() {
                    input.select();
                });
                
                // Backup keypress handler for better input support
                input.addEventListener('keypress', function(e) {
                    const key = e.key.toUpperCase();
                    if (key === '0' || key === '1' || key === 'X') {
                        // Allow the key to be processed
                        return true;
                    } else {
                        // Prevent non-valid keys
                        e.preventDefault();
                        return false;
                    }
                });
                
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab11', true); // true for 2D navigation
                });
            });
            
            document.getElementById('check-answers-btn-lab11').addEventListener('click', () => {
                document.querySelectorAll('.output-field-lab11').forEach(input => {
                    const row = parseInt(input.dataset.row);
                    const col = parseInt(input.dataset.col);
                    const correct = getLab11Answer(row, col);
                    
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct','incorrect');
                    } else if (input.value.toUpperCase() === correct.toString()) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect','empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct','empty');
                    }
                });
            });
            
            document.getElementById('clear-table-btn-lab11').addEventListener('click', () => {
                document.querySelectorAll('.output-field-lab11').forEach(input => {
                    input.value = '';
                    clearFieldStyleLab11(input);
                });
            });
            
            // Lab 11 K-Map Event Listeners
            const kmapIds = ['ja', 'ka', 'jb', 'kb', 'jc', 'kc'];
            
            kmapIds.forEach(id => {
                // Fill K-Map button
                document.getElementById(`fill-kmap-btn-lab11-${id}`).addEventListener('click', () => {
                    fillKMapWithCorrectValuesLab11(`k-map-lab11-${id}`);
                });
                
                // Clear K-Map button
                document.getElementById(`clear-kmap-btn-lab11-${id}`).addEventListener('click', () => {
                    clearKMapLab11(`k-map-lab11-${id}`);
                });
                
                // Input validation
                const kMap = document.getElementById(`k-map-lab11-${id}`);
                const inputs = kMap.querySelectorAll('.k-map-input');
                inputs.forEach(input => {
                    input.addEventListener('input', () => {
                        validateKMapInputStrict(input);
                    });
                    
                    input.addEventListener('focus', () => {
                        input.select();
                    });
                    
                    // Add keyboard navigation
                    input.addEventListener('keydown', (e) => {
                        handleKMapNavigation(e, `k-map-lab11-${id}`);
                    });
                    
                    // Prevent invalid characters on keypress
                    input.addEventListener('keypress', (e) => {
                        const char = String.fromCharCode(e.charCode);
                        if (!/^[01Xx]$/.test(char)) {
                            e.preventDefault();
                        }
                    });
                });
                
                // Rich text editor functionality
                const editor = document.getElementById(`kmap-simplification-editor-lab11-${id}`);
                const toolbar = document.getElementById(`lab11-${id}-editor-toolbar`);
                
                if (editor && toolbar) {
                    // Initialize editor state
                    initializeLab11EditorState(id);
                    
                    // Initialize enhanced toolbar functionality
                    toolbar.addEventListener('click', function(e) {
                        // Find the closest toolbar button (handles event delegation)
                        const button = e.target.closest('.toolbar-btn');
                        if (button) {
                            e.preventDefault();
                            const command = button.dataset.command;
                            const text = button.dataset.text;
                            
                            // Ensure editor has focus for command execution
                            if (document.activeElement !== editor) {
                                editor.focus();
                            }
                            
                            // Handle special commands using enhanced function
                            if (command === 'insertText' && text) {
                                executeCommandLab11('insertText', text);
                            } else if (command === 'undo') {
                                executeCommandLab11('undo');
                            } else if (command === 'redo') {
                                executeCommandLab11('redo');
                            } else if (command === 'selectAll') {
                                executeCommandLab11('selectAll');
                            } else if (command === 'removeFormat') {
                                executeCommandLab11('removeFormat');
                            } else if (command === 'justifyLeft' || command === 'justifyCenter' || command === 'justifyRight') {
                                executeCommandLab11(command);
                            } else {
                                executeCommandLab11(command);
                            }
                            
                            // Handle active states for toggle buttons (NOT mutually exclusive)
                            if (['bold', 'italic', 'superscript'].includes(command)) {
                                // Toggle active state for the clicked button only
                                button.classList.toggle('active');
                                
                                // Save the updated state immediately
                                saveLab11EditorState(id);
                            }
                            
                            // Sync button states after command execution
                            setTimeout(() => syncButtonStatesLab11(id), 10);
                        }
                    });
                    
                    // Enhanced event handling for button state synchronization
                    let syncTimeout;
                    
                    // Debounced sync function to prevent excessive calls
                    function debouncedSync() {
                        clearTimeout(syncTimeout);
                        syncTimeout = setTimeout(() => syncButtonStatesLab11(id), 50);
                    }
                    
                    // Core events that need immediate sync
                    editor.addEventListener('input', function() {
                        debouncedSync();
                    });
                    
                    editor.addEventListener('focus', function() {
                        // Restore saved states when editor gains focus
                        restoreLab11EditorState(id);
                        // Then sync with current content state
                        setTimeout(() => syncButtonStatesLab11(id), 10);
                    });
                    
                    editor.addEventListener('blur', function() {
                        // Save current states when editor loses focus
                        saveLab11EditorState(id);
                    });
                    
                    // Selection and navigation events
                    editor.addEventListener('selectionchange', function() {
                        debouncedSync();
                    });
                    
                    editor.addEventListener('mouseup', function() {
                        debouncedSync();
                    });
                    
                    // Content modification events
                    editor.addEventListener('paste', function() {
                        setTimeout(() => syncButtonStatesLab11(id), 10);
                    });
                    
                    editor.addEventListener('drop', function() {
                        setTimeout(() => syncButtonStatesLab11(id), 10);
                    });
                }
            });
            
            // Initialize Lab 11 K-Map modals after setting up all event listeners
            initializeLab11KMapModals();
            
            // Initialize all Lab 11 editor states
            const modalIds = ['ja', 'ka', 'jb', 'kb', 'jc', 'kc'];
            modalIds.forEach(id => {
                initializeLab11EditorState(id);
            });
        });

        // Modern Logic Gate Simulator for Lab 2
        (function() {
            const gateBtns = document.querySelectorAll('.simulator-container .gate-btn');
            const inputA = document.getElementById('simInputA');
            const inputB = document.getElementById('simInputB');
            const led = document.getElementById('simLed');
            const outputValue = document.getElementById('simOutputValue');
            const gateLabel = document.getElementById('simGateLabel');
            let currentGate = 'and';
            function evalGate(gate, a, b) {
            switch(gate) {
                case 'and': return a & b;
                case 'or': return a | b;
                case 'nand': return !(a & b) ? 1 : 0;
                case 'nor': return !(a | b) ? 1 : 0;
                case 'xor': return a ^ b;
                case 'xnor': return (a ^ b) ? 0 : 1;
            }
            }
            function updateSim() {
            const a = inputA.checked ? 1 : 0;
            const b = inputB.checked ? 1 : 0;
            const result = evalGate(currentGate, a, b);
            if (result) {
                led.classList.add('active');
                led.setAttribute('aria-label', 'Output LED is ON');
                outputValue.textContent = '1 (HIGH)';
                outputValue.style.color = '#2ecc71';
            } else {
                led.classList.remove('active');
                led.setAttribute('aria-label', 'Output LED is OFF');
                outputValue.textContent = '0 (LOW)';
                outputValue.style.color = '#e74c3c';
            }
            gateLabel.textContent = 'Gate: ' + currentGate.toUpperCase();
            }
            gateBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                gateBtns.forEach(b => {
                b.classList.remove('active');
                b.setAttribute('aria-pressed', 'false');
                });
                this.classList.add('active');
                this.setAttribute('aria-pressed', 'true');
                currentGate = this.getAttribute('data-gate');
                updateSim();
            });
            });
            [inputA, inputB].forEach(input => {
            input.addEventListener('change', updateSim);
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                input.checked = !input.checked;
                updateSim();
                }
            });
            });
            updateSim();
        })();

        // Enhanced Lab 11 Text Editor Helper Functions
        
        // Global State Management for Lab 11 Text Editors
        const lab11EditorStates = new Map();
        
        // Initialize state for a specific editor
        function initializeLab11EditorState(id) {
            if (!lab11EditorStates.has(id)) {
                lab11EditorStates.set(id, {
                    bold: false,
                    italic: false,
                    superscript: false,
                    lastContent: '',
                    lastSelection: null
                });
        
            }
        }
        
        // Save current state for an editor
        function saveLab11EditorState(id) {
            const editor = document.getElementById(`kmap-simplification-editor-lab11-${id}`);
            const toolbar = document.getElementById(`lab11-${id}-editor-toolbar`);
            
            if (!editor || !toolbar) return;
            
            const state = lab11EditorStates.get(id) || {};
            
            // Save button states
            const boldBtn = toolbar.querySelector('[data-command="bold"]');
            const italicBtn = toolbar.querySelector('[data-command="italic"]');
            const superscriptBtn = toolbar.querySelector('[data-command="superscript"]');
            
            state.bold = boldBtn ? boldBtn.classList.contains('active') : false;
            state.italic = italicBtn ? italicBtn.classList.contains('active') : false;
            state.superscript = superscriptBtn ? superscriptBtn.classList.contains('active') : false;
            
            // Save content and selection
            state.lastContent = editor.innerHTML;
            if (window.getSelection && window.getSelection().rangeCount > 0) {
                state.lastSelection = window.getSelection().getRangeAt(0);
            }
            
            lab11EditorStates.set(id, state);
        }
        
        // Restore state for an editor
        function restoreLab11EditorState(id) {
            const editor = document.getElementById(`kmap-simplification-editor-lab11-${id}`);
            const toolbar = document.getElementById(`lab11-${id}-editor-toolbar`);
            
            if (!editor || !toolbar) return;
            
            const state = lab11EditorStates.get(id);
            if (!state) return;
            
            // Restore button states
            const boldBtn = toolbar.querySelector('[data-command="bold"]');
            const italicBtn = toolbar.querySelector('[data-command="italic"]');
            const superscriptBtn = toolbar.querySelector('[data-command="superscript"]');
            
            if (boldBtn) {
                if (state.bold) boldBtn.classList.add('active');
                else boldBtn.classList.remove('active');
            }
            
            if (italicBtn) {
                if (state.italic) italicBtn.classList.add('active');
                else italicBtn.classList.remove('active');
            }
            
            if (superscriptBtn) {
                if (state.superscript) superscriptBtn.classList.add('active');
                else superscriptBtn.classList.remove('active');
            }
            

        }
        
        function syncButtonStatesLab11(id) {
            const toolbar = document.getElementById(`lab11-${id}-editor-toolbar`);
            const editor = document.getElementById(`kmap-simplification-editor-lab11-${id}`);
            
            if (!toolbar || !editor) return;
            
            try {
                // Initialize editor state if not exists
                initializeLab11EditorState(id);
                
                // Get current state
                const state = lab11EditorStates.get(id);
                if (!state) return;
                
                // Check if editor has focus
                const isEditorFocused = document.activeElement === editor;
                
                if (isEditorFocused) {
                    // Update states based on document.queryCommandState for real-time accuracy
                    const boldBtn = toolbar.querySelector('[data-command="bold"]');
                    const italicBtn = toolbar.querySelector('[data-command="italic"]');
                    const superscriptBtn = toolbar.querySelector('[data-command="superscript"]');
                    
                    // Update button states based on actual command state
                    if (boldBtn) {
                        const isBold = document.queryCommandState('bold');
                        if (isBold) {
                            boldBtn.classList.add('active');
                            state.bold = true;
                        } else {
                            boldBtn.classList.remove('active');
                            state.bold = false;
                        }
                    }
                    
                    if (italicBtn) {
                        const isItalic = document.queryCommandState('italic');
                        if (isItalic) {
                            italicBtn.classList.add('active');
                            state.italic = true;
                        } else {
                            italicBtn.classList.remove('active');
                            state.italic = false;
                        }
                    }
                    
                    if (superscriptBtn) {
                        const isSuperscript = document.queryCommandState('superscript');
                        if (isSuperscript) {
                            superscriptBtn.classList.add('active');
                            state.superscript = true;
                        } else {
                            superscriptBtn.classList.remove('active');
                            state.superscript = false;
                        }
                    }
                    
                    // Save updated state
                    lab11EditorStates.set(id, state);
                } else {
                    // Editor not focused - restore saved states without clearing
                    restoreLab11EditorState(id);
                }
            } catch (error) {
                // Fallback: restore saved states if there's an error
                console.warn(`Error syncing button states for ${id}:`, error);
                restoreLab11EditorState(id);
            }
        }
        
        function executeCommandLab11(command, text = null) {
            try {
                if (command === 'insertText' && text) {
                    document.execCommand('insertText', false, text);
                } else {
                    document.execCommand(command, false, null);
                }
                return true;
            } catch (error) {
                console.warn(`Failed to execute command ${command}:`, error);
                return false;
            }
        }
        
        // Universal Keyboard Navigation for Truth Tables
        function handleTruthTableNavigation(event, inputSelector, is2D = false) {
            const inputs = Array.from(document.querySelectorAll(inputSelector));
            const currentIndex = inputs.indexOf(event.target);
            
            if (currentIndex === -1) return;
            
            if (is2D) {
                // Check if this is Lab 8 truth table (8 rows × 3 columns)
                if (inputSelector.includes('lab8-f1') || inputSelector.includes('lab8-f2') || inputSelector.includes('lab8-f3')) {
                    // Lab 8: 2D navigation (8 rows × 3 columns)
                    const columns = 3;
                    const rows = 8;
                    const currentRow = Math.floor(currentIndex / columns);
                    const currentCol = currentIndex % columns;
                    
                    if (event.key === 'ArrowUp' && currentRow > 0) {
                        event.preventDefault();
                        const targetIndex = (currentRow - 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowDown' && currentRow < rows - 1) {
                        event.preventDefault();
                        const targetIndex = (currentRow + 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowLeft' && currentCol > 0) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol - 1);
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowRight' && currentCol < columns - 1) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol + 1);
                        inputs[targetIndex].focus();
                    }
                } else if (inputSelector.includes('lab11')) {
                    // Lab 11: 2D navigation (7 rows × 6 columns)
                    const columns = 6;
                    const rows = 7;
                    const currentRow = Math.floor(currentIndex / columns);
                    const currentCol = currentIndex % columns;
                    
                    if (event.key === 'ArrowUp' && currentRow > 0) {
                        event.preventDefault();
                        const targetIndex = (currentRow - 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowDown' && currentRow < rows - 1) {
                        event.preventDefault();
                        const targetIndex = (currentRow + 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowLeft' && currentCol > 0) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol - 1);
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowRight' && currentCol < columns - 1) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol + 1);
                        inputs[targetIndex].focus();
                    }
                } else if (inputSelector.includes('lab9')) {
                    // Lab 9: Smart navigation with F-to-MUX and MUX-to-F logic
                    event.preventDefault();
                    
                    const currentInput = event.target;
                    const isMuxInput = currentInput.classList.contains('mux-input-field-lab9');
                    const isFInput = currentInput.classList.contains('output-field-lab9');
                    
                    if (isFInput) {
                        // Navigation from F column
                        const { a, b, c, d } = currentInput.dataset;
                        const currentRow = parseInt(a) * 8 + parseInt(b) * 4 + parseInt(c) * 2 + parseInt(d);
                        
                        if (event.key === 'ArrowUp' && currentRow > 0) {
                            // Move to previous row in F column
                            const prevRow = currentRow - 1;
                            const prevA = Math.floor(prevRow / 8);
                            const prevB = Math.floor((prevRow % 8) / 4);
                            const prevC = Math.floor((prevRow % 4) / 2);
                            const prevD = prevRow % 2;
                            const prevInput = document.querySelector(`.output-field-lab9[data-a="${prevA}"][data-b="${prevB}"][data-c="${prevC}"][data-d="${prevD}"]`);
                            if (prevInput) prevInput.focus();
                        } else if (event.key === 'ArrowDown' && currentRow < 15) {
                            // Move to next row in F column
                            const nextRow = currentRow + 1;
                            const nextA = Math.floor(nextRow / 8);
                            const nextB = Math.floor((nextRow % 8) / 4);
                            const nextC = Math.floor((nextRow % 4) / 2);
                            const nextD = nextRow % 2;
                            const nextInput = document.querySelector(`.output-field-lab9[data-a="${nextA}"][data-b="${nextB}"][data-c="${nextC}"][data-d="${nextD}"]`);
                            if (nextInput) nextInput.focus();
                        } else if (event.key === 'ArrowRight') {
                            // Move to associated MUX input cell
                            const abc = `${a}${b}${c}`;
                            const muxInput = document.querySelector(`.mux-input-field-lab9[data-abc="${abc}"]`);
                            if (muxInput) muxInput.focus();
                        }
                    } else if (isMuxInput) {
                        // Navigation from MUX input column
                        const { abc } = currentInput.dataset;
                        const abcNum = parseInt(abc, 2);
                        const a = Math.floor(abcNum / 4);
                        const b = Math.floor((abcNum % 4) / 2);
                        const c = abcNum % 2;
                        
                        if (event.key === 'ArrowLeft') {
                            // Move to first associated F input cell (D=0)
                            const fInput = document.querySelector(`.output-field-lab9[data-a="${a}"][data-b="${b}"][data-c="${c}"][data-d="0"]`);
                            if (fInput) fInput.focus();
                        } else if (event.key === 'ArrowUp') {
                            // Move to previous MUX input cell
                            if (abcNum > 0) {
                                const prevAbc = (abcNum - 1).toString(2).padStart(3, '0');
                                const prevMuxInput = document.querySelector(`.mux-input-field-lab9[data-abc="${prevAbc}"]`);
                                if (prevMuxInput) prevMuxInput.focus();
                            }
                        } else if (event.key === 'ArrowDown') {
                            // Move to next MUX input cell
                            if (abcNum < 7) {
                                const nextAbc = (abcNum + 1).toString(2).padStart(3, '0');
                                const nextMuxInput = document.querySelector(`.mux-input-field-lab9[data-abc="${nextAbc}"]`);
                                if (nextMuxInput) nextMuxInput.focus();
                            }
                        }
                    }
                } else {
                    // Lab 2: 2D navigation (4 rows × 6 columns)
                    const columns = 6;
                    const rows = 4;
                    const currentRow = Math.floor(currentIndex / columns);
                    const currentCol = currentIndex % columns;
                    
                    if (event.key === 'ArrowUp' && currentRow > 0) {
                        event.preventDefault();
                        const targetIndex = (currentRow - 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowDown' && currentRow < rows - 1) {
                        event.preventDefault();
                        const targetIndex = (currentRow + 1) * columns + currentCol;
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowLeft' && currentCol > 0) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol - 1);
                        inputs[targetIndex].focus();
                    } else if (event.key === 'ArrowRight' && currentCol < columns - 1) {
                        event.preventDefault();
                        const targetIndex = currentRow * columns + (currentCol + 1);
                        inputs[targetIndex].focus();
                    }
                }
            } else {
                // Labs 3, 4, 5: 1D navigation (up/down only)
                if (event.key === 'ArrowUp' && currentIndex > 0) {
                    event.preventDefault();
                    inputs[currentIndex - 1].focus();
                } else if (event.key === 'ArrowDown' && currentIndex < inputs.length - 1) {
                    event.preventDefault();
                    inputs[currentIndex + 1].focus();
                }
            }
        }

        // Interactive Truth Table Logic for Lab 3
        function evaluateLab3F(x, y, z) {
            // F = X' + X·Y + X·Z' + X·(Y·Z)'
            // This function is a tautology (always 1)
            x = Number(x); y = Number(y); z = Number(z);
            return 1; // F is always 1 regardless of X, Y, Z values
        }
        function clearFieldStyleLab3(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.output-field-lab3').forEach(input => {
            input.addEventListener('input', function(e) {
                let v = input.value;
                if (v !== '0' && v !== '1') input.value = '';
                clearFieldStyleLab3(input);
            });
            input.addEventListener('focus', function() {
                input.select();
            });
            input.addEventListener('keydown', function(e) {
                handleTruthTableNavigation(e, '.output-field-lab3', false); // false for 1D navigation
            });
            });
            document.getElementById('check-answers-btn-lab3').addEventListener('click', () => {
            document.querySelectorAll('.output-field-lab3').forEach(input => {
                const { x, y, z } = input.dataset;
                const correct = evaluateLab3F(x, y, z);
                if (input.value === '') {
                input.style.backgroundColor = '#cce5ff';
                input.style.color = '#222';
                input.value = correct;
                input.classList.add('empty');
                input.classList.remove('correct','incorrect');
                } else if (parseInt(input.value) === correct) {
                input.style.backgroundColor = '#d4edda';
                input.style.color = '#155724';
                input.classList.add('correct');
                input.classList.remove('incorrect','empty');
                } else {
                input.style.backgroundColor = '#f8d7da';
                input.style.color = '#721c24';
                input.value = correct;
                input.classList.add('incorrect');
                input.classList.remove('correct','empty');
                }
            });
            });
            document.getElementById('clear-table-btn-lab3').addEventListener('click', () => {
            document.querySelectorAll('.output-field-lab3').forEach(input => {
                input.value = '';
                clearFieldStyleLab3(input);
            });
            });
        });

        // Interactive Truth Table Logic for Lab 4
        function evaluateLab4F(a, b, c, d) {
            // F = (A'+C)(A'+C')(A+B+C'D)
            a = Number(a); b = Number(b); c = Number(c); d = Number(d);
            return ((!a || c) && (!a || !c) && (a || b || (!c && d))) ? 1 : 0;
        }
        function clearFieldStyleLab4(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.output-field-lab4').forEach(input => {
            input.addEventListener('input', function(e) {
                let v = input.value;
                if (v !== '0' && v !== '1') input.value = '';
                clearFieldStyleLab4(input);
            });
            input.addEventListener('focus', function() {
                input.select();
            });
            input.addEventListener('keydown', function(e) {
                handleTruthTableNavigation(e, '.output-field-lab4', false); // false for 1D navigation
            });
            });
            document.getElementById('check-answers-btn-lab4').addEventListener('click', () => {
            document.querySelectorAll('.output-field-lab4').forEach(input => {
                const { a, b, c, d } = input.dataset;
                const correct = evaluateLab4F(a, b, c, d);
                if (input.value === '') {
                input.style.backgroundColor = '#cce5ff';
                input.style.color = '#222';
                input.value = correct;
                input.classList.add('empty');
                input.classList.remove('correct','incorrect');
                } else if (parseInt(input.value) === correct) {
                input.style.backgroundColor = '#d4edda';
                input.style.color = '#155724';
                input.classList.add('correct');
                input.classList.remove('incorrect','empty');
                } else {
                input.style.backgroundColor = '#f8d7da';
                input.style.color = '#721c24';
                input.value = correct;
                input.classList.add('incorrect');
                input.classList.remove('correct','empty');
                }
            });
            });
            document.getElementById('clear-table-btn-lab4').addEventListener('click', () => {
            document.querySelectorAll('.output-field-lab4').forEach(input => {
                input.value = '';
                clearFieldStyleLab4(input);
            });
            });
        });
        
        // Lab 5 Truth Table Logic
        function clearFieldStyleLab5(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        
        // Lab 11 Counter Truth Table Logic
        function clearFieldStyleLab11(input) {
            input.style.backgroundColor = '';
            input.style.color = '';
            input.classList.remove('correct','incorrect','empty');
        }
        
        // Lab 11 K-Map Functions
        function fillKMapWithCorrectValuesLab11(kmapId) {
            const kMap = document.getElementById(kmapId);
            const inputs = kMap.querySelectorAll('.k-map-input');
            
            // Get correct values based on kmapId
            let correctValues = [];
            switch(kmapId) {
                case 'k-map-lab11-ja':
                    correctValues = [0, 0, 1, 0, 'X', 'X', 'X', 'X']; // JA values
                    break;
                case 'k-map-lab11-ka':
                    correctValues = ['X', 'X', 'X', 'X', 0, 0, 'X', 1]; // KA values
                    break;
                case 'k-map-lab11-jb':
                    correctValues = [0, 1, 'X', 'X', 0, 1, 'X', 'X']; // JB values
                    break;
                case 'k-map-lab11-kb':
                    correctValues = ['X', 'X', 1, 0, 'X', 'X', 'X', 1]; // KB values
                    break;
                case 'k-map-lab11-jc':
                    correctValues = [1, 'X', 'X', 1, 1, 'X', 'X', 0]; // JC values
                    break;
                case 'k-map-lab11-kc':
                    correctValues = ['X', 1, 1, 'X', 'X', 1, 'X', 'X']; // KC values
                    break;
            }
            
            inputs.forEach((input, index) => {
                const correctValue = correctValues[index];
                const userValue = input.value.trim();
                
                // Clear previous styling
                input.classList.remove('correct', 'incorrect', 'empty');
                
                if (userValue === '') {
                    // Empty cell - show blue highlight
                    input.classList.add('empty');
                    input.value = correctValue;
                } else if (userValue === correctValue.toString()) {
                    // Correct answer - show green highlight
                    input.classList.add('correct');
                } else {
                    // Wrong answer - show red highlight
                    input.classList.add('incorrect');
                    input.value = correctValue;
                }
            });
        }
        
        function clearKMapLab11(kmapId) {
            const kMap = document.getElementById(kmapId);
            const inputs = kMap.querySelectorAll('.k-map-input');
            inputs.forEach(input => {
                input.value = '';
                input.classList.remove('correct', 'incorrect', 'empty');
            });
        }
        
        function validateKMapInputLab11(input) {
            const value = input.value;
            if (value === '' || value === '0' || value === '1' || value === 'X' || value === 'x') {
                input.classList.remove('invalid');
                if (value === 'x') input.value = 'X';
                return true;
            } else {
                input.classList.add('invalid');
                return false;
            }
        }
        
        // Enhanced input validation for Lab 11 K-maps
        function validateKMapInputStrict(input) {
            const value = input.value.trim();
            if (value === '' || value === '0' || value === '1' || value === 'X' || value === 'x') {
                input.classList.remove('invalid');
                if (value === 'x') input.value = 'X';
                return true;
            } else {
                input.classList.add('invalid');
                // Remove invalid characters
                input.value = input.value.replace(/[^01Xx]/g, '');
                return false;
            }
        }
        
        // Keyboard navigation for Lab 11 K-maps
        function handleKMapNavigation(e, kmapId) {
            const kMap = document.getElementById(kmapId);
            const inputs = Array.from(kMap.querySelectorAll('.k-map-input'));
            const currentInput = e.target;
            const currentIndex = inputs.indexOf(currentInput);
            
            if (currentIndex === -1) return;
            
            let nextIndex = -1;
            
            switch(e.key) {
                case 'ArrowUp':
                    if (currentIndex >= 4) { // Not in first row
                        nextIndex = currentIndex - 4;
                    }
                    break;
                case 'ArrowDown':
                    if (currentIndex < 4) { // Not in last row
                        nextIndex = currentIndex + 4;
                    }
                    break;
                case 'ArrowLeft':
                    if (currentIndex % 4 !== 0) { // Not in first column
                        nextIndex = currentIndex - 1;
                    }
                    break;
                case 'ArrowRight':
                    if (currentIndex % 4 !== 3) { // Not in last column
                        nextIndex = currentIndex + 1;
                    }
                    break;
            }
            
            if (nextIndex >= 0 && nextIndex < inputs.length) {
                e.preventDefault();
                inputs[nextIndex].focus();
                inputs[nextIndex].select();
            }
        }
        
        // MOD-7 Counter Truth Table Answers
        function getLab11Answer(row, col) {
            // Answers based on MOD-7 counter design with JK flip-flops
            // Row: 0=000, 1=001, 2=010, 3=011, 4=100, 5=101, 6=110
            // Col: 0=JA, 1=KA, 2=JB, 3=KB, 4=JC, 5=KC
            // X represents "don't care" (can be 0 or 1)
            const answers = [
                // State 000 (0) -> 001 (1)
                [0, 'X', 0, 'X', 1, 'X'], // JA=0, KA=X, JB=0, KB=X, JC=1, KC=X
                // State 001 (1) -> 010 (2)
                [0, 'X', 1, 'X', 'X', 1], // JA=0, KA=X, JB=1, KB=X, JC=X, KC=1
                // State 010 (2) -> 011 (3)
                [0, 'X', 'X', 0, 1, 'X'], // JA=0, KA=X, JB=X, KB=1, JC=1, KC=X
                // State 011 (3) -> 100 (4)
                [1, 'X', 'X', 1, 'X', 1], // JA=1, KA=X, JB=X, KB=0, JC=X, KC=1
                // State 100 (4) -> 101 (5)
                ['X', 0, 0, 'X', 1, 'X'], // JA=X, KA=1, JB=0, KB=X, JC=1, KC=X
                // State 101 (5) -> 110 (6)
                ['X', 0, 1, 'X', 'X', 1], // JA=0, KA=1, JB=1, KB=X, JC=X, KC=1
                // State 110 (6) -> 000 (0)
                ['X', 1, 'X', 1, 0, 'X']  // JA=X, KA=1, JB=X, KB=1, JC=0, KC=X
            ];
            return answers[row][col];
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.output-field-lab5').forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value;
                    if (v !== '0' && v !== '1') input.value = '';
                    clearFieldStyleLab5(input);
                });
                input.addEventListener('focus', function() {
                    input.select();
                });
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab5', false); // false for 1D navigation
                });
            });
            
            document.getElementById('check-answers-btn-lab5').addEventListener('click', () => {
                document.querySelectorAll('.output-field-lab5').forEach(input => {
                    const { a, b, c, d } = input.dataset;
                    const correct = evaluateLab5X(a, b, c, d);
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct','incorrect');
                    } else if (parseInt(input.value) === correct) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect','empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct','empty');
                    }
                });
            });
            
            document.getElementById('clear-table-btn-lab5').addEventListener('click', () => {
                document.querySelectorAll('.output-field-lab5').forEach(input => {
                    input.value = '';
                    clearFieldStyleLab5(input);
            });
            });
        });


        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        function setTheme(mode) {
            if (mode === 'light') {
                document.body.classList.add('light-mode');
                themeToggle.classList.add('sun');
                themeToggle.classList.remove('moon');
                // Only update the icon's content and class, do not replace the button or span
                themeIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 2.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0112 2.25zm0 16.5a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm9-6.75a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5a.75.75 0 01.75.75zm-16.5 0a.75.75 0 01-.75.75H2.25a.75.75 0 010-1.5h1.5a.75.75 0 01.75.75zm12.72-5.47a.75.75 0 011.06 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06zm-9.19 9.19a.75.75 0 011.06 1.06l-1.06 1.06a.75.75 0 11-1.06-1.06l1.06-1.06zm12.02 1.06a.75.75 0 10-1.06-1.06l-1.06 1.06a.75.75 0 101.06 1.06l1.06-1.06zm-9.19-9.19a.75.75 0 10-1.06-1.06l-1.06 1.06a.75.75 0 101.06 1.06l1.06-1.06zM12 6.75a5.25 5.25 0 100 10.5 5.25 5.25 0 000-10.5z"/></svg>`;
                themeIcon.classList.remove('toggled');
            } else {
                document.body.classList.remove('light-mode');
                themeToggle.classList.add('moon');
                themeToggle.classList.remove('sun');
                // Only update the icon's content and class, do not replace the button or span
                themeIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z"/></svg>`;
                themeIcon.classList.add('toggled');
            }
            localStorage.setItem('theme', mode);
        }
        themeToggle.addEventListener('click', () => {
            const isLight = document.body.classList.contains('light-mode');
            setTheme(isLight ? 'dark' : 'light');
        });
        // On load, set theme
        const savedTheme = localStorage.getItem('theme');
        setTheme(savedTheme ? savedTheme : (prefersDark ? 'dark' : 'light'));
        
        // Lab navigation and TOC dropdown logic
        const sidebarHamburger = document.getElementById('sidebarHamburger');
        const tocDropdown = document.getElementById('tocDropdown');
        const tocClose = document.getElementById('tocClose');
        const labLinks = document.querySelectorAll('.lab-link');
        const labSections = document.querySelectorAll('.lab-section');
        
        function isDropdownOpen() {
            return tocDropdown.classList.contains('open');
        }
        function toggleTocDropdown() {
            if (isDropdownOpen()) {
                closeTocDropdown();
            } else {
                openTocDropdown();
            }
        }
        sidebarHamburger.addEventListener('click', function(e) {
            e.preventDefault();
            toggleTocDropdown();
        });
        tocClose.addEventListener('click', closeTocDropdown);
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isDropdownOpen()) closeTocDropdown();
        });
        // Also allow Enter/Space on hamburger for accessibility
        sidebarHamburger.addEventListener('keydown', function(e) {
            if ((e.key === 'Enter' || e.key === ' ') && !e.repeat) {
                e.preventDefault();
                toggleTocDropdown();
            }
        });
        // Trap focus inside dropdown
        let lastFocused;
        let scrollY = 0;
        tocDropdown.addEventListener('focusin', function(e) {
            lastFocused = e.target;
        });
        tocDropdown.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                const focusable = tocDropdown.querySelectorAll('a,button');
                const first = focusable[0];
                const last = focusable[focusable.length - 1];
                if (e.shiftKey && document.activeElement === first) {
                    e.preventDefault();
                    last.focus();
                } else if (!e.shiftKey && document.activeElement === last) {
                    e.preventDefault();
                    first.focus();
                }
            }
        });
        // Close dropdown when clicking a TOC link
        labLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault(); // Prevent default anchor jump
                closeTocDropdown();
                // Remove active class from all links
                labLinks.forEach(l => l.classList.remove('active'));
                // Add active class to clicked link
                this.classList.add('active');
                // Hide all lab sections
                labSections.forEach(section => {
                    section.classList.add('hidden');
                });
                // Show selected lab section
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                targetSection.classList.remove('hidden');
                // Smooth scroll to section top, offset by header height
                const header = document.querySelector('header');
                const headerOffset = header ? header.offsetHeight : 0;
                const sectionTop = targetSection.getBoundingClientRect().top + window.pageYOffset - headerOffset - 10;
                window.scrollTo({ top: sectionTop, behavior: 'smooth' });
            });
        });
        function openTocDropdown() {
            tocDropdown.style.display = 'block';
            setTimeout(() => tocDropdown.classList.add('open'), 10);
            // Remove scroll lock and body position manipulation
            // Dropdown overlays content, but page scroll remains unaffected
            tocDropdown.setAttribute('aria-modal', 'true');
            tocDropdown.setAttribute('tabindex', '-1');
            tocDropdown.focus();
        }
        function closeTocDropdown() {
            tocDropdown.classList.remove('open');
            setTimeout(() => {
                tocDropdown.style.display = 'none';
                // Remove scroll lock and body position manipulation
            }, 300);
        }
        

        
        // ===== LAB 1: LED & 7-Segment Simulator (7447 BCD to 7-segment emulation) =====
        // Note: Lab 1 uses IDs: ledA, ledB, ledC, ledD (completely separate from Lab 7)
        const ledA = document.getElementById('ledA');
        const ledB = document.getElementById('ledB');
        const ledC = document.getElementById('ledC');
        const ledD = document.getElementById('ledD');
        const ledAState = document.getElementById('ledAState');
        const ledBState = document.getElementById('ledBState');
        const ledCState = document.getElementById('ledCState');
        const ledDState = document.getElementById('ledDState');
        const switchesLab1 = [
            document.getElementById('switch1'),
            document.getElementById('switch2'),
            document.getElementById('switch3'),
            document.getElementById('switch4'),
        ];
        const sevenSegment = document.getElementById('sevenSegment');
        const binaryValue = document.getElementById('binaryValue');
        const decimalValue = document.getElementById('decimalValue');
        const segPolys = {
            a: document.getElementById('segA'),
            b: document.getElementById('segB'),
            c: document.getElementById('segC'),
            d: document.getElementById('segD'),
            e: document.getElementById('segE'),
            f: document.getElementById('segF'),
            g: document.getElementById('segG'),
        };
        // 7447 BCD to 7-segment (common cathode) truth table for 0-9
        const bcd7447Segments = [
            [1,1,1,1,1,1,0], // 0
            [0,1,1,0,0,0,0], // 1
            [1,1,0,1,1,0,1], // 2
            [1,1,1,1,0,0,1], // 3
            [0,1,1,0,0,1,1], // 4
            [1,0,1,1,0,1,1], // 5
            [1,0,1,1,1,1,1], // 6
            [1,1,1,0,0,0,0], // 7
            [1,1,1,1,1,1,1], // 8
            [1,1,1,1,0,1,1], // 9
        ];
        let lastSegVal = 0;
        function updateLab1Simulator() {
            if (!ledA || !ledB || !ledC || !ledD || !ledAState || !ledBState || !ledCState || !ledDState || !sevenSegment || !binaryValue || !decimalValue || !segPolys.a) return;
            const switchA = switchesLab1[0].checked;
            const switchB = switchesLab1[1].checked;
            const switchC = switchesLab1[2].checked;
            const switchD = switchesLab1[3].checked;
            // 4-bit input: ABCD
            const binVal = `${switchA ? '1' : '0'}${switchB ? '1' : '0'}${switchC ? '1' : '0'}${switchD ? '1' : '0'}`;
            const decVal = (switchA ? 8 : 0) + (switchB ? 4 : 0) + (switchC ? 2 : 0) + (switchD ? 1 : 0);
            // Individual LEDs and state labels
            [
                [ledA, ledAState, switchA],
                [ledB, ledBState, switchB],
                [ledC, ledCState, switchC],
                [ledD, ledDState, switchD],
            ].forEach(([led, label, state]) => {
                if (state) {
                    led.classList.add('active');
                    led.setAttribute('aria-label', 'LED is ON');
                    label.textContent = 'HIGH';
                    label.classList.add('high');
                    label.classList.remove('low');
                } else {
                    led.classList.remove('active');
                    led.setAttribute('aria-label', 'LED is OFF');
                    label.textContent = 'LOW';
                    label.classList.add('low');
                    label.classList.remove('high');
                }
            });
            // 7-segment SVG update (show only for 0-9, blank otherwise)
            const segs = (decVal >= 0 && decVal <= 9) ? bcd7447Segments[decVal] : [0,0,0,0,0,0,0];
            const segKeys = ['a','b','c','d','e','f','g'];
            const SEG_ON_COLOR = '#ff1744'; // bright red
            const SEG_OFF_COLOR = '#2a0000'; // dim red
            const SEG_ON_GLOW = 'drop-shadow(0 0 12px #ff1744)';
            segKeys.forEach((key, i) => {
                if (segs[i]) {
                    segPolys[key].setAttribute('fill', SEG_ON_COLOR);
                    segPolys[key].setAttribute('filter', SEG_ON_GLOW);
                } else {
                    segPolys[key].setAttribute('fill', SEG_OFF_COLOR);
                    segPolys[key].removeAttribute('filter');
                }
            });
            // Animate on change
            if (typeof lastSegVal !== 'undefined' && decVal !== lastSegVal) {
                sevenSegment.classList.add('animated');
                setTimeout(() => sevenSegment.classList.remove('animated'), 350);
            }
            lastSegVal = decVal;
            binaryValue.textContent = binVal;
            decimalValue.textContent = decVal;
        }
        switchesLab1.forEach(switchEl => {
            switchEl.addEventListener('change', updateLab1Simulator);
            switchEl.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    switchEl.checked = !switchEl.checked;
                    updateLab1Simulator();
                }
            });
        });
        updateLab1Simulator();
        
        // Lab 2: Logic Gate Simulator - Modern Implementation (Already working above)
        
        // Lab 3: Boolean Expression Simulator - Modern Implementation (Already working above)
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Lab 1 simulator
            updateLab1Simulator();
            
            // Lab 2 & 3 simulators are already initialized above
        });
        
        // Lab 8: Pre-lab Activity Text Editor Functionality
        function initializeLab8BooleanAlgebraEditor() {
    
            
            const editor = document.getElementById('simplification-editor-lab8');
            const toolbar = document.querySelector('#lab8 .editor-toolbar');
            const showAnswerBtn = document.getElementById('show-answer-btn-lab8');
            const booleanAlgebraModal = document.getElementById('booleanAlgebraModalLab8');
            const closeBooleanAlgebraModal = document.getElementById('closeBooleanAlgebraModalLab8');
            
            if (!editor || !toolbar || !showAnswerBtn || !booleanAlgebraModal || !closeBooleanAlgebraModal) {
                console.error('Lab 8 text editor elements not found');
                return;
            }
            
            // Ensure modal starts in correct state
            booleanAlgebraModal.setAttribute('aria-hidden', 'true');
            booleanAlgebraModal.removeAttribute('aria-modal');
            booleanAlgebraModal.classList.remove('show');
            
            // Initialize rich text editor functionality (same as Lab 3)
            let isEditorInitialized = false;
            
            function initializeEditor() {
                if (isEditorInitialized) return;
                
                // Set initial content
                editor.innerHTML = '';
                isEditorInitialized = true;

                
                // Initialize toolbar functionality
                initializeToolbar();
            }
            
            // Initialize toolbar functionality (same as Lab 3)
            function initializeToolbar() {
                toolbar.addEventListener('click', function(e) {
                    const button = e.target.closest('.toolbar-btn');
                    if (button) {
                        e.preventDefault();
                        const command = button.dataset.command;
                        const text = button.dataset.text;
                        
                        // Handle special commands
                        if (command === 'insertText' && text) {
                            document.execCommand('insertText', false, text);
                        } else if (command === 'undo') {
                            document.execCommand('undo', false, null);
                        } else if (command === 'redo') {
                            document.execCommand('redo', false, null);
                        } else if (command === 'selectAll') {
                            document.execCommand('selectAll', false, null);
                        } else if (command === 'removeFormat') {
                            document.execCommand('removeFormat', false, null);
                        } else if (command === 'justifyLeft' || command === 'justifyCenter' || command === 'justifyRight') {
                            document.execCommand(command, false, null);
                        } else {
                            document.execCommand(command, false, null);
                        }
                        
                        // Handle active states for toggle buttons
                        if (['bold', 'italic', 'underline', 'strikeThrough', 'subscript', 'superscript'].includes(command)) {
                            button.classList.toggle('active');
                        } else if (['justifyLeft', 'justifyCenter', 'justifyRight'].includes(command)) {
                            toolbar.querySelectorAll('[data-command^="justify"]').forEach(btn => btn.classList.remove('active'));
                            button.classList.add('active');
                        } else {
                            toolbar.querySelectorAll('.toolbar-btn').forEach(btn => btn.classList.remove('active'));
                        }
                        
                        // Focus back to editor
                        editor.focus();
                    }
                });
                
                // Keyboard shortcuts (same as Lab 3)
                editor.addEventListener('keydown', function(e) {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'b':
                                e.preventDefault();
                                document.execCommand('bold', false, null);
                                break;
                            case 'i':
                                e.preventDefault();
                                document.execCommand('italic', false, null);
                                break;
                            case 'u':
                                e.preventDefault();
                                document.execCommand('underline', false, null);
                                break;
                            case 's':
                                e.preventDefault();
                                document.execCommand('strikeThrough', false, null);
                                break;
                            case 'z':
                                if (e.shiftKey) {
                                    document.execCommand('redo', false, null);
                                } else {
                                    document.execCommand('undo', false, null);
                                }
                                break;
                            case 'y':
                                e.preventDefault();
                                document.execCommand('redo', false, null);
                                break;
                            case 'a':
                                e.preventDefault();
                                document.execCommand('selectAll', false, null);
                                break;
                        }
                    } else if (e.ctrlKey && e.shiftKey) {
                        switch(e.key) {
                            case 'S':
                                e.preventDefault();
                                document.execCommand('subscript', false, null);
                                break;
                            case 'P':
                                e.preventDefault();
                                document.execCommand('superscript', false, null);
                                break;
                            case 'L':
                                e.preventDefault();
                                document.execCommand('insertUnorderedList', false, null);
                                break;
                            case 'O':
                                e.preventDefault();
                                document.execCommand('insertOrderedList', false, null);
                                break;
                            case 'F':
                                e.preventDefault();
                                document.execCommand('removeFormat', false, null);
                                break;
                        }
                    }
                });
            }
            
            // Initialize editor when it becomes visible
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        initializeEditor();
                    }
                });
            });
            observer.observe(editor);
            
            // Modal functionality for Show Answer button
            showAnswerBtn.addEventListener('click', function() {
                // Capture user's answer from the text editor
                const userAnswerDisplay = document.getElementById('user-boolean-algebra-display-lab8');
                if (userAnswerDisplay && editor) {
                    const userAnswer = editor.innerHTML.trim();
                    if (userAnswer) {
                        userAnswerDisplay.innerHTML = userAnswer;
                    } else {
                        userAnswerDisplay.innerHTML = '<em>No answer provided yet.</em>';
                    }
                }
                
                // Show modal
                booleanAlgebraModal.classList.add('show');
                booleanAlgebraModal.setAttribute('aria-hidden', 'false');
                booleanAlgebraModal.setAttribute('aria-modal', 'true');
                document.body.style.overflow = 'hidden';
                
                // Focus the first focusable element in the modal for better accessibility
                const firstFocusableElement = booleanAlgebraModal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                if (firstFocusableElement) {
                    firstFocusableElement.focus();
                }
            });
            
            // Close modal functionality
            closeBooleanAlgebraModal.addEventListener('click', function() {
                booleanAlgebraModal.classList.remove('show');
                booleanAlgebraModal.setAttribute('aria-hidden', 'true');
                booleanAlgebraModal.removeAttribute('aria-modal');
                document.body.style.overflow = 'auto';
                
                // Return focus to the show answer button for better accessibility
                showAnswerBtn.focus();
            });
            
            // Close modal when clicking outside
            booleanAlgebraModal.addEventListener('click', function(e) {
                if (e.target === booleanAlgebraModal) {
                    booleanAlgebraModal.classList.remove('show');
                    booleanAlgebraModal.setAttribute('aria-hidden', 'true');
                    booleanAlgebraModal.removeAttribute('aria-modal');
                    document.body.style.overflow = 'auto';
                    
                    // Return focus to the show answer button for better accessibility
                    showAnswerBtn.focus();
                }
            });
            
            // Keyboard navigation for modal
            document.addEventListener('keydown', function(e) {
                if (booleanAlgebraModal.classList.contains('show')) {
                    if (e.key === 'Escape') {
                        booleanAlgebraModal.classList.remove('show');
                        booleanAlgebraModal.setAttribute('aria-hidden', 'true');
                        booleanAlgebraModal.removeAttribute('aria-modal');
                        document.body.style.overflow = 'auto';
                        
                        // Return focus to the show answer button for better accessibility
                        showAnswerBtn.focus();
                    }
                }
            });
            
            // Focus trapping within the modal
            booleanAlgebraModal.addEventListener('keydown', function(e) {
                if (e.key === 'Tab' && booleanAlgebraModal.classList.contains('show')) {
                    const focusableElements = booleanAlgebraModal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    const firstElement = focusableElements[0];
                    const lastElement = focusableElements[focusableElements.length - 1];
                    
                    if (e.shiftKey) {
                        // Shift + Tab: going backwards
                        if (document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        }
                    } else {
                        // Tab: going forwards
                        if (document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                }
            });
            
    
            
            // Initialize Lab 8 Truth Table functionality
            initializeLab8TruthTable();
        }
        
        // Call the Boolean Algebra Editor initialization function
        initializeLab8BooleanAlgebraEditor();
        
        // Lab 8 Truth Table Functionality
        function initializeLab8TruthTable() {
    
            
            // Function to evaluate F1, F2, F3 based on the exact truth table from the image
            function evaluateLab8F1(z, y, x) {
                z = Number(z); y = Number(y); x = Number(x);
                // Hardcoded correct answers from the image
                if (z === 0 && y === 0 && x === 0) return 1; // Row 1: 000 -> F1=1
                if (z === 0 && y === 0 && x === 1) return 0; // Row 2: 001 -> F1=0
                if (z === 0 && y === 1 && x === 0) return 0; // Row 3: 010 -> F1=0
                if (z === 0 && y === 1 && x === 1) return 0; // Row 4: 011 -> F1=0
                if (z === 1 && y === 0 && x === 0) return 0; // Row 5: 100 -> F1=0
                if (z === 1 && y === 0 && x === 1) return 1; // Row 6: 101 -> F1=1
                if (z === 1 && y === 1 && x === 0) return 0; // Row 7: 110 -> F1=0
                if (z === 1 && y === 1 && x === 1) return 1; // Row 8: 111 -> F1=1
                return 0;
            }
            
            function evaluateLab8F2(z, y, x) {
                z = Number(z); y = Number(y); x = Number(x);
                // Hardcoded correct answers from the image
                if (z === 0 && y === 0 && x === 0) return 0; // Row 1: 000 -> F2=0
                if (z === 0 && y === 0 && x === 1) return 1; // Row 2: 001 -> F2=1
                if (z === 0 && y === 1 && x === 0) return 1; // Row 3: 010 -> F2=1
                if (z === 0 && y === 1 && x === 1) return 0; // Row 4: 011 -> F2=0
                if (z === 1 && y === 0 && x === 0) return 0; // Row 5: 100 -> F2=0
                if (z === 1 && y === 0 && x === 1) return 0; // Row 6: 101 -> F2=0
                if (z === 1 && y === 1 && x === 0) return 1; // Row 7: 110 -> F2=1
                if (z === 1 && y === 1 && x === 1) return 0; // Row 8: 111 -> F2=0
                return 0;
            }
            
            function evaluateLab8F3(z, y, x) {
                z = Number(z); y = Number(y); x = Number(x);
                // Hardcoded correct answers from the image
                if (z === 0 && y === 0 && x === 0) return 1; // Row 1: 000 -> F3=1
                if (z === 0 && y === 0 && x === 1) return 0; // Row 2: 001 -> F3=0
                if (z === 0 && y === 1 && x === 0) return 0; // Row 3: 010 -> F3=0
                if (z === 0 && y === 1 && x === 1) return 1; // Row 4: 011 -> F3=1
                if (z === 1 && y === 0 && x === 0) return 0; // Row 5: 100 -> F3=0
                if (z === 1 && y === 0 && x === 1) return 0; // Row 6: 101 -> F3=0
                if (z === 1 && y === 1 && x === 0) return 0; // Row 7: 110 -> F3=0
                if (z === 1 && y === 1 && x === 1) return 1; // Row 8: 111 -> F3=1
                return 0;
            }
            
            function clearFieldStyleLab8(input) {
                input.style.backgroundColor = '';
                input.style.color = '';
                input.classList.remove('correct', 'incorrect', 'empty');
            }
            
            // Initialize truth table inputs
            // F1 inputs
            document.querySelectorAll('.output-field-lab8-f1').forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value;
                    if (v !== '0' && v !== '1') input.value = '';
                    clearFieldStyleLab8(input);
                });
                input.addEventListener('focus', function() {
                    input.select();
                });
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab8-f1, .output-field-lab8-f2, .output-field-lab8-f3', true);
                });
            });
            
            // F2 inputs
            document.querySelectorAll('.output-field-lab8-f2').forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value;
                    if (v !== '0' && v !== '1') input.value = '';
                    clearFieldStyleLab8(input);
                });
                input.addEventListener('focus', function() {
                    input.select();
                });
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab8-f1, .output-field-lab8-f2, .output-field-lab8-f3', true);
                });
            });
            
            // F3 inputs
            document.querySelectorAll('.output-field-lab8-f3').forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = input.value;
                    if (v !== '0' && v !== '1') input.value = '';
                    clearFieldStyleLab8(input);
                });
                input.addEventListener('focus', function() {
                    input.select();
                });
                input.addEventListener('keydown', function(e) {
                    handleTruthTableNavigation(e, '.output-field-lab8-f1, .output-field-lab8-f2, .output-field-lab8-f3', true);
                });
            });
            
            // Check answers button functionality
            document.getElementById('check-answers-btn-lab8').addEventListener('click', () => {
                // Check F1 answers
                document.querySelectorAll('.output-field-lab8-f1').forEach(input => {
                    const { z, y, x } = input.dataset;
                    const correct = evaluateLab8F1(z, y, x);
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct', 'incorrect');
                    } else if (parseInt(input.value) === correct) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect', 'empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct', 'empty');
                    }
                });
                
                // Check F2 answers
                document.querySelectorAll('.output-field-lab8-f2').forEach(input => {
                    const { z, y, x } = input.dataset;
                    const correct = evaluateLab8F2(z, y, x);
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('correct', 'incorrect');
                    } else if (parseInt(input.value) === correct) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect', 'empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct', 'empty');
                    }
                });
                
                // Check F3 answers
                document.querySelectorAll('.output-field-lab8-f3').forEach(input => {
                    const { z, y, x } = input.dataset;
                    const correct = evaluateLab8F3(z, y, x);
                    if (input.value === '') {
                        input.style.backgroundColor = '#cce5ff';
                        input.style.color = '#222';
                        input.value = correct;
                        input.classList.add('empty');
                        input.classList.remove('incorrect', 'correct');
                    } else if (parseInt(input.value) === correct) {
                        input.style.backgroundColor = '#d4edda';
                        input.style.color = '#155724';
                        input.classList.add('correct');
                        input.classList.remove('incorrect', 'empty');
                    } else {
                        input.style.backgroundColor = '#f8d7da';
                        input.style.color = '#721c24';
                        input.value = correct;
                        input.classList.add('incorrect');
                        input.classList.remove('correct', 'empty');
                    }
                });
            });
            
            // Clear table button functionality
            document.getElementById('clear-table-btn-lab8').addEventListener('click', () => {
                document.querySelectorAll('.output-field-lab8-f1, .output-field-lab8-f2, .output-field-lab8-f3').forEach(input => {
                    input.value = '';
                    clearFieldStyleLab8(input);
                });
            });
            
    
        }
        
        // Initialize Lab 8 text editor when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeLab8TextEditor);
        } else {
            initializeLab8TextEditor();
        }
        
        // Lab 8 Text Editor Functionality
        function initializeLab8TextEditor() {
            const editor = document.getElementById('lab8-simplification-editor');
            const toolbar = document.getElementById('lab8-simple-editor-toolbar');
            
            if (!editor || !toolbar) return;
            
            // Toolbar button functionality
            toolbar.addEventListener('click', function(e) {
                // Find the closest toolbar button (handles event delegation)
                const button = e.target.closest('.toolbar-btn');
                if (button) {
                    e.preventDefault();
                    const command = button.dataset.command;
                    const text = button.dataset.text;
                    
                    // Handle special commands
                    if (command === 'insertText' && text) {
                        document.execCommand('insertText', false, text);
                    } else {
                        document.execCommand(command, false, null);
                    }
                    
                    // Handle active states for toggle buttons
                    if (['bold', 'italic', 'superscript'].includes(command)) {
                        button.classList.toggle('active');
                    } else {
                        // Remove active from all buttons
                        toolbar.querySelectorAll('.toolbar-btn').forEach(btn => btn.classList.remove('active'));
                    }
                    
                    // Focus back to editor
                    editor.focus();
                }
            });
            
            // Show Answer button functionality
            const showAnswerBtn = document.getElementById('show-answer-btn-lab8-truth-table');
            if (showAnswerBtn) {
                showAnswerBtn.addEventListener('click', function() {
                    // Display user's answer in the modal
                    const userAnswerDisplay = document.getElementById('user-answer-display-lab8');
                    if (userAnswerDisplay) {
                        userAnswerDisplay.innerHTML = editor.innerHTML || '<em>No answer provided</em>';
                    }
                    
                    // Open the Lab 8 text editor answer modal
                    const modal = document.getElementById('lab8-text-editor-modal');
                    if (modal) {
                        modal.style.display = 'flex';
                        modal.setAttribute('aria-hidden', 'false');
                        modal.setAttribute('aria-modal', 'true');
                        document.body.style.overflow = 'hidden';
                    }
                });
        
            } else {
                // Lab 8 Truth Table Show Answer button not found
            }
            
            // Close modal functionality
            const closeModalBtn = document.getElementById('close-lab8-modal');
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', function() {
                    const modal = document.getElementById('lab8-text-editor-modal');
                    if (modal) {
                        modal.style.display = 'none';
                        modal.setAttribute('aria-hidden', 'true');
                        modal.removeAttribute('aria-modal');
                        document.body.style.overflow = '';
                    }
                });
            }
            
            // Close modal when clicking outside
            const modal = document.getElementById('lab8-text-editor-modal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                        modal.setAttribute('aria-hidden', 'true');
                        modal.removeAttribute('aria-modal');
                        document.body.style.overflow = '';
                    }
                });
            }
            
            // Keyboard navigation for modal
            document.addEventListener('keydown', function(e) {
                const modal = document.getElementById('lab8-text-editor-modal');
                if (modal && modal.style.display === 'flex') {
                    if (e.key === 'Escape') {
                        modal.style.display = 'none';
                        modal.setAttribute('aria-hidden', 'true');
                        modal.removeAttribute('aria-modal');
                        document.body.style.overflow = '';
                    }
                }
            });
        }
        
        // ===== Enhanced Flip Flop Simulator =====
        
        // Clock generator variables
        let clockInterval = null;
        let clockState = 'LOW';
        let clockEdge = 'None';
        let clockPhase = 0; // 0: LOW, 1: Rising, 2: HIGH, 3: Falling
        
        // Flip flop state variables
        let dFlipFlopQ = 0;
        let dFlipFlopQBar = 1;
        let jkFlipFlopQ = 0;
        let jkFlipFlopQBar = 1;
        
        // Previous states for edge detection
        let dFlipFlopPrevQ = 0;
        let jkFlipFlopPrevQ = 0;
        
        // Real IC timing variables (setup/hold time simulation)
        let lastClockRisingTime = 0;
        let setupTimeViolation = false;
        let holdTimeViolation = false;
        
        // Input state tracking for timing validation
        let dFlipFlopLastInput = 0;
        let jkFlipFlopLastJ = 0;
        let jkFlipFlopLastK = 0;
        
        // Clock control functions
        function startClock() {
            const frequency = parseFloat(document.getElementById('clockFrequency').value);
            const period = (1000 / frequency) / 4; // 4 phases per cycle
            
            clockInterval = setInterval(() => {
                updateClockPhase();
            }, period);
            
            document.getElementById('startClockBtn').style.display = 'none';
            document.getElementById('stopClockBtn').style.display = 'inline-block';
            document.getElementById('singlePulseBtn').disabled = true;
        }
        
        function stopClock() {
            if (clockInterval) {
                clearInterval(clockInterval);
                clockInterval = null;
            }
            
            document.getElementById('startClockBtn').style.display = 'inline-block';
            document.getElementById('stopClockBtn').style.display = 'none';
            document.getElementById('singlePulseBtn').disabled = false;
        }
        
        function singlePulse() {
            updateClockPhase();
            setTimeout(() => updateClockPhase(), 250);
            setTimeout(() => updateClockPhase(), 500);
            setTimeout(() => updateClockPhase(), 750);
        }
        
        function updateClockPhase() {
            clockPhase = (clockPhase + 1) % 4;
            
            switch (clockPhase) {
                case 0: // LOW
                    clockState = 'LOW';
                    clockEdge = 'None';
                    updateClockWaveform(0, 'LOW', 'None');
                    break;
                case 1: // Rising Edge (Transition)
                    clockState = 'HIGH';
                    clockEdge = 'Rising';
                    updateClockWaveform(100, 'HIGH', 'Rising');
                    // Trigger flip flops on rising edge (like real ICs)
                    updateFlipFlops();
                    break;
                case 2: // HIGH
                    clockState = 'HIGH';
                    clockEdge = 'None';
                    updateClockWaveform(100, 'HIGH', 'None');
                    break;
                case 3: // Falling Edge (Transition)
                    clockState = 'LOW';
                    clockEdge = 'Falling';
                    updateClockWaveform(0, 'LOW', 'Falling');
                    break;
            }
            
            // Update clock indicators in both flip flops
            updateClockIndicators();
        }
        
        function updateClockWaveform(level, state, edge) {
            const clockSignal = document.getElementById('clockSignal');
            const clockStateDisplay = document.getElementById('clockState');
            const clockEdgeDisplay = document.getElementById('clockEdge');
            
            if (clockSignal) {
                // Create realistic clock waveform movement with proper positioning
                if (edge === 'Rising') {
                    clockSignal.style.transform = `translateY(-50%) translateX(${level}%)`;
                    clockSignal.style.background = '#3498db'; // Blue for rising edge
                    clockSignal.style.boxShadow = '0 0 10px rgba(52, 152, 219, 0.6)';
                } else if (edge === 'Falling') {
                    clockSignal.style.transform = `translateY(-50%) translateX(${level}%)`;
                    clockSignal.style.background = '#f39c12'; // Orange for falling edge
                    clockSignal.style.boxShadow = '0 0 10px rgba(243, 156, 18, 0.6)';
                } else {
                    clockSignal.style.transform = `translateY(-50%) translateX(${level}%)`;
                    clockSignal.style.background = state === 'HIGH' ? '#2ecc71' : '#e74c3c';
                    clockSignal.style.boxShadow = state === 'HIGH' ? '0 0 10px rgba(46, 204, 113, 0.6)' : '0 0 10px rgba(231, 76, 60, 0.6)';
                }
            }
            if (clockStateDisplay) {
                clockStateDisplay.textContent = state;
                clockStateDisplay.style.color = state === 'HIGH' ? '#2ecc71' : '#e74c3c';
            }
            if (clockEdgeDisplay) {
                clockEdgeDisplay.textContent = edge;
                if (edge === 'Rising') {
                    clockEdgeDisplay.style.color = '#3498db';
                    clockEdgeDisplay.style.fontWeight = 'bold';
                } else if (edge === 'Falling') {
                    clockEdgeDisplay.style.color = '#f39c12';
                    clockEdgeDisplay.style.fontWeight = 'bold';
                } else {
                    clockEdgeDisplay.style.color = '#95a5a6';
                    clockEdgeDisplay.style.fontWeight = 'normal';
                }
            }
        }
        
        function updateClockIndicators() {
            // Update D Flip Flop clock indicator
            const dClockState = document.getElementById('dFlipFlopClockState');
            if (dClockState) {
                dClockState.textContent = clockState;
                dClockState.style.color = clockState === 'HIGH' ? '#2ecc71' : '#e74c3c';
            }
            
            // Update JK Flip Flop clock indicator
            const jkClockState = document.getElementById('jkFlipFlopClockState');
            if (jkClockState) {
                jkClockState.textContent = clockState;
                jkClockState.style.color = clockState === 'HIGH' ? '#2ecc71' : '#e74c3c';
            }
        }
        
        // D Flip Flop logic (74175 IC behavior) - Real IC Implementation
        function updateDFlipFlop() {
            const dInput = document.getElementById('dFlipFlopInput');
            const clearInput = document.getElementById('dFlipFlopClear');
            const presetInput = document.getElementById('dFlipFlopPreset');
            
            if (!dInput || !clearInput || !presetInput) return;
            
            const d = dInput.checked ? 1 : 0;
            const clr = clearInput.checked ? 0 : 1; // Active LOW
            const pre = presetInput.checked ? 0 : 1; // Active LOW
            
            // Real IC validation: Clear and Preset cannot be active simultaneously
            if (clr === 0 && pre === 0) {
                // Invalid state: both clear and preset active
                updateElement('dFlipFlopOperation', 'Invalid State - CLR̅ & PRE̅ Active');
                return;
            }
            
            // Update state displays
            updateElement('dFlipFlopDState', d);
            updateElement('dFlipFlopClearState', clr);
            updateElement('dFlipFlopPresetState', pre);
            
            // D Flip Flop logic (Real IC 74175 behavior)
            if (clr === 0) { // Clear active (asynchronous, immediate)
                dFlipFlopQ = 0;
                dFlipFlopQBar = 1;
                updateElement('dFlipFlopOperation', 'Clear Active (Async)');
            } else if (pre === 0) { // Preset active (asynchronous, immediate)
                dFlipFlopQ = 1;
                dFlipFlopQBar = 0;
                updateElement('dFlipFlopOperation', 'Preset Active (Async)');
            } else if (clockEdge === 'Rising') { // Clock rising edge (synchronous)
                // Store previous state before update
                dFlipFlopPrevQ = dFlipFlopQ;
                
                // Check for setup time violation (D must be stable before rising edge)
                if (d !== dFlipFlopLastInput) {
                    setupTimeViolation = true;
                    updateElement('dFlipFlopOperation', 'Setup Time Violation - Unstable Input');
                } else {
                    setupTimeViolation = false;
                // D Flip Flop: Q follows D at rising edge
                dFlipFlopQ = d;
                dFlipFlopQBar = d === 1 ? 0 : 1; // Q̅ is always complement of Q
                updateElement('dFlipFlopOperation', 'Clock Rising Edge - Q follows D');
                }
                
                // Update last input for next timing check
                dFlipFlopLastInput = d;
            } else {
                // No clock edge - maintain current state
                updateElement('dFlipFlopOperation', 'Normal - Holding State');
            }
            
            // Update output displays
            updateDFlipFlopOutputs();
        }
        
        // JK Flip Flop logic (74114 IC behavior) - Real IC Implementation
        function updateJKFlipFlop() {
            const jInput = document.getElementById('jkFlipFlopJ');
            const kInput = document.getElementById('jkFlipFlopK');
            const clearInput = document.getElementById('jkFlipFlopClear');
            const presetInput = document.getElementById('jkFlipFlopPreset');
            
            if (!jInput || !kInput || !clearInput || !presetInput) return;
            
            const j = jInput.checked ? 1 : 0;
            const k = kInput.checked ? 1 : 0;
            const clr = clearInput.checked ? 0 : 1; // Active LOW
            const pre = presetInput.checked ? 0 : 1; // Active LOW
            
            // Real IC validation: Clear and Preset cannot be active simultaneously
            if (clr === 0 && pre === 0) {
                // Invalid state: both clear and preset active
                updateElement('jkFlipFlopOperation', 'Invalid State - CLR̅ & PRE̅ Active');
                updateElement('jkFlipFlopMode', 'Invalid');
                return;
            }
            
            // Update state displays
            updateElement('jkFlipFlopJState', j);
            updateElement('jkFlipFlopKState', k);
            updateElement('jkFlipFlopClearState', clr);
            updateElement('jkFlipFlopPresetState', pre);
            
            // JK Flip Flop logic (Real IC 74114 behavior)
            if (clr === 0) { // Clear active (asynchronous, immediate)
                jkFlipFlopQ = 0;
                jkFlipFlopQBar = 1;
                updateElement('jkFlipFlopOperation', 'Clear Active (Async)');
                updateElement('jkFlipFlopMode', 'Reset');
            } else if (pre === 0) { // Preset active (asynchronous, immediate)
                jkFlipFlopQ = 1;
                jkFlipFlopQBar = 0;
                updateElement('jkFlipFlopOperation', 'Preset Active (Async)');
                updateElement('jkFlipFlopMode', 'Set');
            } else if (clockEdge === 'Rising') { // Clock rising edge (synchronous)
                // Store previous state before update
                jkFlipFlopPrevQ = jkFlipFlopQ;
                
                // Check for setup time violation (J,K must be stable before rising edge)
                if (j !== jkFlipFlopLastJ || k !== jkFlipFlopLastK) {
                    setupTimeViolation = true;
                    updateElement('jkFlipFlopOperation', 'Setup Time Violation - Unstable Inputs');
                } else {
                    setupTimeViolation = false;
                // JK Flip Flop truth table implementation
                if (j === 0 && k === 0) { // Hold - no change
                    updateElement('jkFlipFlopMode', 'Hold');
                    updateElement('jkFlipFlopOperation', 'Hold State - No Change');
                } else if (j === 0 && k === 1) { // Reset - Q = 0
                    jkFlipFlopQ = 0;
                    jkFlipFlopQBar = 1;
                    updateElement('jkFlipFlopMode', 'Reset');
                    updateElement('jkFlipFlopOperation', 'Reset - Q = 0');
                } else if (j === 1 && k === 0) { // Set - Q = 1
                    jkFlipFlopQ = 1;
                    jkFlipFlopQBar = 0;
                    updateElement('jkFlipFlopMode', 'Set');
                    updateElement('jkFlipFlopOperation', 'Set - Q = 1');
                } else if (j === 1 && k === 1) { // Toggle - Q changes state
                    const newQ = jkFlipFlopQ === 1 ? 0 : 1;
                    jkFlipFlopQ = newQ;
                    jkFlipFlopQBar = newQ === 1 ? 0 : 1; // Q̅ is always complement of Q
                    updateElement('jkFlipFlopMode', 'Toggle');
                    updateElement('jkFlipFlopOperation', `Toggle - Q changes to ${newQ}`);
                }
                }
                
                // Update last inputs for next timing check
                jkFlipFlopLastJ = j;
                jkFlipFlopLastK = k;
            } else {
                // No clock edge - maintain current state
                updateElement('jkFlipFlopOperation', 'Normal - Holding State');
            }
            
            // Update output displays
            updateJKFlipFlopOutputs();
        }
        
        // Lab 11 K-Map Modal System
        function initializeLab11KMapModals() {
    
            
            // Initialize all Lab 11 K-Map modals
            const modalIds = ['ja', 'ka', 'jb', 'kb', 'jc', 'kc'];
            
            modalIds.forEach(id => {
                // Get modal elements
                const modal = document.getElementById(`kmap-answer-modal-lab11-${id}`);
                const showBtn = document.getElementById(`show-kmap-answer-btn-lab11-${id}`);
                const closeBtn = document.getElementById(`close-kmap-modal-lab11-${id}`);
                const closeFooterBtn = document.getElementById(`close-kmap-modal-footer-lab11-${id}`);
                const copyBtn = document.getElementById(`copy-kmap-answer-btn-lab11-${id}`);
                
                if (!modal || !showBtn) {
                    console.warn(`Modal elements not found for ${id}`);
                    return;
                }
                
                // Show modal button click handler
                showBtn.addEventListener('click', function() {
                    // Populate user's answers
                    populateUserAnswersLab11(id);
                    
                    // Show the modal
                    modal.setAttribute('aria-hidden', 'false');
                    modal.setAttribute('aria-modal', 'true');
                    modal.style.display = 'block';
                    
                    // Focus trap
                    trapFocusLab11(modal);
                    

                });
                
                // Close modal button handlers
                if (closeBtn) {
                    closeBtn.addEventListener('click', function() {
                        closeModalLab11(id);
                    });
                }
                
                if (closeFooterBtn) {
                    closeFooterBtn.addEventListener('click', function() {
                        closeModalLab11(id);
                    });
                }
                
                // Copy answer button handler
                if (copyBtn) {
                    copyBtn.addEventListener('click', function() {
                        copyKMapAnswerLab11(id);
                    });
                }
                
                // Escape key handler
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && modal.style.display === 'block') {
                        closeModalLab11(id);
                    }
                });
                
                // Click outside modal to close
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModalLab11(id);
                    }
                });
            });
            
    
        }
        
        // Populate user's answers in the modal
        function populateUserAnswersLab11(id) {
            const userKMapDisplay = document.getElementById(`user-kmap-display-lab11-${id}`);
            const userExpressionDisplay = document.getElementById(`user-expression-display-lab11-${id}`);
            
            if (!userKMapDisplay || !userExpressionDisplay) return;
            
            // Get K-Map values
            const kMapInputs = document.querySelectorAll(`#k-map-lab11-${id} .k-map-input`);
            const kMapValues = [];
            
            kMapInputs.forEach((input, index) => {
                const row = Math.floor(index / 4);
                const col = index % 4;
                const value = input.value || '';
                kMapValues.push({ row, col, value });
            });
            
            // Create K-Map display HTML
            let kMapHTML = '<div class="kmap-grid-display">';
            kMapHTML += '<div class="kmap-row">';
            kMapHTML += '<div class="kmap-header-cell"></div>';
            kMapHTML += '<div class="kmap-header-cell">B\'C\'</div>';
            kMapHTML += '<div class="kmap-header-cell">BC\'</div>';
            kMapHTML += '<div class="kmap-header-cell">BC</div>';
            kMapHTML += '<div class="kmap-header-cell">B\'C</div>';
            kMapHTML += '</div>';
            
            // A' row
            kMapHTML += '<div class="kmap-row">';
            kMapHTML += '<div class="kmap-header-cell">A\'</div>';
            for (let col = 0; col < 4; col++) {
                const value = kMapValues.find(v => v.row === 0 && v.col === col)?.value || '';
                kMapHTML += `<div class="kmap-cell">${value}</div>`;
            }
            kMapHTML += '</div>';
            
            // A row
            kMapHTML += '<div class="kmap-row">';
            kMapHTML += '<div class="kmap-header-cell">A</div>';
            for (let col = 0; col < 4; col++) {
                const value = kMapValues.find(v => v.row === 1 && v.col === col)?.value || '';
                kMapHTML += `<div class="kmap-cell">${value}</div>`;
            }
            kMapHTML += '</div>';
            
            kMapHTML += '</div>';
            
            userKMapDisplay.innerHTML = kMapHTML;
            
            // Get simplified expression
            const editor = document.getElementById(`kmap-simplification-editor-lab11-${id}`);
            if (editor) {
                userExpressionDisplay.innerHTML = editor.innerHTML || '<em>No expression entered</em>';
            }
        }
        
        // Close modal function
        function closeModalLab11(id) {
            const modal = document.getElementById(`kmap-answer-modal-lab11-${id}`);
            const showBtn = document.getElementById(`show-kmap-answer-btn-lab11-${id}`);
            
            if (modal) {
                // Remove focus from modal elements before hiding
                const focusableElements = modal.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                focusableElements.forEach(element => {
                    element.setAttribute('tabindex', '-1');
                });
                
                // Hide the modal
                modal.style.display = 'none';
                modal.removeAttribute('aria-modal');
                
                // Set aria-hidden after removing focus
                modal.setAttribute('aria-hidden', 'true');
                
                // Restore focus to the show button
                if (showBtn) {
                    showBtn.focus();
                }
                
                // Restore tabindex for future use
                focusableElements.forEach(element => {
                    element.removeAttribute('tabindex');
                });
            }
        }
        
        // Copy K-Map answer function
        function copyKMapAnswerLab11(id) {
            const correctExpressionDisplay = document.getElementById(`correct-expression-display-lab11-${id}`);
            if (!correctExpressionDisplay) return;
            
            const textToCopy = correctExpressionDisplay.textContent || correctExpressionDisplay.innerText;
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    showCopySuccessLab11(id);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                    fallbackCopyTextToClipboardLab11(textToCopy, id);
                });
            } else {
                fallbackCopyTextToClipboardLab11(textToCopy, id);
            }
        }
        
        // Show copy success message
        function showCopySuccessLab11(id) {
            const copyBtn = document.getElementById(`copy-kmap-answer-btn-lab11-${id}`);
            if (copyBtn) {
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                copyBtn.style.background = '#27ae60';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = '';
                }, 2000);
            }
        }
        
        // Fallback copy function
        function fallbackCopyTextToClipboardLab11(text, id) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopySuccessLab11(id);
            } catch (err) {
                console.error('Fallback copy failed: ', err);
            }
            
            document.body.removeChild(textArea);
        }
        
        // Focus trap for modals
        function trapFocusLab11(modal) {
            const focusableElements = modal.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            
            if (focusableElements.length === 0) return;
            
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];
            
            // Focus the first element after a brief delay to ensure modal is fully rendered
            setTimeout(() => {
            firstElement.focus();
            }, 10);
            
            // Remove any existing keydown listeners to prevent duplicates
            modal.removeEventListener('keydown', modal._focusTrapHandler);
            
            // Create the focus trap handler
            modal._focusTrapHandler = function(e) {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        if (document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        }
                    } else {
                        if (document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                }
            };
            
            // Add the focus trap handler
            modal.addEventListener('keydown', modal._focusTrapHandler);
        }
        
        // Reset all Lab 11 editor states (call this when leaving Lab 11)
        function resetAllLab11EditorStates() {
            lab11EditorStates.clear();
            
            // Clear all active button states
            const modalIds = ['ja', 'ka', 'jb', 'kb', 'jc', 'kc'];
            modalIds.forEach(id => {
                const toolbar = document.getElementById(`lab11-${id}-editor-toolbar`);
                if (toolbar) {
                    toolbar.querySelectorAll('.toolbar-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                }
            });
        }
        
        function updateFlipFlops() {
            updateDFlipFlop();
            updateJKFlipFlop();
        }
        
        function updateDFlipFlopOutputs() {
            // Update Q output
            const qLed = document.getElementById('dFlipFlopQLed');
            const qState = document.getElementById('dFlipFlopQState');
            if (qLed) {
                qLed.className = `led-output ${dFlipFlopQ === 1 ? 'active' : ''}`;
                qLed.setAttribute('aria-label', `D Flip Flop Q Output LED is ${dFlipFlopQ === 1 ? 'ON' : 'OFF'}`);
            }
            if (qState) {
                qState.textContent = `${dFlipFlopQ} (${dFlipFlopQ === 1 ? 'HIGH' : 'LOW'})`;
                qState.style.color = dFlipFlopQ === 1 ? '#2ecc71' : '#e74c3c';
            }
            
            // Update Q̅ output
            const qBarLed = document.getElementById('dFlipFlopQBarLed');
            const qBarState = document.getElementById('dFlipFlopQBarState');
            if (qBarLed) {
                qBarLed.className = `led-output ${dFlipFlopQBar === 1 ? 'active' : ''}`;
                qBarLed.setAttribute('aria-label', `D Flip Flop Q̅ Output LED is ${dFlipFlopQBar === 1 ? 'ON' : 'OFF'}`);
            }
            if (qBarState) {
                qBarState.textContent = `${dFlipFlopQBar} (${dFlipFlopQBar === 1 ? 'HIGH' : 'LOW'})`;
                qBarState.style.color = dFlipFlopQBar === 1 ? '#2ecc71' : '#e74c3c';
            }
            
            // Update previous Q display
            updateElement('dFlipFlopPrevQ', dFlipFlopPrevQ);
            updateElement('dFlipFlopClockEdge', clockEdge);
        }
        
        function updateJKFlipFlopOutputs() {
            // Update Q output
            const qLed = document.getElementById('jkFlipFlopQLed');
            const qState = document.getElementById('jkFlipFlopQState');
            if (qLed) {
                qLed.className = `led-output ${jkFlipFlopQ === 1 ? 'active' : ''}`;
                qLed.setAttribute('aria-label', `JK Flip Flop Q Output LED is ${jkFlipFlopQ === 1 ? 'ON' : 'OFF'}`);
            }
            if (qState) {
                qState.textContent = `${jkFlipFlopQ} (${jkFlipFlopQ === 1 ? 'HIGH' : 'LOW'})`;
                qState.style.color = jkFlipFlopQ === 1 ? '#2ecc71' : '#e74c3c';
            }
            
            // Update Q̅ output
            const qBarLed = document.getElementById('jkFlipFlopQBarLed');
            const qBarState = document.getElementById('jkFlipFlopQBarState');
            if (qBarLed) {
                qBarLed.className = `led-output ${jkFlipFlopQBar === 1 ? 'active' : ''}`;
                qBarLed.setAttribute('aria-label', `JK Flip Flop Q̅ Output LED is ${jkFlipFlopQBar === 1 ? 'ON' : 'OFF'}`);
            }
            if (qBarState) {
                qBarState.textContent = `${jkFlipFlopQBar} (${jkFlipFlopQBar === 1 ? 'HIGH' : 'LOW'})`;
                qBarState.style.color = jkFlipFlopQBar === 1 ? '#2ecc71' : '#e74c3c';
            }
            
            // Update previous Q display
            updateElement('jkFlipFlopPrevQ', jkFlipFlopPrevQ);
            
            // Update dynamic truth table display
            updateJKFlipFlopTruthTable();
        }
        
        // Dynamic JK Flip Flop truth table display
        function updateJKFlipFlopTruthTable() {
            const j = document.getElementById('jkFlipFlopJ')?.checked ? 1 : 0;
            const k = document.getElementById('jkFlipFlopK')?.checked ? 1 : 0;
            const truthTableElement = document.getElementById('jkFlipFlopTruthTable');
            
            if (truthTableElement) {
                let truthTableText = '';
                if (j === 0 && k === 0) {
                    truthTableText = 'J=0,K=0 (Hold) - No Change';
                } else if (j === 0 && k === 1) {
                    truthTableText = 'J=0,K=1 (Reset) - Q=0';
                } else if (j === 1 && k === 0) {
                    truthTableText = 'J=1,K=0 (Set) - Q=1';
                } else if (j === 1 && k === 1) {
                    truthTableText = 'J=1,K=1 (Toggle) - Q Changes';
                }
                truthTableElement.textContent = truthTableText;
            }
        }
        
        function updateElement(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = value;
            }
        }
        


        

        
        // Reset flip flops to initial state
        function resetFlipFlopsToInitialState() {
            // Reset D Flip Flop
            dFlipFlopQ = 0;
            dFlipFlopQBar = 1;
            dFlipFlopPrevQ = 0;
            dFlipFlopLastInput = 0;
            
            // Reset JK Flip Flop
            jkFlipFlopQ = 0;
            jkFlipFlopQBar = 1;
            jkFlipFlopPrevQ = 0;
            jkFlipFlopLastJ = 0;
            jkFlipFlopLastK = 0;
            
            // Reset timing violations
            setupTimeViolation = false;
            holdTimeViolation = false;
            
            // Reset button states
            const dClear = document.getElementById('dFlipFlopClear');
            const dPreset = document.getElementById('dFlipFlopPreset');
            const jkClear = document.getElementById('jkFlipFlopClear');
            const jkPreset = document.getElementById('jkFlipFlopPreset');
            
            if (dClear) {
                dClear.checked = false;
            }
            if (dPreset) {
                dPreset.checked = false;
            }
            if (jkClear) {
                jkClear.checked = false;
            }
            if (jkPreset) {
                jkPreset.checked = false;
            }
            
            // Update displays
            updateDFlipFlopOutputs();
            updateJKFlipFlopOutputs();
        }
        
        // Enhanced Tooltip System for Flip Flop Simulators and MOD-7 Counter
        function initializeEnhancedTooltips() {
    
            
            // Get all tooltip trigger buttons
            const tooltipTriggers = document.querySelectorAll('.tooltip-trigger');
            
            // Add click event listeners to tooltip triggers
            tooltipTriggers.forEach(trigger => {
                trigger.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const tooltipId = this.getAttribute('data-tooltip');
                    const tooltip = document.getElementById(tooltipId);
                    
                    if (tooltip) {
                        // Show the tooltip
                        tooltip.style.display = 'block';
                        
                        // Add escape key listener
                        const escapeHandler = function(e) {
                            if (e.key === 'Escape') {
                                hideTooltip(tooltip);
                                document.removeEventListener('keydown', escapeHandler);
                            }
                        };
                        document.addEventListener('keydown', escapeHandler);
                        
                        // Add click outside listener
                        const clickOutsideHandler = function(e) {
                            if (!tooltip.contains(e.target) && !trigger.contains(e.target)) {
                                hideTooltip(tooltip);
                                document.removeEventListener('click', clickOutsideHandler);
                                document.removeEventListener('keydown', escapeHandler);
                            }
                        };
                        document.addEventListener('click', clickOutsideHandler);
                    }
                });
            });
            
            // Add event listeners to close buttons
            const closeButtons = document.querySelectorAll('.tooltip-close');
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tooltip = this.closest('.enhanced-tooltip');
                    if (tooltip) {
                        hideTooltip(tooltip);
                    }
                });
            });
            
    
        }
        
        // Hide tooltip function
        function hideTooltip(tooltip) {
            tooltip.style.display = 'none';
        }
        
        // Simulator Navigation System
        function initializeSimulatorNavigation() {
    
            
            // Get navigation buttons and simulator containers
            const showDFlipFlopBtn = document.getElementById('showDFlipFlopBtn');
            const showJKFlipFlopBtn = document.getElementById('showJKFlipFlopBtn');
            const showBothBtn = document.getElementById('showBothBtn');
            const dFlipFlopSimulator = document.getElementById('dFlipFlopSimulator');
            const jkFlipFlopSimulator = document.getElementById('jkFlipFlopSimulator');
            
            if (!showDFlipFlopBtn || !showJKFlipFlopBtn || !showBothBtn || !dFlipFlopSimulator || !jkFlipFlopSimulator) {
                console.error('Navigation elements not found');
                return;
            }
            
            // Set initial state - show D Flip Flop by default
            dFlipFlopSimulator.style.display = 'block';
            jkFlipFlopSimulator.style.display = 'none';
            
            // D Flip Flop button click handler
            showDFlipFlopBtn.addEventListener('click', function() {
                // Update button states
                showDFlipFlopBtn.classList.add('active');
                showJKFlipFlopBtn.classList.remove('active');
                showBothBtn.classList.remove('active');
                
                // Show only D Flip Flop
                dFlipFlopSimulator.style.display = 'block';
                jkFlipFlopSimulator.style.display = 'none';
                

            });
            
            // JK Flip Flop button click handler
            showJKFlipFlopBtn.addEventListener('click', function() {
                // Update button states
                showDFlipFlopBtn.classList.remove('active');
                showJKFlipFlopBtn.classList.add('active');
                showBothBtn.classList.remove('active');
                
                // Show only JK Flip Flop
                dFlipFlopSimulator.style.display = 'none';
                jkFlipFlopSimulator.style.display = 'block';
                

            });
            
            // Show Both button click handler
            showBothBtn.addEventListener('click', function() {
                // Update button states
                showDFlipFlopBtn.classList.remove('active');
                showJKFlipFlopBtn.classList.remove('active');
                showBothBtn.classList.add('active');
                
                // Show both simulators
                dFlipFlopSimulator.style.display = 'block';
                jkFlipFlopSimulator.style.display = 'block';
                

            });
            
    
        }
        
        // Initialize flip flop simulator when DOM is ready
        function initializeFlipFlopSimulator() {
    
            
            // Clock control event listeners
            const startClockBtn = document.getElementById('startClockBtn');
            const stopClockBtn = document.getElementById('stopClockBtn');
            const singlePulseBtn = document.getElementById('singlePulseBtn');
            const frequencySelect = document.getElementById('clockFrequency');
            
            if (startClockBtn) {
                startClockBtn.addEventListener('click', startClock);
            }
            if (stopClockBtn) {
                stopClockBtn.addEventListener('click', stopClock);
            }
            if (singlePulseBtn) {
                singlePulseBtn.addEventListener('click', singlePulse);
            }
            
            const resetFlipFlopsBtn = document.getElementById('resetFlipFlopsBtn');
            if (resetFlipFlopsBtn) {
                resetFlipFlopsBtn.addEventListener('click', resetFlipFlopsToInitialState);
            }
            if (frequencySelect) {
                frequencySelect.addEventListener('change', function() {
                    if (clockInterval) {
                        stopClock();
                        startClock(); // Restart with new frequency
                    }
                });
            }
            
            // Input change event listeners for D Flip Flop
            const dInput = document.getElementById('dFlipFlopInput');
            const dClear = document.getElementById('dFlipFlopClear');
            const dPreset = document.getElementById('dFlipFlopPreset');
            
            if (dInput) dInput.addEventListener('change', updateDFlipFlop);
            if (dClear) {
                dClear.addEventListener('change', updateDFlipFlop);
            }
            if (dPreset) {
                dPreset.addEventListener('change', updateDFlipFlop);
            }
            
            // Input change event listeners for JK Flip Flop
            const jInput = document.getElementById('jkFlipFlopJ');
            const kInput = document.getElementById('jkFlipFlopK');
            const jkClear = document.getElementById('jkFlipFlopClear');
            const jkPreset = document.getElementById('jkFlipFlopPreset');
            
            if (jInput) jInput.addEventListener('change', updateJKFlipFlop);
            if (kInput) kInput.addEventListener('change', updateJKFlipFlop);
            if (jkClear) {
                jkClear.addEventListener('change', updateJKFlipFlop);
            }
            if (jkPreset) {
                jkPreset.addEventListener('change', updateJKFlipFlop);
            }
            
            // Initialize displays
            updateDFlipFlop();
            updateJKFlipFlop();
            
            // Initialize truth table display
            updateJKFlipFlopTruthTable();
            
            // Reset flip flops to known state
            resetFlipFlopsToInitialState();
            
            // Initialize enhanced tooltips
            initializeEnhancedTooltips();
            
            // Initialize simulator navigation
            initializeSimulatorNavigation();
            
            // Initialize Lab 11 K-Map modals
            initializeLab11KMapModals();
            
            // Reset Lab 11 editor states when leaving Lab 11
            resetAllLab11EditorStates();
            
    
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeFlipFlopSimulator);
        } else {
            initializeFlipFlopSimulator();
        }
    </script>
    <!-- Lab-specific JavaScript files - Loaded dynamically for performance -->
    <!-- Scripts will be loaded on-demand when labs are accessed -->
    
    <!-- ======================== -->
    <!-- SERVICE WORKER & ERROR HANDLING -->
    <!-- ======================== -->
    
    <script>
        // Service Worker Registration with Protocol Detection
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // Check if we're running on a supported protocol
                const isSupportedProtocol = window.location.protocol === 'http:' || 
                                          window.location.protocol === 'https:' ||
                                          window.location.hostname === 'localhost' ||
                                          window.location.hostname === '127.0.0.1';
                
                if (isSupportedProtocol) {
                    navigator.serviceWorker.register('/sw.js')
                        .then(function(registration) {
                            // Service Worker registered successfully
                        })
                        .catch(function(error) {
                            // Service Worker registration failed silently
                        });
                }
            });
        }
        
        // Global error handling is managed by platformPreloader.js
        // This ensures consistent error handling across the application
        
        // Theme synchronization is handled by platformPreloader.js
        // This ensures consistent theme management across the application
        
        // Image error handling and fallback
        function initializeImageErrorHandling() {
            const images = document.querySelectorAll('img');
            
            images.forEach(function(img) {
                // Set images to be visible by default
                img.style.opacity = '1';
                img.style.transition = 'opacity 0.3s ease';
                
                // Add error handling
                img.addEventListener('error', function() {
                    // Hide broken images
                    this.style.display = 'none';
                    
                    // Create fallback placeholder with proper structure
                    const placeholder = document.createElement('div');
                    placeholder.className = 'image-placeholder';
                    
                    const placeholderContent = document.createElement('div');
                    placeholderContent.className = 'image-placeholder-content';
                    
                    const icon = document.createElement('i');
                    icon.className = 'fas fa-image image-placeholder-icon';
                    
                    const title = document.createElement('div');
                    title.className = 'image-placeholder-title';
                    title.textContent = 'Image not available';
                    
                    const description = document.createElement('div');
                    description.className = 'image-placeholder-description';
                    description.textContent = this.alt || 'Missing image';
                    
                    placeholderContent.appendChild(icon);
                    placeholderContent.appendChild(title);
                    placeholderContent.appendChild(description);
                    placeholder.appendChild(placeholderContent);
                    
                    // Insert placeholder after the broken image
                    this.parentNode.insertBefore(placeholder, this.nextSibling);
                });
                
                // Add loading state for smooth transitions (optional enhancement)
                img.addEventListener('load', function() {
                    // Image loaded successfully - ensure it's visible
                    this.style.opacity = '1';
                });
                
                // Fallback: Ensure images are visible after a short delay
                // This handles cases where load events don't fire properly
                setTimeout(() => {
                    if (img.style.opacity !== '1') {
                        img.style.opacity = '1';
                    }
                }, 100);
            });
        }
        
        // Advanced Image Optimization with Lazy Loading
        function initializeAdvancedImageOptimization() {
            const images = document.querySelectorAll('img[src*=".png"], img[src*=".jpg"], img[src*=".jpeg"]');
            
            images.forEach(img => {
                // Add lazy loading for images below the fold
                if (!img.hasAttribute('loading')) {
                    img.setAttribute('loading', 'lazy');
                }
                
                // Add decoding attribute for better performance
                if (!img.hasAttribute('decoding')) {
                    img.setAttribute('decoding', 'async');
                }
                
                // Add intersection observer for progressive loading
                setupProgressiveImageLoading(img);
            });
        }
        

        
        function setupProgressiveImageLoading(img) {
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            
                            // Load the image
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                            }
                            
                            // Add loaded class for smooth transition
                            img.addEventListener('load', function() {
                                img.classList.add('loaded');
                            });
                            
                            observer.unobserve(img);
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.1
                });
                
                imageObserver.observe(img);
            }
        }
        
        // Dynamic Script Loading System for Performance Optimization
        const scriptLoader = {
            loadedScripts: new Set(),
            loadingScripts: new Set(),
            
            // Lab script mapping
            labScripts: {
                'lab3': 'lab3-modal.js',
                'lab4': 'lab4-modal.js', 
                'lab5': ['lab5-modal.js', 'lab5-kmap.js'],
                'lab6': ['lab6-kmap.js', 'lab6-function-h-kmap.js', 'lab6-simplification.js'],
                'lab11': 'lab11-modal.js'
            },
            
            // Load script(s) for a specific lab
            loadLabScripts: function(labId) {
                const scripts = this.labScripts[labId];
                if (!scripts) return Promise.resolve();
                
                const scriptArray = Array.isArray(scripts) ? scripts : [scripts];
                const loadPromises = scriptArray.map(script => this.loadScript(script));
                
                return Promise.all(loadPromises);
            },
            
            // Load individual script
            loadScript: function(scriptPath) {
                return new Promise((resolve, reject) => {
                    // Check if already loaded
                    if (this.loadedScripts.has(scriptPath)) {
                        resolve();
                        return;
                    }
                    
                    // Check if currently loading
                    if (this.loadingScripts.has(scriptPath)) {
                        // Wait for existing load to complete
                        const checkInterval = setInterval(() => {
                            if (this.loadedScripts.has(scriptPath)) {
                                clearInterval(checkInterval);
                                resolve();
                            }
                        }, 50);
                        return;
                    }
                    
                    this.loadingScripts.add(scriptPath);
                    
                    const script = document.createElement('script');
                    script.src = scriptPath;
                    script.async = true;
                    
                    script.onload = () => {
                        this.loadedScripts.add(scriptPath);
                        this.loadingScripts.delete(scriptPath);
                        resolve();
                    };
                    
                    script.onerror = () => {
                        this.loadingScripts.delete(scriptPath);
                        reject(new Error(`Failed to load ${scriptPath}`));
                    };
                    
                    document.head.appendChild(script);
                });
            },
            
            // Preload critical scripts only in production
            preloadCriticalScripts: function() {
                // Only preload in production environment
                const isDevelopment = window.location.protocol === 'file:';
                if (isDevelopment) {
                    return;
                }
                
                // Preload only the most critical scripts that are used immediately
                // Removed lab3-modal.js and lab4-modal.js from preload as they're loaded on-demand
                const criticalScripts = ['js/platformPreloader.js'];
                criticalScripts.forEach(script => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'script';
                    link.href = script;
                    document.head.appendChild(link);
                });
            }
        };
        
        // Initialize dynamic script loading
        document.addEventListener('DOMContentLoaded', function() {
            scriptLoader.preloadCriticalScripts();
        });
        
        // Lab section intersection observer for lazy loading
        function initializeLabLazyLoading() {
            if ('IntersectionObserver' in window) {
                const labObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const labSection = entry.target;
                            const labId = labSection.id;
                            
                            // Load scripts for this lab
                            scriptLoader.loadLabScripts(labId);
                            
                            // Mark as loaded
                            labSection.classList.add('scripts-loaded');
                            
                            // Unobserve after loading
                            labObserver.unobserve(labSection);
                        }
                    });
                }, {
                    threshold: 0.1,
                    rootMargin: '100px 0px'
                });
                
                // Observe all lab sections
                document.querySelectorAll('.lab-section').forEach(section => {
                    labObserver.observe(section);
                });
            }
        }
        
        // Initialize image error handling and optimization
        document.addEventListener('DOMContentLoaded', function() {
            initializeImageErrorHandling();
            initializeAdvancedImageOptimization();
            initializeLabLazyLoading();
        });
        
        // Handle manifest loading for development environment
        document.addEventListener('DOMContentLoaded', function() {
            const manifestLink = document.getElementById('pwa-manifest');
            if (manifestLink && window.location.protocol === 'file:') {
                // Remove manifest link in file:// protocol to prevent CORS errors
                manifestLink.remove();
            }
        });
    </script>
    
    <!-- ======================== -->
    <!-- CONTEXTUAL HELP SYSTEM  -->
    <!-- ======================== -->
    
    <!-- Help Dropdown Menu (Positioned relative to header) -->
        <div id="help-dropdown" class="help-dropdown" inert>
            <button class="dropdown-item" id="need-help-btn" aria-label="Need Help?">
                <i class="fas fa-book"></i>
                <span>Need Help?</span>
            </button>
            <button class="dropdown-item" id="contact-us-btn" aria-label="Contact Us">
                <i class="fas fa-envelope"></i>
                <span>Contact Us</span>
            </button>
    </div>
    
    <!-- Help Popup Modal -->
    <div id="help-popup" class="help-popup" role="dialog" aria-modal="true" aria-labelledby="help-popup-title" aria-hidden="true">
        <header class="help-popup-header">
            <h2 id="help-popup-title" class="help-popup-title">
                <i class="fas fa-book"></i> CS121 Lab Manual Help
            </h2>
            <button id="help-popup-close" class="help-popup-close" aria-label="Close Help">
                <i class="fas fa-times"></i>
            </button>
        </header>
        
        <main class="help-cards-container">
            <div id="help-cards" class="help-cards">
                <!-- Help cards will be dynamically generated here -->
            </div>
        </main>
        
        <nav class="help-navigation">
            <button id="help-prev" class="help-nav-btn" aria-label="Previous Help Card">
                    <i class="fas fa-arrow-left"></i>
                </button>
            
            <div id="help-indicators" class="help-indicators">
                <!-- Navigation indicators will be generated here -->
            </div>
            
            <button id="help-next" class="help-nav-btn" aria-label="Next Help Card">
                    <i class="fas fa-arrow-right"></i>
                </button>
        </nav>
    </div>
    
    <!-- Contact Us Modal -->
    <div id="contact-modal" class="contact-modal" role="dialog" aria-modal="true" aria-labelledby="contact-modal-title" aria-hidden="true">
        <header class="contact-modal-header">
            <h2 id="contact-modal-title" class="contact-modal-title">
                <i class="fas fa-envelope"></i> Contact Us
            </h2>
            <button id="contact-modal-close" class="contact-modal-close" aria-label="Close Contact Form">
                <i class="fas fa-times"></i>
            </button>
        </header>
        
        <main class="contact-form-container">
            <form id="contact-form" class="contact-form" action="https://docs.google.com/forms/d/e/1FAIpQLSffKKM22PCB6ExgQ5ZzgaX3xwMJvdLDtY0oUuMaK0V4KD5FpA/formResponse" method="POST" novalidate>
                
                <div class="form-group">
                    <input type="text" id="contact-name" name="entry.1094972063" class="contact-input" placeholder="Your Name" required minlength="2" maxlength="50" autocomplete="name" aria-describedby="help-contact-name error-contact-name">
                    <div class="contact-help" id="help-contact-name">Enter your real name (letters and spaces only, 2-50 characters).</div>
                    <div class="contact-error" id="error-contact-name" role="alert" aria-live="polite"></div>
                </div>
                
                <div class="form-group">
                    <input type="email" id="contact-email" name="entry.1992693250" class="contact-input" placeholder="Your Email" required maxlength="100" autocomplete="email" aria-describedby="help-contact-email error-contact-email">
                    <div class="contact-help" id="help-contact-email">We'll only use your email to reply. It won't be shared.</div>
                    <div class="contact-error" id="error-contact-email" role="alert" aria-live="polite"></div>
                </div>
                
                <div class="form-group">
                    <textarea id="contact-message" name="entry.45885214" class="contact-input" placeholder="Your Message" required minlength="10" maxlength="1000" aria-describedby="help-contact-message error-contact-message"></textarea>
                    <div class="contact-help" id="help-contact-message">Write your message clearly (at least 10 characters).</div>
                    <div class="contact-error" id="error-contact-message" role="alert" aria-live="polite"></div>
                </div>
                
                <button type="submit" id="contact-submit-btn" class="contact-submit-btn" disabled>Send Message</button>
                <div id="contact-form-message"></div>
            </form>
        </main>
    </div>
    
    <!-- Help System JavaScript -->
    <script>
        (function() {
            'use strict';
            
            // ========================
            // HELP SYSTEM COMPONENT
            // ========================
            
            // Help content specific to CS121 Lab Manual
            const helpCards = [
                {
                    title: 'Getting Started with CS121',
                    description: 'Start with Lab 1 (Logic Gates) to build your foundation. Each lab builds on the previous one, so don\'t skip ahead!\n\nUse the sidebar navigation to jump between labs.\n\nPro tip: Complete the pre-lab activities first - they\'re designed to prepare you for the hands-on experiments.'
                },
                {
                    title: 'Interactive Simulators - Your Learning Lab',
                    description: 'These aren\'t just demos - they\'re your virtual lab bench!\n\n• Toggle switches to see real-time changes in LED outputs\n• Start with simple inputs (0,1) and gradually try complex combinations\n• Watch how outputs change instantly - this helps you understand the relationship between inputs and outputs'
                },
                {
                    title: 'Truth Tables - Master the Fundamentals',
                    description: 'Truth tables are your best friend in digital logic!\n\n• Start by filling in simple cases (00, 01, 10, 11) first\n• Common mistake: Don\'t forget that 0 = FALSE and 1 = TRUE\n• Use the "Show Correct Answers" button to check your work, but try to solve it yourself first!'
                },
                {
                    title: 'K-Map Simplification - Step by Step',
                    description: 'K-Maps can be tricky! Here\'s the systematic approach:\n\n1. Fill in the 1s first\n2. Group adjacent 1s in powers of 2 (2, 4, 8)\n3. Don\'t care (X) can be 0 or 1 - use them to make larger groups\n4. Start with 2x2 groups, then expand to 4x4\n\nPractice makes perfect!'
                },
                {
                    title: 'Circuit Design - From Theory to Practice',
                    description: 'When designing circuits, follow this systematic approach:\n\n1. Start with the truth table\n2. Write the Boolean expression\n3. Simplify using K-maps or Boolean algebra\n4. Implement with logic gates\n\nRemember: NAND and NOR are universal gates - you can build ANY logic function with just one type!'
                },
                {
                    title: 'Flip Flops & Counters - Sequential Logic',
                    description: 'Sequential logic has memory! Key concepts:\n\n• D flip-flop stores input value\n• JK flip-flop can toggle\n\nFor counters:\n1. Understand the counting sequence\n2. Design the next-state logic\n3. Connect flip-flops properly\n\nWatch the clock signal - it controls when state changes happen.'
                },
                {
                    title: 'Pro Tips & Common Mistakes',
                    description: 'Essential advice for success:\n\n• Always verify your truth table before building circuits\n• Don\'t forget to handle don\'t care conditions in K-maps\n• Check your connections twice - one wrong wire can break everything\n• Use the interactive tools to test before finalizing\n• If stuck, try simpler examples first, then build complexity gradually'
                },
                {
                    title: 'Troubleshooting Guide',
                    description: 'Circuit not working? Follow this systematic approach:\n\n1. Power connections (VCC, GND)\n2. Input connections (are switches connected?)\n3. Output connections (LEDs properly wired?)\n4. Clock signals (for sequential circuits)\n\nUse the simulators to test each component individually before connecting everything together.'
                },
                {
                    title: 'Study Strategies for Success',
                    description: 'Proven techniques for mastering CS121:\n\n• Practice with the simulators daily - hands-on learning is key\n• Review truth tables until you can write them from memory\n• Master K-maps - they\'re essential for exam success\n• Build circuits step by step - don\'t rush\n• Use the "Need Help?" button whenever you\'re stuck - that\'s why it\'s here!'
                }
            ];
            
            // ========================
            // DOM ELEMENTS
            // ========================
            const helpToggle = document.getElementById('helpToggle');
            const popup = document.getElementById('help-popup');
            const closeBtn = document.getElementById('help-popup-close');
            const cardsContainer = document.getElementById('help-cards');
            const prevBtn = document.getElementById('help-prev');
            const nextBtn = document.getElementById('help-next');
            const indicators = document.getElementById('help-indicators');
            
            // Dropdown and contact modal elements
            const dropdown = document.getElementById('help-dropdown');
            const needHelpBtn = document.getElementById('need-help-btn');
            const contactUsBtn = document.getElementById('contact-us-btn');
            const contactModal = document.getElementById('contact-modal');
            const contactModalClose = document.getElementById('contact-modal-close');
            const contactForm = document.getElementById('contact-form');
            const contactSubmitBtn = document.getElementById('contact-submit-btn');
            const contactFormMessage = document.getElementById('contact-form-message');
            
            // ========================
            // STATE MANAGEMENT
            // ========================
            let currentCard = 0;
            let autoHideTimeout = null;
            

            
            // ========================
            // HELP CARD RENDERING
            // ========================
            function renderHelpCard(index) {
                if (index < 0 || index >= helpCards.length) return;
                
                currentCard = index;
                const card = helpCards[index];
                
                cardsContainer.innerHTML = `
                    <div class="help-card">
                        <h3 class="help-card-title">${card.title}</h3>
                        <p class="help-card-description">${card.description}</p>
                    </div>
                `;
                
                // Update navigation state
                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === helpCards.length - 1;
                
                // Update indicators
                indicators.innerHTML = helpCards.map((_, i) => 
                    `<span class="help-indicator${i === index ? ' active' : ''}"></span>`
                ).join('');
            }
            
            // ========================
            // DROPDOWN MANAGEMENT
            // ========================
            function toggleDropdown() {
                const isVisible = dropdown.classList.contains('show');
                if (isVisible) {
                    hideDropdown();
                } else {
                    showDropdown();
                }
            }
            
            function showDropdown() {
                dropdown.classList.add('show');
                if ('inert' in HTMLElement.prototype) {
                    dropdown.removeAttribute('inert');
                } else {
                    dropdown.removeAttribute('aria-hidden');
                    dropdown.removeAttribute('tabindex');
                }
                helpToggle.setAttribute('aria-expanded', 'true');
            }
            
            function hideDropdown() {
                dropdown.classList.remove('show');
                if ('inert' in HTMLElement.prototype) {
                    dropdown.setAttribute('inert', '');
                } else {
                dropdown.setAttribute('aria-hidden', 'true');
                    dropdown.setAttribute('tabindex', '-1');
                }
                helpToggle.setAttribute('aria-expanded', 'false');
            }
            
            // ========================
            // POPUP MANAGEMENT
            // ========================
            function showHelpPopup() {
                hideDropdown();
                popup.classList.add('active');
                popup.setAttribute('aria-hidden', 'false');
                renderHelpCard(currentCard);
                
                // Auto-hide after 2 minutes
                autoHideTimeout = setTimeout(hideHelpPopup, 120000);
                
                // Focus management for accessibility
                setTimeout(() => closeBtn.focus(), 200);
            }
            
            function hideHelpPopup() {
                popup.classList.remove('active');
                popup.setAttribute('aria-hidden', 'true');
                
                if (autoHideTimeout) {
                    clearTimeout(autoHideTimeout);
                    autoHideTimeout = null;
                }
                
                // Return focus to help toggle button
                helpToggle.focus();
            }
            
            // ========================
            // CONTACT MODAL MANAGEMENT
            // ========================
            function showContactModal() {
                hideDropdown();
                contactModal.classList.add('active');
                contactModal.setAttribute('aria-hidden', 'false');
                
                // Focus management for accessibility
                setTimeout(() => contactModalClose.focus(), 200);
            }
            
            function hideContactModal() {
                contactModal.classList.remove('active');
                contactModal.setAttribute('aria-hidden', 'true');
                
                // Return focus to help toggle button
                helpToggle.focus();
            }
            
            // ========================
            // CONTACT FORM VALIDATION
            // ========================
            function validateContactName(showError = false) {
                const nameInput = document.getElementById('contact-name');
                const errorEl = document.getElementById('error-contact-name');
                const helpEl = document.getElementById('help-contact-name');
                const value = nameInput.value.trim();
                
                if (!value) {
                    errorEl.textContent = '';
                    errorEl.classList.remove('active');
                    helpEl.style.display = 'block';
                    return false;
                }
                if (value.length < 2) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Name must be at least 2 characters.');
                    return false;
                }
                if (value.length > 50) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Name is too long. Max 50 characters.');
                    return false;
                }
                if (/[^a-zA-Z\s]/.test(value)) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Name must only contain letters and spaces.');
                    return false;
                }
                errorEl.textContent = '';
                errorEl.classList.remove('active');
                helpEl.style.display = 'block';
                return true;
            }
            
            function validateContactEmail(showError = false) {
                const emailInput = document.getElementById('contact-email');
                const errorEl = document.getElementById('error-contact-email');
                const helpEl = document.getElementById('help-contact-email');
                const value = emailInput.value.trim();
                
                if (!value) {
                    errorEl.textContent = '';
                    errorEl.classList.remove('active');
                    helpEl.style.display = 'block';
                    return false;
                }
                if (!/^\S+@\S+\.\S+$/.test(value)) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Please enter a valid email address.');
                    return false;
                }
                if (value.length > 100) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Email is too long. Max 100 characters.');
                    return false;
                }
                errorEl.textContent = '';
                errorEl.classList.remove('active');
                helpEl.style.display = 'block';
                return true;
            }
            
            function validateContactMessage(showError = false) {
                const messageInput = document.getElementById('contact-message');
                const errorEl = document.getElementById('error-contact-message');
                const helpEl = document.getElementById('help-contact-message');
                const value = messageInput.value.trim();
                
                if (!value) {
                    errorEl.textContent = '';
                    errorEl.classList.remove('active');
                    helpEl.style.display = 'block';
                    return false;
                }
                if (value.length < 10) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Message must be at least 10 characters.');
                    return false;
                }
                if (value.length > 1000) {
                    if (showError) showContactFieldError(errorEl, helpEl, 'Message is too long. Max 1000 characters.');
                    return false;
                }
                errorEl.textContent = '';
                errorEl.classList.remove('active');
                helpEl.style.display = 'block';
                return true;
            }
            
            function showContactFieldError(errorEl, helpEl, msg) {
                errorEl.textContent = msg;
                errorEl.classList.add('active');
                helpEl.style.display = 'none';
            }
            
            function updateContactSubmitState() {
                const nameInput = document.getElementById('contact-name');
                const emailInput = document.getElementById('contact-email');
                const messageInput = document.getElementById('contact-message');
                
                const validName = validateContactName(false);
                const validEmail = validateContactEmail(false);
                const validMessage = validateContactMessage(false);
                const allFilled = nameInput.value.trim() && emailInput.value.trim() && messageInput.value.trim();
                
                if (validName && validEmail && validMessage && allFilled) {
                    contactSubmitBtn.disabled = false;
                } else {
                    contactSubmitBtn.disabled = true;
                }
            }
            

            
            // ========================
            // INITIALIZATION
            // ========================
            function initializeHelpSystem() {
                // Check if inert attribute is supported, fallback to aria-hidden if not
                if (!('inert' in HTMLElement.prototype)) {
                    // Fallback for older browsers
                    dropdown.setAttribute('aria-hidden', 'true');
                    dropdown.setAttribute('tabindex', '-1');
                } else {
                    // Use modern inert attribute
                    dropdown.setAttribute('inert', '');
                }
                
                // Initialize event listeners
                initializeEventListeners();
            }
            
            // ========================
            // EVENT LISTENERS
            // ========================
            function initializeEventListeners() {
                // Help toggle button interactions
                helpToggle.addEventListener('click', toggleDropdown);
                helpToggle.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleDropdown();
                    }
                });
                
                // Dropdown interactions
                needHelpBtn.addEventListener('click', showHelpPopup);
                contactUsBtn.addEventListener('click', showContactModal);
                
                // Popup interactions
                closeBtn.addEventListener('click', hideHelpPopup);
                contactModalClose.addEventListener('click', hideContactModal);
                
                // Navigation
                prevBtn.addEventListener('click', function() {
                    if (currentCard > 0) {
                        renderHelpCard(currentCard - 1);
                    }
                });
                
                nextBtn.addEventListener('click', function() {
                    if (currentCard < helpCards.length - 1) {
                        renderHelpCard(currentCard + 1);
                    }
                });
                
                // Keyboard navigation for modals
                document.addEventListener('keydown', function(e) {
                    // Handle ESC key for both modals
                    if (e.key === 'Escape') {
                        if (contactModal.classList.contains('active')) {
                            hideContactModal();
                            return;
                        }
                        if (popup.classList.contains('active')) {
                            hideHelpPopup();
                            return;
                        }
                        if (dropdown.classList.contains('show')) {
                            hideDropdown();
                            return;
                        }
                    }
                    
                    // Handle navigation keys for help popup only
                    if (!popup.classList.contains('active')) return;
                    
                    switch(e.key) {
                        case 'ArrowLeft':
                            if (currentCard > 0) renderHelpCard(currentCard - 1);
                            break;
                        case 'ArrowRight':
                            if (currentCard < helpCards.length - 1) renderHelpCard(currentCard + 1);
                            break;
                        case 'ArrowUp':
                            if (currentCard > 0) renderHelpCard(currentCard - 1);
                            break;
                        case 'ArrowDown':
                            if (currentCard < helpCards.length - 1) renderHelpCard(currentCard + 1);
                            break;
                    }
                });
                
                // Click outside to close
                document.addEventListener('mousedown', function(e) {
                    if (popup.classList.contains('active') && 
                        !popup.contains(e.target) && 
                        e.target !== helpToggle) {
                        hideHelpPopup();
                    }
                    if (contactModal.classList.contains('active') && 
                        !contactModal.contains(e.target) && 
                        e.target !== helpToggle) {
                        hideContactModal();
                    }
                    if (dropdown.classList.contains('show') && 
                        !dropdown.contains(e.target) && 
                        e.target !== helpToggle) {
                        hideDropdown();
                    }
                });
                
                // Touch outside to close
                document.addEventListener('touchstart', function(e) {
                    if (popup.classList.contains('active') && 
                        !popup.contains(e.target) && 
                        e.target !== helpToggle) {
                        hideHelpPopup();
                    }
                    if (contactModal.classList.contains('active') && 
                        !contactModal.contains(e.target) && 
                        e.target !== helpToggle) {
                        hideContactModal();
                    }
                }, {passive: true});
                
                // Swipe navigation for mobile
                let touchStartX = null;
                cardsContainer.addEventListener('touchstart', function(e) {
                    if (e.touches.length === 1) {
                        touchStartX = e.touches[0].clientX;
                    }
                }, {passive: true});
                
                cardsContainer.addEventListener('touchend', function(e) {
                    if (touchStartX === null) return;
                    
                    const dx = e.changedTouches[0].clientX - touchStartX;
                    if (dx > 50 && currentCard > 0) {
                        renderHelpCard(currentCard - 1);
                    } else if (dx < -50 && currentCard < helpCards.length - 1) {
                        renderHelpCard(currentCard + 1);
                    }
                    touchStartX = null;
                }, {passive: true});
                
                // Contact form interactions
                const contactNameInput = document.getElementById('contact-name');
                const contactEmailInput = document.getElementById('contact-email');
                const contactMessageInput = document.getElementById('contact-message');
                
                // Show help on focus
                contactNameInput.addEventListener('focus', () => document.getElementById('help-contact-name').style.display = 'block');
                contactNameInput.addEventListener('blur', () => { 
                    document.getElementById('help-contact-name').style.display = 'none'; 
                    validateContactName(true); 
                    updateContactSubmitState(); 
                });
                
                contactEmailInput.addEventListener('focus', () => document.getElementById('help-contact-email').style.display = 'block');
                contactEmailInput.addEventListener('blur', () => { 
                    document.getElementById('help-contact-email').style.display = 'none'; 
                    validateContactEmail(true); 
                    updateContactSubmitState(); 
                });
                
                contactMessageInput.addEventListener('focus', () => document.getElementById('help-contact-message').style.display = 'block');
                contactMessageInput.addEventListener('blur', () => { 
                    document.getElementById('help-contact-message').style.display = 'none'; 
                    validateContactMessage(true); 
                    updateContactSubmitState(); 
                });
                
                // Validate on input
                contactNameInput.addEventListener('input', () => { 
                    validateContactName(false); 
                    updateContactSubmitState(); 
                });
                contactEmailInput.addEventListener('input', () => { 
                    validateContactEmail(false); 
                    updateContactSubmitState(); 
                });
                contactMessageInput.addEventListener('input', () => { 
                    validateContactMessage(false); 
                    updateContactSubmitState(); 
                });
                
                // Form submission
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const validName = validateContactName(true);
                    const validEmail = validateContactEmail(true);
                    const validMessage = validateContactMessage(true);
                    
                    if (!(validName && validEmail && validMessage)) {
                        updateContactSubmitState();
                        return false;
                    }
                    
                    contactSubmitBtn.disabled = true;
                    contactSubmitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
                    
                    try {
                        // Use fetch API to submit form data directly to Google Forms
                        const formData = new FormData(contactForm);
                        
                        // Submit to Google Forms using fetch
                        fetch(contactForm.action, {
                            method: 'POST',
                            body: formData,
                            mode: 'no-cors' // Prevent CORS issues
                        }).then(() => {
                            // Show success message
                            contactFormMessage.innerHTML = '<i class="fas fa-check-circle"></i> Thank you! Your message has been sent successfully.';
                            contactFormMessage.classList.add('success');
                            contactForm.reset();
                            
                            // Keep button disabled after successful submission
                            contactSubmitBtn.disabled = true;
                            contactSubmitBtn.innerHTML = 'Send Message';
                        }).catch(() => {
                            // Even if fetch fails, show success (Google Forms often doesn't return proper responses)
                            contactFormMessage.innerHTML = '<i class="fas fa-check-circle"></i> Thank you! Your message has been sent successfully.';
                            contactFormMessage.classList.add('success');
                            contactForm.reset();
                            
                            // Keep button disabled after successful submission
                            contactSubmitBtn.disabled = true;
                            contactSubmitBtn.innerHTML = 'Send Message';
                        });
                        
                    } catch (error) {
                        contactFormMessage.innerHTML = '<i class="fas fa-exclamation-triangle"></i> An error occurred. Please try again later.';
                        contactFormMessage.classList.add('error');
                        // Re-enable button on error so user can retry
                        contactSubmitBtn.disabled = false;
                        contactSubmitBtn.innerHTML = 'Send Message';
                    }
                    
                    // Clear message after 5 seconds
                    setTimeout(() => {
                        contactFormMessage.classList.remove('success', 'error');
                        contactFormMessage.innerHTML = '';
                    }, 5000);
                });
            }
            

            
            // ========================
            // FINAL INITIALIZATION
            // ========================
            function finalizeHelpSystem() {
                // Render initial help card
                renderHelpCard(0);
                
                // Set initial state
                popup.classList.remove('active');
                popup.setAttribute('aria-hidden', 'true');
                contactModal.classList.remove('active');
                contactModal.setAttribute('aria-hidden', 'true');
                dropdown.classList.remove('show');
                if ('inert' in HTMLElement.prototype) {
                    dropdown.setAttribute('inert', '');
                } else {
                dropdown.setAttribute('aria-hidden', 'true');
                    dropdown.setAttribute('tabindex', '-1');
                }
                
                // Initialize contact form state
                updateContactSubmitState();
            }
            
            // Initialize when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    initializeHelpSystem();
                    finalizeHelpSystem();
                });
            } else {
                initializeHelpSystem();
                finalizeHelpSystem();
            }
            

            

            
        })();
    </script>
</body>
</html>
